"use strict";
/**
 * @license
 * Copyright Google Inc. All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
Object.defineProperty(exports, "__esModule", { value: true });
var message_bundle_1 = require("@angular/compiler/src/i18n/message_bundle");
var xmb_1 = require("@angular/compiler/src/i18n/serializers/xmb");
var html_parser_1 = require("@angular/compiler/src/ml_parser/html_parser");
var interpolation_config_1 = require("@angular/compiler/src/ml_parser/interpolation_config");
var core_1 = require("@angular/core");
var testing_1 = require("@angular/core/testing");
var matchers_1 = require("@angular/platform-browser/testing/src/matchers");
var spies_1 = require("../spies");
var integration_common_1 = require("./integration_common");
function main() {
    describe('i18n XMB/XTB integration spec', function () {
        beforeEach(testing_1.async(function () {
            testing_1.TestBed.configureCompiler({
                providers: [
                    spies_1.SpyResourceLoader.PROVIDE,
                    integration_common_1.FrLocalization.PROVIDE,
                    { provide: core_1.TRANSLATIONS, useValue: XTB },
                    { provide: core_1.TRANSLATIONS_FORMAT, useValue: 'xtb' },
                ]
            });
            testing_1.TestBed.configureTestingModule({ declarations: [integration_common_1.I18nComponent] });
        }));
        it('should extract from templates', function () {
            var catalog = new message_bundle_1.MessageBundle(new html_parser_1.HtmlParser, [], {});
            var serializer = new xmb_1.Xmb();
            catalog.updateFromTemplate(integration_common_1.HTML, 'file.ts', interpolation_config_1.DEFAULT_INTERPOLATION_CONFIG);
            matchers_1.expect(catalog.write(serializer)).toContain(XMB);
        });
        it('should translate templates', function () {
            var tb = testing_1.TestBed.overrideTemplate(integration_common_1.I18nComponent, integration_common_1.HTML).createComponent(integration_common_1.I18nComponent);
            var cmp = tb.componentInstance;
            var el = tb.debugElement;
            integration_common_1.validateHtml(tb, cmp, el);
        });
    });
}
exports.main = main;
var XTB = "\n<translationbundle>\n  <translation id=\"615790887472569365\">attributs i18n sur les balises</translation>\n  <translation id=\"3707494640264351337\">imbriqu\u00E9</translation>\n  <translation id=\"5539162898278769904\">imbriqu\u00E9</translation>\n  <translation id=\"3780349238193953556\"><ph name=\"START_ITALIC_TEXT\"/>avec des espaces r\u00E9serv\u00E9s<ph name=\"CLOSE_ITALIC_TEXT\"/></translation>\n  <translation id=\"5415448997399451992\"><ph name=\"START_TAG_DIV\"><ex>&lt;div&gt;</ex></ph>avec <ph name=\"START_TAG_DIV\"><ex>&lt;div&gt;</ex></ph>des espaces r\u00E9serv\u00E9s<ph name=\"CLOSE_TAG_DIV\"><ex>&lt;/div&gt;</ex></ph> imbriqu\u00E9s<ph name=\"CLOSE_TAG_DIV\"><ex>&lt;/div&gt;</ex></ph></translation>\n  <translation id=\"5525133077318024839\">sur des balises non traductibles</translation>\n  <translation id=\"8670732454866344690\">sur des balises traductibles</translation>\n  <translation id=\"4593805537723189714\">{VAR_PLURAL, plural, =0 {zero} =1 {un} =2 {deux} other {<ph name=\"START_BOLD_TEXT\"/>beaucoup<ph name=\"CLOSE_BOLD_TEXT\"/>}}</translation>\n  <translation id=\"4360321700965841752\"><ph name=\"ICU\"/></translation>\n  <translation id=\"5460933846928880074\">{VAR_SELECT, select, 0 {autre} m {homme} f {femme} }</translation>\n  <translation id=\"1746565782635215\"><ph name=\"ICU\"/></translation>\n  <translation id=\"5868084092545682515\">{VAR_SELECT, select, m {homme} f {femme}}</translation>\n  <translation id=\"4851788426695310455\"><ph name=\"INTERPOLATION\"/></translation>\n  <translation id=\"9013357158046221374\">sexe = <ph name=\"INTERPOLATION\"/></translation>\n  <translation id=\"8324617391167353662\"><ph name=\"CUSTOM_NAME\"/></translation>\n  <translation id=\"7685649297917455806\">dans une section traductible</translation>\n  <translation id=\"2387287228265107305\">\n    <ph name=\"START_HEADING_LEVEL1\"/>Balises dans les commentaires html<ph name=\"CLOSE_HEADING_LEVEL1\"/>   \n    <ph name=\"START_TAG_DIV\"/><ph name=\"CLOSE_TAG_DIV\"/>\n    <ph name=\"START_TAG_DIV_1\"/><ph name=\"ICU\"/><ph name=\"CLOSE_TAG_DIV\"></ph>\n</translation>\n  <translation id=\"1491627405349178954\">ca <ph name=\"START_BOLD_TEXT\"/>devrait<ph name=\"CLOSE_BOLD_TEXT\"/> marcher</translation>\n  <translation id=\"i18n16\">avec un ID explicite</translation>\n  <translation id=\"i18n17\">{VAR_PLURAL, plural, =0 {zero} =1 {un} =2 {deux} other {<ph \n  name=\"START_BOLD_TEXT\"><ex>&lt;b&gt;</ex></ph>beaucoup<ph name=\"CLOSE_BOLD_TEXT\"><ex>&lt;/b&gt;</ex></ph>} }</translation>\n  <translation id=\"4085484936881858615\">{VAR_PLURAL, plural, =0 {Pas de r\u00E9ponse} =1 {une r\u00E9ponse} other {<ph name=\"INTERPOLATION\"><ex>INTERPOLATION</ex></ph> r\u00E9ponse} }</translation>\n  <translation id=\"4035252431381981115\">FOO<ph name=\"START_LINK\"><ex>&lt;a&gt;</ex></ph>BAR<ph name=\"CLOSE_LINK\"><ex>&lt;/a&gt;</ex></ph></translation>\n  <translation id=\"5339604010413301604\"><ph name=\"MAP_NAME\"><ex>MAP_NAME</ex></ph></translation>\n</translationbundle>";
var XMB = "<msg id=\"615790887472569365\"><source>file.ts:3</source>i18n attribute on tags</msg>\n  <msg id=\"3707494640264351337\"><source>file.ts:5</source>nested</msg>\n  <msg id=\"5539162898278769904\" meaning=\"different meaning\"><source>file.ts:7</source>nested</msg>\n  <msg id=\"3780349238193953556\"><source>file.ts:9</source><source>file.ts:10</source><ph name=\"START_ITALIC_TEXT\"><ex>&lt;i&gt;</ex></ph>with placeholders<ph name=\"CLOSE_ITALIC_TEXT\"><ex>&lt;/i&gt;</ex></ph></msg>\n  <msg id=\"5415448997399451992\"><source>file.ts:11</source><ph name=\"START_TAG_DIV\"><ex>&lt;div&gt;</ex></ph>with <ph name=\"START_TAG_DIV\"><ex>&lt;div&gt;</ex></ph>nested<ph name=\"CLOSE_TAG_DIV\"><ex>&lt;/div&gt;</ex></ph> placeholders<ph name=\"CLOSE_TAG_DIV\"><ex>&lt;/div&gt;</ex></ph></msg>\n  <msg id=\"5525133077318024839\"><source>file.ts:14</source>on not translatable node</msg>\n  <msg id=\"8670732454866344690\"><source>file.ts:15</source>on translatable node</msg>\n  <msg id=\"4593805537723189714\"><source>file.ts:20</source><source>file.ts:37</source>{VAR_PLURAL, plural, =0 {zero} =1 {one} =2 {two} other {<ph name=\"START_BOLD_TEXT\"><ex>&lt;b&gt;</ex></ph>many<ph name=\"CLOSE_BOLD_TEXT\"><ex>&lt;/b&gt;</ex></ph>} }</msg>\n  <msg id=\"4360321700965841752\"><source>file.ts:22,24</source>\n        <ph name=\"ICU\"><ex>{sex, select, 0 {...} m {...} f {...}}</ex></ph>\n    </msg>\n  <msg id=\"5460933846928880074\"><source>file.ts:23</source>{VAR_SELECT, select, 0 {other} m {male} f {female} }</msg>\n  <msg id=\"1746565782635215\"><source>file.ts:25,27</source>\n        <ph name=\"ICU\"><ex>{sexB, select, m {...} f {...}}</ex></ph>\n    </msg>\n  <msg id=\"5868084092545682515\"><source>file.ts:26</source>{VAR_SELECT, select, m {male} f {female} }</msg>\n  <msg id=\"4851788426695310455\"><source>file.ts:29</source><ph name=\"INTERPOLATION\"><ex>{{ &quot;count = &quot; + count }}</ex></ph></msg>\n  <msg id=\"9013357158046221374\"><source>file.ts:30</source>sex = <ph name=\"INTERPOLATION\"><ex>{{ sex }}</ex></ph></msg>\n  <msg id=\"8324617391167353662\"><source>file.ts:31</source><ph name=\"CUSTOM_NAME\"><ex>{{ &quot;custom name&quot; //i18n(ph=&quot;CUSTOM_NAME&quot;) }}</ex></ph></msg>\n  <msg id=\"7685649297917455806\"><source>file.ts:36</source><source>file.ts:54</source>in a translatable section</msg>\n  <msg id=\"2387287228265107305\"><source>file.ts:34,38</source>\n    <ph name=\"START_HEADING_LEVEL1\"><ex>&lt;h1&gt;</ex></ph>Markers in html comments<ph name=\"CLOSE_HEADING_LEVEL1\"><ex>&lt;/h1&gt;</ex></ph>   \n    <ph name=\"START_TAG_DIV\"><ex>&lt;div&gt;</ex></ph><ph name=\"CLOSE_TAG_DIV\"><ex>&lt;/div&gt;</ex></ph>\n    <ph name=\"START_TAG_DIV_1\"><ex>&lt;div&gt;</ex></ph><ph name=\"ICU\"><ex>{count, plural, =0 {...} =1 {...} =2 {...} other {...}}</ex></ph><ph name=\"CLOSE_TAG_DIV\"><ex>&lt;/div&gt;</ex></ph>\n</msg>\n  <msg id=\"1491627405349178954\"><source>file.ts:40</source>it <ph name=\"START_BOLD_TEXT\"><ex>&lt;b&gt;</ex></ph>should<ph name=\"CLOSE_BOLD_TEXT\"><ex>&lt;/b&gt;</ex></ph> work</msg>\n  <msg id=\"i18n16\"><source>file.ts:42</source>with an explicit ID</msg>\n  <msg id=\"i18n17\"><source>file.ts:43</source>{VAR_PLURAL, plural, =0 {zero} =1 {one} =2 {two} other {<ph name=\"START_BOLD_TEXT\"><ex>&lt;b&gt;</ex></ph>many<ph name=\"CLOSE_BOLD_TEXT\"><ex>&lt;/b&gt;</ex></ph>} }</msg>\n  <msg id=\"4085484936881858615\" desc=\"desc\"><source>file.ts:46,52</source>{VAR_PLURAL, plural, =0 {Found no results} =1 {Found one result} other {Found <ph name=\"INTERPOLATION\"><ex>{{response.getItemsList().length}}</ex></ph> results} }</msg>\n  <msg id=\"4035252431381981115\"><source>file.ts:54</source>foo<ph name=\"START_LINK\"><ex>&lt;a&gt;</ex></ph>bar<ph name=\"CLOSE_LINK\"><ex>&lt;/a&gt;</ex></ph></msg>\n  <msg id=\"5339604010413301604\"><source>file.ts:56</source><ph name=\"MAP_NAME\"><ex>{{ &apos;test&apos; //i18n(ph=&quot;map name&quot;) }}</ex></ph></msg>";
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZWdyYXRpb25feG1iX3h0Yl9zcGVjLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvY29tcGlsZXIvdGVzdC9pMThuL2ludGVncmF0aW9uX3htYl94dGJfc3BlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7OztHQU1HOztBQUlILDRFQUF3RTtBQUN4RSxrRUFBK0Q7QUFDL0QsMkVBQXVFO0FBQ3ZFLDZGQUFrRztBQUNsRyxzQ0FBOEU7QUFDOUUsaURBQXVFO0FBQ3ZFLDJFQUFzRTtBQUV0RSxrQ0FBMkM7QUFFM0MsMkRBQXVGO0FBRXZGO0lBQ0UsUUFBUSxDQUFDLCtCQUErQixFQUFFO1FBRXhDLFVBQVUsQ0FBQyxlQUFLLENBQUM7WUFDZixpQkFBTyxDQUFDLGlCQUFpQixDQUFDO2dCQUN4QixTQUFTLEVBQUU7b0JBQ1QseUJBQWlCLENBQUMsT0FBTztvQkFDekIsbUNBQWMsQ0FBQyxPQUFPO29CQUN0QixFQUFDLE9BQU8sRUFBRSxtQkFBWSxFQUFFLFFBQVEsRUFBRSxHQUFHLEVBQUM7b0JBQ3RDLEVBQUMsT0FBTyxFQUFFLDBCQUFtQixFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQUM7aUJBQ2hEO2FBQ0YsQ0FBQyxDQUFDO1lBRUgsaUJBQU8sQ0FBQyxzQkFBc0IsQ0FBQyxFQUFDLFlBQVksRUFBRSxDQUFDLGtDQUFhLENBQUMsRUFBQyxDQUFDLENBQUM7UUFDbEUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUVKLEVBQUUsQ0FBQywrQkFBK0IsRUFBRTtZQUNsQyxJQUFNLE9BQU8sR0FBRyxJQUFJLDhCQUFhLENBQUMsSUFBSSx3QkFBVSxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUMxRCxJQUFNLFVBQVUsR0FBRyxJQUFJLFNBQUcsRUFBRSxDQUFDO1lBQzdCLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyx5QkFBSSxFQUFFLFNBQVMsRUFBRSxtREFBNEIsQ0FBQyxDQUFDO1lBRTFFLGlCQUFNLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNuRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw0QkFBNEIsRUFBRTtZQUMvQixJQUFNLEVBQUUsR0FDSixpQkFBTyxDQUFDLGdCQUFnQixDQUFDLGtDQUFhLEVBQUUseUJBQUksQ0FBQyxDQUFDLGVBQWUsQ0FBQyxrQ0FBYSxDQUFDLENBQUM7WUFDakYsSUFBTSxHQUFHLEdBQWtCLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQztZQUNoRCxJQUFNLEVBQUUsR0FBaUIsRUFBRSxDQUFDLFlBQVksQ0FBQztZQUV6QyxpQ0FBWSxDQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDNUIsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUM7QUFqQ0Qsb0JBaUNDO0FBRUQsSUFBTSxHQUFHLEdBQUcsKzhGQThCUyxDQUFDO0FBRXRCLElBQU0sR0FBRyxHQUFHLDYxSEE4QjhJLENBQUMifQ==