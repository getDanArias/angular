{"version":3,"sources":["../../../../../../../packages/animations/browser/src/render/animation_engine_next.ts"],"names":[],"mappings":"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","file":"animation_engine_next.js","sourceRoot":"","sourcesContent":["/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nimport {AnimationMetadata, AnimationPlayer, AnimationTriggerMetadata} from '@angular/animations';\nimport {TriggerAst} from '../dsl/animation_ast';\nimport {buildAnimationAst} from '../dsl/animation_ast_builder';\nimport {AnimationTrigger, buildTrigger} from '../dsl/animation_trigger';\nimport {AnimationStyleNormalizer} from '../dsl/style_normalization/animation_style_normalizer';\n\nimport {AnimationDriver} from './animation_driver';\nimport {parseTimelineCommand} from './shared';\nimport {TimelineAnimationEngine} from './timeline_animation_engine';\nimport {TransitionAnimationEngine} from './transition_animation_engine';\nexport class AnimationEngine {\nprivate _transitionEngine: TransitionAnimationEngine;\nprivate _timelineEngine: TimelineAnimationEngine;\nprivate _triggerCache: {[key: string]: AnimationTrigger} = {};\npublic onRemovalComplete = (element: any, context: any) => {};\n/**\n * @param {?} driver\n * @param {?} normalizer\n */\nconstructor(driver: AnimationDriver, normalizer: AnimationStyleNormalizer) {\n    this._transitionEngine = new TransitionAnimationEngine(driver, normalizer);\n    this._timelineEngine = new TimelineAnimationEngine(driver, normalizer);\n\n    this._transitionEngine.onRemovalComplete = (element: any, context: any) =>\n        this.onRemovalComplete(element, context);\n  }\n/**\n * @param {?} componentId\n * @param {?} namespaceId\n * @param {?} hostElement\n * @param {?} name\n * @param {?} metadata\n * @return {?}\n */\nregisterTrigger(\n      componentId: string, namespaceId: string, hostElement: any, name: string,\n      metadata: AnimationTriggerMetadata): void {\n    const /** @type {?} */ cacheKey = componentId + '-' + name;\n    let /** @type {?} */ trigger = this._triggerCache[cacheKey];\n    if (!trigger) {\n      const /** @type {?} */ errors: any[] = [];\n      const /** @type {?} */ ast = /** @type {?} */(( buildAnimationAst( /** @type {?} */((metadata as AnimationMetadata)), errors) as TriggerAst));\n      if (errors.length) {\n        throw new Error(\n            `The animation trigger \"${name}\" has failed to build due to the following errors:\\n - ${errors.join(\"\\n - \")}`);\n      }\n      trigger = buildTrigger(name, ast);\n      this._triggerCache[cacheKey] = trigger;\n    }\n    this._transitionEngine.registerTrigger(namespaceId, name, trigger);\n  }\n/**\n * @param {?} namespaceId\n * @param {?} hostElement\n * @return {?}\n */\nregister(namespaceId: string, hostElement: any) {\n    this._transitionEngine.register(namespaceId, hostElement);\n  }\n/**\n * @param {?} namespaceId\n * @param {?} context\n * @return {?}\n */\ndestroy(namespaceId: string, context: any) {\n    this._transitionEngine.destroy(namespaceId, context);\n  }\n/**\n * @param {?} namespaceId\n * @param {?} element\n * @param {?} parent\n * @param {?} insertBefore\n * @return {?}\n */\nonInsert(namespaceId: string, element: any, parent: any, insertBefore: boolean): void {\n    this._transitionEngine.insertNode(namespaceId, element, parent, insertBefore);\n  }\n/**\n * @param {?} namespaceId\n * @param {?} element\n * @param {?} context\n * @return {?}\n */\nonRemove(namespaceId: string, element: any, context: any): void {\n    this._transitionEngine.removeNode(namespaceId, element, context);\n  }\n/**\n * @param {?} element\n * @param {?} disable\n * @return {?}\n */\ndisableAnimations(element: any, disable: boolean) {\n    this._transitionEngine.markElementAsDisabled(element, disable);\n  }\n/**\n * @param {?} namespaceId\n * @param {?} element\n * @param {?} property\n * @param {?} value\n * @return {?}\n */\nprocess(namespaceId: string, element: any, property: string, value: any) {\n    if (property.charAt(0) == '@') {\n      const [id, action] = parseTimelineCommand(property);\n      const /** @type {?} */ args = /** @type {?} */(( value as any[]));\n      this._timelineEngine.command(id, element, action, args);\n    } else {\n      this._transitionEngine.trigger(namespaceId, element, property, value);\n    }\n  }\n/**\n * @param {?} namespaceId\n * @param {?} element\n * @param {?} eventName\n * @param {?} eventPhase\n * @param {?} callback\n * @return {?}\n */\nlisten(\n      namespaceId: string, element: any, eventName: string, eventPhase: string,\n      callback: (event: any) => any): () => any {\n    // @@listen\n    if (eventName.charAt(0) == '@') {\n      const [id, action] = parseTimelineCommand(eventName);\n      return this._timelineEngine.listen(id, element, action, callback);\n    }\n    return this._transitionEngine.listen(namespaceId, element, eventName, eventPhase, callback);\n  }\n/**\n * @param {?=} microtaskId\n * @return {?}\n */\nflush(microtaskId: number = -1): void { this._transitionEngine.flush(microtaskId); }\n/**\n * @return {?}\n */\nget players(): AnimationPlayer[] {\n    return ( /** @type {?} */((this._transitionEngine.players as AnimationPlayer[])))\n        .concat( /** @type {?} */((this._timelineEngine.players as AnimationPlayer[])));\n  }\n/**\n * @return {?}\n */\nwhenRenderingDone(): Promise<any> { return this._transitionEngine.whenRenderingDone(); }\n}\n\nfunction AnimationEngine_tsickle_Closure_declarations() {\n/** @type {?} */\nAnimationEngine.prototype._transitionEngine;\n/** @type {?} */\nAnimationEngine.prototype._timelineEngine;\n/** @type {?} */\nAnimationEngine.prototype._triggerCache;\n/** @type {?} */\nAnimationEngine.prototype.onRemovalComplete;\n}\n\n"]}