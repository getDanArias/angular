{"version":3,"sources":["/Users/jasonaden/Projects/angular/dist/packages-dist/animations/bundles/animations-browser.umd.js"],"names":["global","factory","exports","module","require","define","amd","ng","animations","browser","this","_angular_animations","optimizeGroupPlayer","players","length","NoopAnimationPlayer","ɵAnimationGroupPlayer","normalizeKeyframes","driver","normalizer","element","keyframes","preStyles","postStyles","errors","normalizedKeyframes","previousOffset","previousKeyframe","forEach","kf","offset","isSameOffset","normalizedKeyframe","Object","keys","prop","normalizedProp","normalizedValue","normalizePropertyName","ɵPRE_STYLE","AUTO_STYLE","normalizeStyleValue","push","LINE_START","Error","join","listenOnPlayer","player","eventName","event","callback","onStart","copyAnimationEvent","totalTime","onDone","onDestroy","e","phaseName","makeAnimationEvent","triggerName","fromState","toState","undefined","data","getOrSetAsInMap","map","key","defaultValue","value","Map","get","set","parseTimelineCommand","command","separatorPos","indexOf","id","substring","action","substr","resolveTimingValue","matches","match","_convertTimeValueToMS","parseFloat","unit","ONE_SECOND","resolveTiming","timings","allowNegativeValues","hasOwnProperty","parseTimeExpression","exp","duration","regex","delay","easing","delayMatch","Math","floor","easingVal","containsErrors","startIndex","splice","copyObj","obj","destination","normalizeStyles","styles","normalizedStyles","Array","isArray","copyStyles","readPrototype","setStyles","camelProp","dashCaseToCamelCase","style","eraseStyles","normalizeAnimationEntry","steps","sequence","validateStyleParams","options","params","extractStyleParams","varName","val","toString","PARAM_REGEX","exec","lastIndex","interpolateParams","original","str","replace","_","localVal","iteratorToArray","iterator","arr","item","next","done","input","DASH_CASE_REGEXP","m","_i","arguments","toUpperCase","allowPreviousPlayerStylesMerge","__extends","d","b","__","constructor","extendStatics","prototype","create","visitAnimationNode","visitor","node","context","type","visitTrigger","visitState","visitTransition","visitSequence","visitGroup","visitAnimate","visitKeyframes","visitStyle","visitReference","visitAnimateChild","visitAnimateRef","visitQuery","visitStagger","parseTransitionExpr","transitionValue","expressions","split","parseInnerTransitionStr","eventStr","result","parseAnimationAlias","separator","makeLambdaFromStates","isFullAnyStateExpr","ANY_STATE","alias","lhs","rhs","lhsMatch","rhsMatch","buildAnimationAst","metadata","AnimationAstBuilderVisitor","build","normalizeSelector","selector","hasAmpersand","find","token","SELF_TOKEN","SELF_TOKEN_REGEX","ENTER_TOKEN_REGEX","ENTER_SELECTOR","LEAVE_TOKEN_REGEX","LEAVE_SELECTOR","NG_TRIGGER_SELECTOR","NG_ANIMATING_SELECTOR","normalizeParams","consumeOffset","styleTuple","isObject","constructTimingAst","TimingAst","strValue","isDynamic","some","v","charAt","DynamicTimingAst","normalizeAnimationOptions","createTimelineInstruction","preStyleProps","postStyleProps","subTimeline","buildAnimationTimelines","rootElement","ast","startingStyles","finalStyles","subInstructions","AnimationTimelineBuilderVisitor","buildKeyframes","roundOffset","decimalPoints","mult","pow","round","flattenStyles","allStyles","allProperties","makeBooleanMap","createTransitionInstruction","isRemovalTransition","fromStyles","toStyles","timelines","queriedElements","oneOrMoreTransitionsMatch","matchFns","currentState","nextState","fn","buildTrigger","name","AnimationTrigger","createFallbackTransition","states","matchers","animation","SequenceAst","transition","TransitionAst","AnimationTransitionFactory","balanceProperties","key1","key2","deleteOrUnsetInMap","currentValues","index","delete","normalizeTriggerValue","isElementNode","isTriggerEventValid","cloakElement","oldValue","display","cloakAndComputeStyles","elements","elementPropsMap","defaultStyle","cloakVals","valuesMap","props","computeStyle","REMOVAL_FLAG","NULL_REMOVED_QUERIED_STATE","i","createIsRootFilterFn","nodes","isRoot","nodeSet","Set","knownRootContainer","has","parentNode","add","containsClass","className","classList","contains","classes","CLASSES_CACHE_KEY","addClass","removeClass","remove","getBodyNode","document","body","removeNodesAfterAnimationDone","engine","processLeaveNode","flattenGroupPlayers","finalPlayers","_flattenGroupPlayersRecur","objEquals","a","k1","k2","_computeStyle","window","getComputedStyle","supportsWebAnimations","Element","_contains","elm1","elm2","_matches","_query","multi","proto","fn_1","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","apply","results","querySelectorAll","elm","querySelector","matchesElement","containsElement","invokeQuery","NoopAnimationDriver","query","animate","previousPlayers","AnimationDriver","NOOP","SUBSTITUTION_EXPR_START","SUBSTITUTION_EXPR_END","ENTER_CLASSNAME","LEAVE_CLASSNAME","NG_TRIGGER_CLASSNAME","NG_ANIMATING_CLASSNAME","RegExp","setPrototypeOf","__proto__","p","__assign","assign","t","s","n","call","EMPTY_ANIMATION_OPTIONS","Ast","defineProperty","enumerable","configurable","TriggerAst","_super","transitions","_this","queryCount","depCount","visit","StateAst","style$$1","GroupAst","AnimateAst","StyleAst","isEmptyStep","containsDynamicStyles","KeyframesAst","ReferenceAst","AnimateChildAst","AnimateRefAst","QueryAst","limit","optional","includeSelf","StaggerAst","visitTiming","LEAVE_TOKEN","ENTER_TOKEN","ROOT_SELECTOR","AnimationAstBuilderContext","_resetContextStyleTimingState","currentQuerySelector","collectedStyles","currentTime","definitions","def","stateDef_1","name_1","styleAst","astParams","missingSubs_1","params_1","stylesObj_1","sub","size","missingSubsArr","values","stateAst","entry","expr","furthestTime","step","innerAst","max","timingAst","currentAnimateTimings","styleMetadata","styleMetadata_1","isEmpty","newStyleData","_makeStyleAst","_validateStyleAst","collectedEasing","styleData","styleMap","endTime","startTime","tuple","collectedEntry","updateCollectedStyle","MAX_KEYFRAME_OFFSET","totalKeyframesWithOffsets","offsets","offsetsOutOfOrder","keyframesOutOfRange","offsetVal","generatedOffset","animateDuration","durationUpToThisFrame","parentSelector","currentQuery","_a","originalSelector","currentTransition","ElementInstructionMap","_map","consume","instructions","append","existingInstructions","clear","ONE_FRAME_IN_MILLISECONDS","AnimationTimelineContext","currentTimeline","filter","timeline","containsAnimation","tl","allowOnlyTimelineStyles","elementInstructions","innerContext","createSubContext","_visitSubInstructions","transformIntoNewTimeline","previousNode","instruction","instructionTimings","appendInstructionToTimeline","updateOptions","subContextCount","ctx","snapshotCurrentStyles","DEFAULT_NOOP_PREVIOUS_NODE","delayNextStep","applyStylesToKeyframe","innerTimelines","mergeTimelineCollectedStyles","incrementTime","getCurrentStyleProperties","forwardFrame","applyEmptyStep","innerTimeline","forwardTime","elms","currentQueryTotal","sameElementTimeline","currentQueryIndex","parentContext","abs","maxTime","staggerTransformer","currentStaggerTime","startingTime","_driver","initialTimeline","TimelineBuilder","skipIfExists","newOptions","optionsToUpdate","newParams","paramsToUpdate_1","_copyOptions","oldParams_1","newTime","target","fork","updatedTimings","builder","SubTimelineBuilder","stretchStartingKeyframe","time","_elementTimelineStylesLookup","_previousKeyframe","_currentKeyframe","_keyframes","_styleSummary","_pendingStyles","_backFill","_currentEmptyStepKeyframe","_localTimelineStyles","_globalTimelineStyles","_loadKeyframe","hasPreStyleStep","_updateStyle","getFinalKeyframe","properties","details0","details1","finalKeyframes","keyframe","finalKeyframe","preProps","postProps","kf0","kf1","_stretchStartingKeyframe","newKeyframes","startingGap","newFirstKeyframe","oldFirstKeyframe","oldOffset","timeAtKeyframe","Animation","errorMessage","_animationAst","buildTimelines","destinationStyles","start","dest","AnimationStyleNormalizer","NoopAnimationStyleNormalizer","propertyName","userProvidedProperty","normalizedProperty","WebAnimationsStyleNormalizer","strVal","trim","DIMENSIONAL_PROP_MAP","valAndSuffixMatch","EMPTY_OBJECT","_triggerName","_stateStyles","buildStyles","stateName","backupStateStyler","stateStyler","backupStyles","currentOptions","nextOptions","transitionAnimationParams","currentAnimationParams","currentStateStyles","nextAnimationParams","nextStateStyles","preStyleMap","postStyleMap","isRemoval","animationOptions","queriedElementsList","AnimationStateStyles","defaultParams","combinedParams","styleObj_1","transitionFactories","fallbackTransition","matchTransition","f","matchStyles","EMPTY_INSTRUCTION_MAP","TimelineAnimationEngine","_normalizer","_animations","_playersById","register","_buildPlayer","autoStylesMap","inst","destroy","_getPlayer","listen","baseEvent","args","play","pause","reset","restart","finish","init","setPosition","QUEUED_CLASSNAME","QUEUED_SELECTOR","DISABLED_CLASSNAME","DISABLED_SELECTOR","EMPTY_PLAYER_ARRAY","NULL_REMOVAL_STATE","namespaceId","setForRemoval","hasAnimation","removedBeforeQueried","StateValue","isObj","absorbOptions","VOID_VALUE","DEFAULT_STATE_VALUE","DELETED_STATE_VALUE","AnimationTransitionNamespace","hostElement","_engine","_triggers","_queue","_elementListeners","_hostClassName","phase","listeners","triggersWithStates","statesByElement","afterFlush","_getTrigger","trigger","defaultToFallback","TransitionAnimationPlayer","playersOnElement","playersByElement","queued","isFallbackTransition","totalQueuedPlayers","index_1","fromStyles_1","toStyles_1","reportError","deregister","stateMap","clearElementCache","elementPlayers","_destroyInnerNodes","innerNs","namespacesByHostElement","removeNode","doNotRecurse","childElementCount","triggerStates","players_1","markElementAsRemoved","containsPotentialParentTransition","totalAnimations","currentPlayers","playersByQueriedElement","parent_1","triggers","visitedTriggers_1","listener","elementStates","destroyInnerAnimations","_onRemovalComplete","insertNode","parent","drainQueuedTransitions","microtaskId","destroyed","markedForDestroy","sort","d0","d1","elementContainsData","containsData","TransitionAnimationEngine","newHostElements","disabledNodes","_namespaceLookup","_namespaceList","_flushFns","_whenQuietFns","collectedEnterElements","collectedLeaveElements","onRemovalComplete","ns","createNamespace","_balanceNamespaceList","collectEnterElement","found","nextNamespace","registerTrigger","_fetchNamespace","afterFlushAnimationsDone","insertBefore","details","markElementAsDisabled","_buildInstruction","subTimelines","containerElement","whenRenderingDone","Promise","resolve","flush","cleanupFns","_flushAnimations","quietFns_1","skippedPlayers","skippedPlayersMap","queuedInstructions","allPreStyleElements","allPostStyleElements","disabledElementsSet","nodesThatAreDisabled","bodyNode","allEnterNodes","allLeaveNodes","leaveNodesWithoutAnimations","allPlayers","erroneousTransitions","stringMap","setVal_1","setVal","errors_1","error","enterNodesWithoutAnimations","allPreviousPlayersMap","sortedParentElements","unshift","_beforeAnimationBuild","_getPreviousPlayers","prevPlayer","preStylesMap","postStylesMap","rootPlayers","subPlayers","innerPlayer","_buildAnimation","setRealPlayer","parentHasPriority","parent_2","parentPlayers","parentPlayer","playersForElement","queriedPlayerResults","queriedInnerElements","j","queriedPlayers","isQueriedElement","toStateValue","queriedElementPlayers","isRemovalAnimation_1","targetNameSpaceId","targetTriggerName","timelineInstruction","realPlayer","getRealPlayer","beforeDestroy","allQueriedPlayers","allConsumedElements","allSubElements","allNewPlayers","pp","wrappedPlayer","_player","_containsRealPlayer","_queuedCallbacks","_destroyed","_queueEvent","hasStarted","getPosition","AnimationEngine","_triggerCache","_transitionEngine","_timelineEngine","componentId","cacheKey","onInsert","onRemove","disableAnimations","disable","process","property","eventPhase","concat","WebAnimationsPlayer","_onDoneFns","_onStartFns","_onDestroyFns","_initialized","_finished","_started","previousStyles","currentSnapshot","_duration","_delay","_onFinish","_preparePlayerBeforeStart","previousStyleProps","startingKeyframe_1","missingStyleProps_1","self_1","_loop_1","_triggerWebAnimation","_finalKeyframe","addEventListener","_resetDomPlayerState","cancel","WebAnimationsDriver","fill","playerOptions","previousWebAnimationPlayers","ɵAnimation","ɵAnimationStyleNormalizer","ɵNoopAnimationStyleNormalizer","ɵWebAnimationsStyleNormalizer","ɵNoopAnimationDriver","ɵAnimationEngine","ɵWebAnimationsDriver","ɵsupportsWebAnimations","ɵWebAnimationsPlayer"],"mappings":";;;;;CAKC,SAAUA,OAAQC,SACC,gBAAZC,UAA0C,mBAAXC,QAAyBF,QAAQC,QAASE,QAAQ,wBACtE,kBAAXC,SAAyBA,OAAOC,IAAMD,QAAQ,UAAW,uBAAwBJ,SACvFA,SAASD,OAAOO,GAAKP,OAAOO,OAAUP,OAAOO,GAAGC,WAAaR,OAAOO,GAAGC,eAAkBR,OAAOO,GAAGC,WAAWC,QAAUT,OAAOO,GAAGC,WAAWC,aAAeT,OAAOO,GAAGC,aACtKE,KAAM,SAAWR,QAAQS,qBAAuB;;;;;;;AAiBlD,QAASC,qBAAoBC,SACzB,OAAQA,QAAQC,QACZ,IAAK,GACD,MAAO,IAAIH,qBAAoBI,mBACnC,KAAK,GACD,MAAOF,SAAQ,EACnB,SACI,MAAO,IAAIF,qBAAoBK,sBAAsBH,UAYjE,QAASI,oBAAmBC,OAAQC,WAAYC,QAASC,UAAWC,UAAWC,YACzD,SAAdD,YAAwBA,cACT,SAAfC,aAAyBA,cAC7B,IAAqBC,WACAC,uBACAC,gBAAiB,EACjBC,iBAAmB,IA+BxC,IA9BAN,UAAUO,QAAQ,SAAUC,IACxB,GAAqBC,QAAUD,GAAY,OACtBE,aAAeD,QAAUJ,eACzBM,mBAAsBD,cAAgBJ,oBAC3DM,QAAOC,KAAKL,IAAID,QAAQ,SAAUO,MAC9B,GAAqBC,gBAAiBD,KACjBE,gBAAkBR,GAAGM,KAC1C,IAAa,WAATA,KAEA,OADAC,eAAiBjB,WAAWmB,sBAAsBF,eAAgBZ,QAC1Da,iBACJ,IAAK1B,qBAAoB4B,WACrBF,gBAAkBf,UAAUa,KAC5B,MACJ,KAAKxB,qBAAoB6B,WACrBH,gBAAkBd,WAAWY,KAC7B,MACJ,SACIE,gBACIlB,WAAWsB,oBAAoBN,KAAMC,eAAgBC,gBAAiBb,QAItFQ,mBAAmBI,gBAAkBC,kBAEpCN,cACDN,oBAAoBiB,KAAKV,oBAE7BL,iBAAmBK,mBACnBN,eAAiBI,SAEjBN,OAAOV,OAAQ,CACf,GAAqB6B,YAAa,OAClC,MAAM,IAAIC,OAAM,iDAAmDD,WAAanB,OAAOqB,KAAKF,aAEhG,MAAOlB,qBASX,QAASqB,gBAAeC,OAAQC,UAAWC,MAAOC,UAC9C,OAAQF,WACJ,IAAK,QACDD,OAAOI,QAAQ,WAAc,MAAOD,UAASD,OAASG,mBAAmBH,MAAO,QAASF,OAAOM,aAChG,MACJ,KAAK,OACDN,OAAOO,OAAO,WAAc,MAAOJ,UAASD,OAASG,mBAAmBH,MAAO,OAAQF,OAAOM,aAC9F,MACJ,KAAK,UACDN,OAAOQ,UAAU,WAAc,MAAOL,UAASD,OAASG,mBAAmBH,MAAO,UAAWF,OAAOM,eAUhH,QAASD,oBAAmBI,EAAGC,UAAWJ,WACtC,GAAqBJ,OAAQS,mBAAmBF,EAAEpC,QAASoC,EAAEG,YAAaH,EAAEI,UAAWJ,EAAEK,QAASJ,WAAaD,EAAEC,UAAwBK,QAAbT,UAAyBG,EAAEH,UAAYA,WAC9IU,KAAO,EAAa,KAIzC,OAHY,OAARA,OACA,MAAiB,MAAIA,MAElBd,MAWX,QAASS,oBAAmBtC,QAASuC,YAAaC,UAAWC,QAASJ,UAAWJ,WAG7E,MAFkB,UAAdI,YAAwBA,UAAY,IACtB,SAAdJ,YAAwBA,UAAY,IAC/BjC,QAASA,QAASuC,YAAaA,YAAaC,UAAWA,UAAWC,QAASA,QAASJ,UAAWA,UAAWJ,UAAWA,WAQlI,QAASW,iBAAgBC,IAAKC,IAAKC,cAC/B,GAAqBC,MAarB,OAZIH,eAAeI,MACfD,MAAQH,IAAIK,IAAIJ,KACXE,OACDH,IAAIM,IAAIL,IAAKE,MAAQD,gBAIzBC,MAAQH,IAAIC,KACPE,QACDA,MAAQH,IAAIC,KAAOC,eAGpBC,MAMX,QAASI,sBAAqBC,SAC1B,GAAqBC,cAAeD,QAAQE,QAAQ,KAC/BC,GAAKH,QAAQI,UAAU,EAAGH,cAC1BI,OAASL,QAAQM,OAAOL,aAAe,EAC5D,QAAQE,GAAIE,QA8IhB,QAASE,oBAAmBZ,OACxB,GAAoB,gBAATA,OACP,MAAOA,MACX,IAAqBa,SAAU,MAAUC,MAAM,oBAC/C,QAAKD,SAAWA,QAAQnE,OAAS,EACtB,EACJqE,sBAAsBC,WAAWH,QAAQ,IAAKA,QAAQ,IAOjE,QAASE,uBAAsBf,MAAOiB,MAClC,OAAQA,MACJ,IAAK,IACD,MAAOjB,OAAQkB,UACnB,SACI,MAAOlB,QASnB,QAASmB,eAAcC,QAAShE,OAAQiE,qBACpC,MAAOD,SAAQE,eAAe,YAAc,QACxCC,oBAAqC,QAAWnE,OAAQiE,qBAQhE,QAASE,qBAAoBC,IAAKpE,OAAQiE,qBACtC,GACqBI,UADAC,MAAQ,2EAERC,MAAQ,EACRC,OAAS,EAC9B,IAAmB,gBAARJ,KAAkB,CACzB,GAAqBX,SAAUW,IAAIV,MAAMY,MACzC,IAAgB,OAAZb,QAEA,MADAzD,QAAOkB,KAAK,8BAAiCkD,IAAM,kBAC1CC,SAAU,EAAGE,MAAO,EAAGC,OAAQ,GAE5CH,UAAWV,sBAAsBC,WAAWH,QAAQ,IAAKA,QAAQ,GACjE,IAAqBgB,YAAahB,QAAQ,EACxB,OAAdgB,aACAF,MAAQZ,sBAAsBe,KAAKC,MAAMf,WAAWa,aAAchB,QAAQ,IAE9E,IAAqBmB,WAAYnB,QAAQ,EACrCmB,aACAJ,OAASI,eAIbP,UAAW,GAEf,KAAKJ,oBAAqB,CACtB,GAAqBY,iBAAiB,EACjBC,WAAa9E,OAAOV,MACrC+E,UAAW,IACXrE,OAAOkB,KAAK,oEACZ2D,gBAAiB,GAEjBN,MAAQ,IACRvE,OAAOkB,KAAK,iEACZ2D,gBAAiB,GAEjBA,gBACA7E,OAAO+E,OAAOD,WAAY,EAAG,8BAAiCV,IAAM,iBAG5E,OAASC,SAAUA,SAAUE,MAAOA,MAAOC,OAAQA,QAOvD,QAASQ,SAAQC,IAAKC,aAGlB,MAFoB,UAAhBA,cAA0BA,gBAC9BzE,OAAOC,KAAKuE,KAAK7E,QAAQ,SAAUO,MAAQuE,YAAYvE,MAAQsE,IAAItE,QAC5DuE,YAMX,QAASC,iBAAgBC,QACrB,GAAqBC,oBAOrB,OANIC,OAAMC,QAAQH,QACdA,OAAOhF,QAAQ,SAAUmC,MAAQ,MAAOiD,YAAWjD,MAAM,EAAO8C,oBAGhEG,WAAWJ,QAAQ,EAAOC,kBAEvBA,iBAQX,QAASG,YAAWJ,OAAQK,cAAeP,aAEvC,GADoB,SAAhBA,cAA0BA,gBAC1BO,cAIA,IAAK,GAAqB9E,QAAQyE,QAC9BF,YAAYvE,MAAQyE,OAAOzE,UAI/BqE,SAAQI,OAAQF,YAEpB,OAAOA,aAOX,QAASQ,WAAU9F,QAASwF,QACpBxF,QAAe,OACfa,OAAOC,KAAK0E,QAAQhF,QAAQ,SAAUO,MAClC,GAAqBgF,WAAYC,oBAAoBjF,KACrDf,SAAQiG,MAAMF,WAAaP,OAAOzE,QAS9C,QAASmF,aAAYlG,QAASwF,QACtBxF,QAAe,OACfa,OAAOC,KAAK0E,QAAQhF,QAAQ,SAAUO,MAClC,GAAqBgF,WAAYC,oBAAoBjF,KACrDf,SAAQiG,MAAMF,WAAa,KAQvC,QAASI,yBAAwBC,OAC7B,MAAIV,OAAMC,QAAQS,OACM,GAAhBA,MAAM1G,OACC0G,MAAM,GACV7G,oBAAoB8G,SAASD,OAEjC,MAQX,QAASE,qBAAoBtD,MAAOuD,QAASnG,QACzC,GAAqBoG,QAASD,QAAQC,WACjB3C,QAAU4C,mBAAmBzD,MAC9Ca,SAAQnE,QACRmE,QAAQrD,QAAQ,SAAUkG,SACjBF,OAAOlC,eAAeoC,UACvBtG,OAAOkB,KAAK,+CAAiDoF,QAAU,kCAUvF,QAASD,oBAAmBzD,OACxB,GAAqBwD,UACrB,IAAqB,gBAAVxD,OAAoB,CAG3B,IAFA,GAAqB2D,KAAM3D,MAAM4D,WACZ9C,MAAQ,OACtBA,MAAQ+C,YAAYC,KAAKH,MAC5BH,OAAOlF,KAAuBwC,MAAM,GAExC+C,aAAYE,UAAY,EAE5B,MAAOP,QAQX,QAASQ,mBAAkBhE,MAAOwD,OAAQpG,QACtC,GAAqB6G,UAAWjE,MAAM4D,WACjBM,IAAMD,SAASE,QAAQN,YAAa,SAAUO,EAAGV,SAClE,GAAqBW,UAAWb,OAAOE,QAMvC,OAJKF,QAAOlC,eAAeoC,WACvBtG,OAAOkB,KAAK,kDAAoDoF,SAChEW,SAAW,IAERA,SAAST,YAGpB,OAAOM,MAAOD,SAAWjE,MAAQkE,IAMrC,QAASI,iBAAgBC,UAGrB,IAFA,GAAqBC,QACAC,KAAOF,SAASG,QAC7BD,KAAKE,MACTH,IAAIlG,KAAKmG,KAAKzE,OACdyE,KAAOF,SAASG,MAEpB,OAAOF,KAaX,QAASxB,qBAAoB4B,OACzB,MAAOA,OAAMT,QAAQU,iBAAkB,WAEnC,IAAK,GADDC,MACKC,GAAK,EAAGA,GAAKC,UAAUtI,OAAQqI,KACpCD,EAAEC,IAAMC,UAAUD,GAEtB,OAAOD,GAAE,GAAGG,gBAQpB,QAASC,gCAA+BzD,SAAUE,OAC9C,MAAoB,KAAbF,UAA4B,IAAVE,MAuB7B,QAASwD,WAAUC,EAAGC,GAElB,QAASC,MAAOhJ,KAAKiJ,YAAcH,EADnCI,cAAcJ,EAAGC,GAEjBD,EAAEK,UAAkB,OAANJ,EAAaxH,OAAO6H,OAAOL,IAAMC,GAAGG,UAAYJ,EAAEI,UAAW,GAAIH,KAiWnF,QAASK,oBAAmBC,QAASC,KAAMC,SACvC,OAAQD,KAAKE,MACT,IAAK,GACD,MAAOH,SAAQI,aAA8B,KAAQF,QACzD,KAAK,GACD,MAAOF,SAAQK,WAA4B,KAAQH,QACvD,KAAK,GACD,MAAOF,SAAQM,gBAAiC,KAAQJ,QAC5D,KAAK,GACD,MAAOF,SAAQO,cAA+B,KAAQL,QAC1D,KAAK,GACD,MAAOF,SAAQQ,WAA4B,KAAQN,QACvD,KAAK,GACD,MAAOF,SAAQS,aAA8B,KAAQP,QACzD,KAAK,GACD,MAAOF,SAAQU,eAAgC,KAAQR,QAC3D,KAAK,GACD,MAAOF,SAAQW,WAA4B,KAAQT,QACvD,KAAK,GACD,MAAOF,SAAQY,eAAgC,KAAQV,QAC3D,KAAK,GACD,MAAOF,SAAQa,kBAAmC,KAAQX,QAC9D,KAAK,IACD,MAAOF,SAAQc,gBAAiC,KAAQZ,QAC5D,KAAK,IACD,MAAOF,SAAQe,WAA4B,KAAQb,QACvD,KAAK,IACD,MAAOF,SAAQgB,aAA8B,KAAQd,QACzD,SACI,KAAM,IAAItH,OAAM,8CAAgDqH,KAAKE,OAwBjF,QAASc,qBAAoBC,gBAAiB1J,QAC1C,GAAqB2J,eASrB,OAR8B,gBAAnBD,iBACP,gBACKE,MAAM,WACNxJ,QAAQ,SAAU0G,KAAO,MAAO+C,yBAAwB/C,IAAK6C,YAAa3J,UAG/E2J,YAAYzI,KAAsB,iBAE/ByI,YAQX,QAASE,yBAAwBC,SAAUH,YAAa3J,QACpD,GAAmB,KAAf8J,SAAS,GAAW,CACpB,GAAqBC,QAASC,oBAAoBF,SAAU9J,OAC5D,IAAqB,kBAAV+J,QAEP,WADAJ,aAAYzI,KAAK6I,OAGrBD,UAAW,OAEf,GAAqBpG,OAAQoG,SAASpG,MAAM,0CAC5C,IAAa,MAATA,OAAiBA,MAAMpE,OAAS,EAEhC,MADAU,QAAOkB,KAAK,uCAA0C4I,SAAW,sBAC1DH,WAEX,IAAqBvH,WAAYsB,MAAM,GAClBuG,UAAYvG,MAAM,GAClBrB,QAAUqB,MAAM,EACrCiG,aAAYzI,KAAKgJ,qBAAqB9H,UAAWC,SACjD,IAAqB8H,oBAAqB/H,WAAagI,WAAa/H,SAAW+H,SAC3D,MAAhBH,UAAU,IAAcE,oBACxBR,YAAYzI,KAAKgJ,qBAAqB7H,QAASD,YAQvD,QAAS4H,qBAAoBK,MAAOrK,QAChC,OAAQqK,OACJ,IAAK,SACD,MAAO,WACX,KAAK,SACD,MAAO,WACX,KAAK,aACD,MAAO,UAAUjI,UAAWC,SAAW,MAAOuB,YAAWvB,SAAWuB,WAAWxB,WACnF,KAAK,aACD,MAAO,UAAUA,UAAWC,SAAW,MAAOuB,YAAWvB,SAAWuB,WAAWxB,WACnF,SAEI,MADApC,QAAOkB,KAAK,+BAAkCmJ,MAAQ,sBAC/C,UAQnB,QAASH,sBAAqBI,IAAKC,KAC/B,MAAO,UAAUnI,UAAWC,SACxB,GAAqBmI,UAAWF,KAAOF,WAAaE,KAAOlI,UACtCqI,SAAWF,KAAOH,WAAaG,KAAOlI,OAO3D,OANKmI,WAAiC,iBAAdpI,aACpBoI,SAAWpI,UAAoB,SAARkI,IAAyB,UAARA,KAEvCG,UAA+B,iBAAZpI,WACpBoI,SAAWpI,QAAkB,SAARkI,IAAyB,UAARA,KAEnCC,UAAYC,UAsB3B,QAASC,mBAAkBC,SAAU3K,QACjC,OAAO,GAAI4K,6BAA6BC,MAAMF,SAAU3K,QA+Z5D,QAAS8K,mBAAkBC,UACvB,GAAqBC,gBAAeD,SAASnB,MAAM,WAAWqB,KAAK,SAAUC,OAAS,MAAOA,QAASC,YAStG,OARIH,gBACAD,SAAWA,SAAShE,QAAQqE,iBAAkB,KAElDL,SAAWA,SAAShE,QAAQsE,kBAAmBC,gBAC1CvE,QAAQwE,kBAAmBC,gBAC3BzE,QAAQ,OAAQ0E,qBAChB1E,QAAQ,QAAS,SAAUrD,OAAS,MAAO+H,qBAAsB,IAAM/H,MAAMH,OAAO,KACpFwD,QAAQ,cAAe2E,wBACpBX,SAAUC,cAMtB,QAASW,iBAAgB1G,KACrB,MAAOA,KAAMD,QAAQC,KAAO,KAwBhC,QAAS2G,eAAcxG,QACnB,GAAqB,gBAAVA,QACP,MAAO,KACX,IAAqB9E,QAAS,IAC9B,IAAIgF,MAAMC,QAAQH,QACdA,OAAOhF,QAAQ,SAAUyL,YACrB,GAAIC,SAASD,aAAeA,WAAW3H,eAAe,UAAW,CAC7D,GAAqBe,KAAM,UAC3B3E,QAASsD,WAA6BqB,IAAa,cAC5CA,KAAY,cAI1B,IAAI6G,SAAS1G,SAAWA,OAAOlB,eAAe,UAAW,CAC1D,GAAqBe,KAAM,MAC3B3E,QAASsD,WAA6BqB,IAAa,cAC5CA,KAAY,OAEvB,MAAO3E,QAMX,QAASwL,UAASlJ,OACd,OAAQ0C,MAAMC,QAAQ3C,QAA0B,gBAATA,OAO3C,QAASmJ,oBAAmBnJ,MAAO5C,QAC/B,GAAqBgE,SAAU,IAC/B,IAAIpB,MAAMsB,eAAe,YACrBF,QAAU,UAET,IAAoB,gBAATpB,OAAmB,CACCmB,cAA+B,MAAS/D,QAAQqE,QAChF,OAAO,IAAI2H,WAA2B,MAAS,EAAG,IAEtD,GAAqBC,UAAW,MACXC,UAAYD,SAASrC,MAAM,OAAOuC,KAAK,SAAUC,GAAK,MAAsB,KAAfA,EAAEC,OAAO,IAA4B,KAAfD,EAAEC,OAAO,IACjH,OAAIH,WACO,GAAII,kBAAiBL,WAEhCjI,QAAUA,SAAWD,cAAckI,SAAUjM,QACtC,GAAIgM,WAAUhI,QAAQK,SAAUL,QAAQO,MAAOP,QAAQQ,SAMlE,QAAS+H,2BAA0BpG,SAU/B,MATIA,UACAA,QAAUnB,QAAQmB,SACdA,QAAgB,SAChBA,QAAgB,OAAMwF,gBAAgBxF,QAAgB,UAI1DA,WAEGA,QAsBX,QAASqG,2BAA0B5M,QAASC,UAAW4M,cAAeC,eAAgBrI,SAAUE,MAAOC,OAAQmI,aAG3G,MAFe,UAAXnI,SAAqBA,OAAS,MACd,SAAhBmI,cAA0BA,aAAc,IAExChE,KAAM,EACN/I,QAASA,QACTC,UAAWA,UACX4M,cAAeA,cACfC,eAAgBA,eAChBrI,SAAUA,SACVE,MAAOA,MACP1C,UAAWwC,SAAWE,MAAOC,OAAQA,OAAQmI,YAAaA,aAyElE,QAASC,yBAAwBlN,OAAQmN,YAAaC,IAAKC,eAAgBC,YAAa7G,QAAS8G,gBAAiBjN,QAI9G,MAHuB,UAAnB+M,iBAA6BA,mBACb,SAAhBC,cAA0BA,gBACf,SAAXhN,SAAqBA,YAClB,GAAIkN,kCAAkCC,eAAezN,OAAQmN,YAAaC,IAAKC,eAAgBC,YAAa7G,QAAS8G,gBAAiBjN,QA62BjJ,QAASoN,aAAY9M,OAAQ+M,eACH,SAAlBA,gBAA4BA,cAAgB,EAChD,IAAqBC,MAAO5I,KAAK6I,IAAI,GAAIF,cAAgB,EACzD,OAAO3I,MAAK8I,MAAMlN,OAASgN,MAAQA,KAOvC,QAASG,eAAcjG,MAAOkG,WAC1B,GACqBC,eADAvI,SAWrB,OATAoC,OAAMpH,QAAQ,SAAU8K,OACN,MAAVA,OACAyC,cAAgBA,eAAiBlN,OAAOC,KAAKgN,WAC7CC,cAAcvN,QAAQ,SAAUO,MAAQyE,OAAOzE,MAAQxB,oBAAoB6B,cAG3EwE,WAA4B,OAAS,EAAOJ,UAG7CA,OA0IX,QAASwI,gBAAelN,MACpB,GAAqB+B,OAErB,OADA/B,MAAKN,QAAQ,SAAUsC,KAAO,MAAOD,KAAIC,MAAO,IACzCD,IA0BX,QAASoL,6BAA4BjO,QAASuC,YAAaC,UAAWC,QAASyL,oBAAqBC,WAAYC,SAAUC,UAAWC,gBAAiBzB,cAAeC,eAAgB1M,QACjL,OACI2I,KAAM,EACN/I,QAASA,QACTuC,YAAaA,YACb2L,oBAAqBA,oBACrB1L,UAAWA,UACX2L,WAAYA,WACZ1L,QAASA,QACT2L,SAAUA,SACVC,UAAWA,UACXC,gBAAiBA,gBACjBzB,cAAeA,cACfC,eAAgBA,eAChB1M,OAAQA,QAuFhB,QAASmO,2BAA0BC,SAAUC,aAAcC,WACvD,MAAOF,UAASjC,KAAK,SAAUoC,IAAM,MAAOA,IAAGF,aAAcC,aAoDjE,QAASE,cAAaC,KAAM3B,KACxB,MAAO,IAAI4B,kBAAiBD,KAAM3B,KA4DtC,QAAS6B,0BAAyBxM,YAAayM,QAC3C,GAAqBC,WAAY,SAAUzM,UAAWC,SAAW,OAAO,IACnDyM,UAAY,GAAIC,iBAChBC,WAAa,GAAIC,eAAcJ,SAAUC,UAC9D,OAAO,IAAII,4BAA2B/M,YAAa6M,WAAYJ,QAQnE,QAASO,mBAAkBlK,IAAKmK,KAAMC,MAC9BpK,IAAIf,eAAekL,MACdnK,IAAIf,eAAemL,QACpBpK,IAAIoK,MAAQpK,IAAImK,OAGfnK,IAAIf,eAAemL,QACxBpK,IAAImK,MAAQnK,IAAIoK,OA6nDxB,QAASC,oBAAmB7M,IAAKC,IAAKE,OAClC,GAAqB2M,cACrB,IAAI9M,cAAeI,MAEf,GADA0M,cAAgB9M,IAAIK,IAAIJ,KACL,CACf,GAAI6M,cAAcjQ,OAAQ,CACtB,GAAqBkQ,OAAQD,cAAcpM,QAAQP,MACnD2M,eAAcxK,OAAOyK,MAAO,GAEJ,GAAxBD,cAAcjQ,QACdmD,IAAIgN,OAAO/M,UAMnB,IADA6M,cAAgB9M,IAAIC,KACD,CACf,GAAI6M,cAAcjQ,OAAQ,CACtB,GAAqBkQ,OAAQD,cAAcpM,QAAQP,MACnD2M,eAAcxK,OAAOyK,MAAO,GAEJ,GAAxBD,cAAcjQ,cACPmD,KAAIC,KAIvB,MAAO6M,eAMX,QAASG,uBAAsB9M,OAC3B,aAAeA,QACX,IAAK,UACD,MAAOA,OAAQ,IAAM,GACzB,SACI,MAAgB,OAATA,MAAgBA,MAAM4D,WAAa,MAOtD,QAASmJ,eAAclH,MACnB,MAAOA,OAA6B,IAArBA,KAAe,SAMlC,QAASmH,qBAAoBpO,WACzB,MAAoB,SAAbA,WAAqC,QAAbA,UAOnC,QAASqO,cAAajQ,QAASgD,OAC3B,GAAqBkN,UAAWlQ,QAAQiG,MAAMkK,OAE9C,OADAnQ,SAAQiG,MAAMkK,QAAmB,MAATnN,MAAgBA,MAAQ,OACzCkN,SASX,QAASE,uBAAsBtQ,OAAQuQ,SAAUC,gBAAiBC,cAC9D,GAAqBC,WAAYH,SAASxN,IAAI,SAAU7C,SAAW,MAAOiQ,cAAajQ,WAClEyQ,UAAY,GAAIxN,IAcrC,OAbAqN,iBAAgB9P,QAAQ,SAAUkQ,MAAO1Q,SACrC,GAAqBwF,UACrBkL,OAAMlQ,QAAQ,SAAUO,MACpB,GAAqBiC,OAAQwC,OAAOzE,MAAQjB,OAAO6Q,aAAa3Q,QAASe,KAAMwP,aAG1EvN,QAAyB,GAAhBA,MAAMtD,SAChBM,QAAQ4Q,cAAgBC,8BAGhCJ,UAAUtN,IAAInD,QAASwF,UAE3B6K,SAAS7P,QAAQ,SAAUR,QAAS8Q,GAAK,MAAOb,cAAajQ,QAASwQ,UAAUM,MACzEL,UAMX,QAASM,sBAAqBC,OAC1B,GAEqBC,QAFAC,QAAU,GAAIC,KAAIH,OAClBI,mBAAqB,GAAID,IAe9C,OAbAF,QAAS,SAAUpI,MACf,OAAKA,OAEDqI,QAAQG,IAAIxI,KAAKyI,gBAEjBF,mBAAmBC,IAAIxI,KAAKyI,eAE5BL,OAAOpI,KAAKyI,cACZF,mBAAmBG,IAAI1I,OAChB,KAYnB,QAAS2I,eAAcxR,QAASyR,WAC5B,GAAIzR,QAAQ0R,UACR,MAAO1R,SAAQ0R,UAAUC,SAASF,UAGlC,IAAqBG,SAAU5R,QAAQ6R,kBACvC,OAAOD,UAAWA,QAAQH,WAQlC,QAASK,UAAS9R,QAASyR,WACvB,GAAIzR,QAAQ0R,UACR1R,QAAQ0R,UAAUH,IAAIE,eAErB,CACD,GAAqBG,SAAU5R,QAAQ6R,kBAClCD,WACDA,QAAU5R,QAAQ6R,uBAEtBD,QAAQH,YAAa,GAQ7B,QAASM,aAAY/R,QAASyR,WAC1B,GAAIzR,QAAQ0R,UACR1R,QAAQ0R,UAAUM,OAAOP,eAExB,CACD,GAAqBG,SAAU5R,QAAQ6R,kBACnCD,gBACOA,SAAQH,YAO3B,QAASQ,eACL,MAAuB,mBAAZC,UACAA,SAASC,KAEb,KAQX,QAASC,+BAA8BC,OAAQrS,QAASP,SACpDD,oBAAoBC,SAASyC,OAAO,WAAc,MAAOmQ,QAAOC,iBAAiBtS,WAMrF,QAASuS,qBAAoB9S,SACzB,GAAqB+S,gBAErB,OADAC,2BAA0BhT,QAAS+S,cAC5BA,aAOX,QAASC,2BAA0BhT,QAAS+S,cACxC,IAAK,GAAqB1B,GAAI,EAAGA,EAAIrR,QAAQC,OAAQoR,IAAK,CACtD,GAAqBnP,QAASlC,QAAQqR,EAClCnP,kBAAkBpC,qBAAoBK,sBACtC6S,0BAA0B9Q,OAAOlC,QAAS+S,cAG1CA,aAAalR,KAAsB,SAS/C,QAASoR,WAAUC,EAAGtK,GAClB,GAAqBuK,IAAK/R,OAAOC,KAAK6R,GACjBE,GAAKhS,OAAOC,KAAKuH,EACtC,IAAIuK,GAAGlT,QAAUmT,GAAGnT,OAChB,OAAO,CACX,KAAK,GAAqBoR,GAAI,EAAGA,EAAI8B,GAAGlT,OAAQoR,IAAK,CACjD,GAAqB/P,MAAO6R,GAAG9B,EAC/B,KAAKzI,EAAE/D,eAAevD,OAAS4R,EAAE5R,QAAUsH,EAAEtH,MACzC,OAAO,EAEf,OAAO,EAyYX,QAAS+R,eAAc9S,QAASe,MAC5B,MAASgS,QAAOC,iBAAiBhT,SAAWe,MAoEhD,QAASkS,yBACL,MAA0B,mBAAZC,UAAuE,kBAArC,SAAYzK,UAAmB,QA5kKnF,GAAI0K,WAAY,SAAUC,KAAMC,MAAQ,OAAO,GAC3CC,SAAW,SAAUtT,QAASmL,UAC9B,OAAO,GAEPoI,OAAS,SAAUvT,QAASmL,SAAUqI,OACtC,SAEJ,IAAsB,mBAAXN,SAAwB,CAG/B,GADAC,UAAY,SAAUC,KAAMC,MAAQ,MAAQD,MAAKzB,SAAS0B,OACtDH,QAAQzK,UAAU5E,QAClByP,SAAW,SAAUtT,QAASmL,UAAY,MAAOnL,SAAQ6D,QAAQsH,eAEhE,CACD,GAAqBsI,OAASP,QAAiB,UAC1BQ,KAAOD,MAAME,iBAAmBF,MAAMG,oBAAsBH,MAAMI,mBACnFJ,MAAMK,kBAAoBL,MAAMM,qBAChCL,QACAJ,SAAW,SAAUtT,QAASmL,UAAY,MAAOuI,MAAKM,MAAMhU,SAAUmL,aAG9EoI,OAAS,SAAUvT,QAASmL,SAAUqI,OAClC,GAAqBS,WACrB,IAAIT,MACAS,QAAQ3S,KAAK0S,MAAMC,QAASjU,QAAQkU,iBAAiB/I,eAEpD,CACD,GAAqBgJ,KAAMnU,QAAQoU,cAAcjJ,SAC7CgJ,MACAF,QAAQ3S,KAAK6S,KAGrB,MAAOF,UAGf,GAAII,gBAAiBf,SACjBgB,gBAAkBnB,UAClBoB,YAAchB,OAgBdiB,oBAAuB,WACvB,QAASA,wBA+CT,MAxCAA,qBAAoB/L,UAAU4L,eAAiB,SAAUrU,QAASmL,UAC9D,MAAOkJ,gBAAerU,QAASmL,WAOnCqJ,oBAAoB/L,UAAU6L,gBAAkB,SAAUlB,KAAMC,MAAQ,MAAOiB,iBAAgBlB,KAAMC,OAOrGmB,oBAAoB/L,UAAUgM,MAAQ,SAAUzU,QAASmL,SAAUqI,OAC/D,MAAOe,aAAYvU,QAASmL,SAAUqI,QAQ1CgB,oBAAoB/L,UAAUkI,aAAe,SAAU3Q,QAASe,KAAMgC,cAClE,MAAOA,eAAgB,IAW3ByR,oBAAoB/L,UAAUiM,QAAU,SAAU1U,QAASC,UAAWwE,SAAUE,MAAOC,OAAQ+P,iBAE3F,MADwB,UAApBA,kBAA8BA,oBAC3B,GAAIpV,qBAAoBI,qBAE5B6U,uBAMPI,gBAAmB,WACnB,QAASA,oBAET,MAAOA,mBAEXA,iBAAgBC,KAAO,GAAIL;;;;;;;AAa3B,GAAItQ,YAAa,IACb4Q,wBAA0B,KAC1BC,sBAAwB,KACxBC,gBAAkB,WAClBC,gBAAkB,WAClBvJ,eAAiB,YACjBE,eAAiB,YACjBsJ,qBAAuB,aACvBrJ,oBAAsB,cACtBsJ,uBAAyB,eACzBrJ,sBAAwB,gBAuLxBjF,YAAc,GAAIuO,QAAON,wBAA0B,gBAAkBC,sBAAuB,KAwD5FlN,iBAAmB,gBAuCnBW,cAAgB3H,OAAOwU,iBACpBC,uBAA2B5P,QAAS,SAAU0C,EAAGC,GAAKD,EAAEkN,UAAYjN,IACvE,SAAUD,EAAGC,GAAK,IAAK,GAAIkN,KAAKlN,GAAOA,EAAE/D,eAAeiR,KAAInN,EAAEmN,GAAKlN,EAAEkN,KAQrEC,SAAW3U,OAAO4U,QAAU,SAAkBC,GAC9C,IAAK,GAAIC,GAAG7E,EAAI,EAAG8E,EAAI5N,UAAUtI,OAAQoR,EAAI8E,EAAG9E,IAAK,CACjD6E,EAAI3N,UAAU8I,EACd,KAAK,GAAIyE,KAAKI,GAAO9U,OAAO4H,UAAUnE,eAAeuR,KAAKF,EAAGJ,KAAIG,EAAEH,GAAKI,EAAEJ,IAE9E,MAAOG,IAOPI,2BAQAC,IAAO,WACP,QAASA,OACLzW,KAAKiH,QAAUuP,wBAUnB,MARAjV,QAAOmV,eAAeD,IAAItN,UAAW,UAIjCvF,IAAK,WAAc,MAAO5D,MAAKiH,QAAgB,QAAK,MACpD0P,YAAY,EACZC,cAAc,IAEXH,OAEPI,WAAc,SAAUC,QAOxB,QAASD,YAAWtH,KAAMG,OAAQqH,aAC9B,GAAIC,OAAQF,OAAOP,KAAKvW,OAASA,IAMjC,OALAgX,OAAMzH,KAAOA,KACbyH,MAAMtH,OAASA,OACfsH,MAAMD,YAAcA,YACpBC,MAAMC,WAAa,EACnBD,MAAME,SAAW,EACVF,MAQX,MArBAnO,WAAUgO,WAAYC,QAoBtBD,WAAW1N,UAAUgO,MAAQ,SAAU7N,QAASE,SAAW,MAAOF,SAAQI,aAAa1J,KAAMwJ,UACtFqN,YACTJ,KACEW,SAAY,SAAUN,QAMtB,QAASM,UAAS7H,KAAM8H,UACpB,GAAIL,OAAQF,OAAOP,KAAKvW,OAASA,IAGjC,OAFAgX,OAAMzH,KAAOA,KACbyH,MAAMrQ,MAAQ0Q,SACPL,MAQX,MAjBAnO,WAAUuO,SAAUN,QAgBpBM,SAASjO,UAAUgO,MAAQ,SAAU7N,QAASE,SAAW,MAAOF,SAAQK,WAAW3J,KAAMwJ,UAClF4N,UACTX,KACE1G,cAAiB,SAAU+G,QAM3B,QAAS/G,eAAcJ,SAAUC,WAC7B,GAAIoH,OAAQF,OAAOP,KAAKvW,OAASA,IAKjC,OAJAgX,OAAMrH,SAAWA,SACjBqH,MAAMpH,UAAYA,UAClBoH,MAAMC,WAAa,EACnBD,MAAME,SAAW,EACVF,MAQX,MAnBAnO,WAAUkH,cAAe+G,QAkBzB/G,cAAc5G,UAAUgO,MAAQ,SAAU7N,QAASE,SAAW,MAAOF,SAAQM,gBAAgB5J,KAAMwJ,UAC5FuG,eACT0G,KACE5G,YAAe,SAAUiH,QAKzB,QAASjH,aAAY/I,OACjB,GAAIkQ,OAAQF,OAAOP,KAAKvW,OAASA,IAEjC,OADAgX,OAAMlQ,MAAQA,MACPkQ,MAQX,MAfAnO,WAAUgH,YAAaiH,QAcvBjH,YAAY1G,UAAUgO,MAAQ,SAAU7N,QAASE,SAAW,MAAOF,SAAQO,cAAc7J,KAAMwJ,UACxFqG,aACT4G,KACEa,SAAY,SAAUR,QAKtB,QAASQ,UAASxQ,OACd,GAAIkQ,OAAQF,OAAOP,KAAKvW,OAASA,IAEjC,OADAgX,OAAMlQ,MAAQA,MACPkQ,MAQX,MAfAnO,WAAUyO,SAAUR,QAcpBQ,SAASnO,UAAUgO,MAAQ,SAAU7N,QAASE,SAAW,MAAOF,SAAQQ,WAAW9J,KAAMwJ,UAClF8N,UACTb,KACEc,WAAc,SAAUT,QAMxB,QAASS,YAAWzS,QAASuS,UACzB,GAAIL,OAAQF,OAAOP,KAAKvW,OAASA,IAGjC,OAFAgX,OAAMlS,QAAUA,QAChBkS,MAAMrQ,MAAQ0Q,SACPL,MAQX,MAjBAnO,WAAU0O,WAAYT,QAgBtBS,WAAWpO,UAAUgO,MAAQ,SAAU7N,QAASE,SAAW,MAAOF,SAAQS,aAAa/J,KAAMwJ,UACtF+N,YACTd,KACEe,SAAY,SAAUV,QAOtB,QAASU,UAAStR,OAAQZ,OAAQlE,QAC9B,GAAI4V,OAAQF,OAAOP,KAAKvW,OAASA,IAMjC,OALAgX,OAAM9Q,OAASA,OACf8Q,MAAM1R,OAASA,OACf0R,MAAM5V,OAASA,OACf4V,MAAMS,aAAc,EACpBT,MAAMU,uBAAwB,EACvBV,MAQX,MArBAnO,WAAU2O,SAAUV,QAoBpBU,SAASrO,UAAUgO,MAAQ,SAAU7N,QAASE,SAAW,MAAOF,SAAQW,WAAWjK,KAAMwJ,UAClFgO,UACTf,KACEkB,aAAgB,SAAUb,QAK1B,QAASa,cAAazR,QAClB,GAAI8Q,OAAQF,OAAOP,KAAKvW,OAASA,IAEjC,OADAgX,OAAM9Q,OAASA,OACR8Q,MAQX,MAfAnO,WAAU8O,aAAcb,QAcxBa,aAAaxO,UAAUgO,MAAQ,SAAU7N,QAASE,SAAW,MAAOF,SAAQU,eAAehK,KAAMwJ,UAC1FmO,cACTlB,KACEmB,aAAgB,SAAUd,QAK1B,QAASc,cAAahI,WAClB,GAAIoH,OAAQF,OAAOP,KAAKvW,OAASA,IAEjC,OADAgX,OAAMpH,UAAYA,UACXoH,MAQX,MAfAnO,WAAU+O,aAAcd,QAcxBc,aAAazO,UAAUgO,MAAQ,SAAU7N,QAASE,SAAW,MAAOF,SAAQY,eAAelK,KAAMwJ,UAC1FoO,cACTnB,KACEoB,gBAAmB,SAAUf,QAE7B,QAASe,mBACL,MAAOf,QAAOP,KAAKvW,OAASA,KAQhC,MAVA6I,WAAUgP,gBAAiBf,QAS3Be,gBAAgB1O,UAAUgO,MAAQ,SAAU7N,QAASE,SAAW,MAAOF,SAAQa,kBAAkBnK,KAAMwJ,UAChGqO,iBACTpB,KACEqB,cAAiB,SAAUhB,QAK3B,QAASgB,eAAclI,WACnB,GAAIoH,OAAQF,OAAOP,KAAKvW,OAASA,IAEjC,OADAgX,OAAMpH,UAAYA,UACXoH,MAQX,MAfAnO,WAAUiP,cAAehB,QAczBgB,cAAc3O,UAAUgO,MAAQ,SAAU7N,QAASE,SAAW,MAAOF,SAAQc,gBAAgBpK,KAAMwJ,UAC5FsO,eACTrB,KACEsB,SAAY,SAAUjB,QAStB,QAASiB,UAASlM,SAAUmM,MAAOC,SAAUC,YAAatI,WACtD,GAAIoH,OAAQF,OAAOP,KAAKvW,OAASA,IAMjC,OALAgX,OAAMnL,SAAWA,SACjBmL,MAAMgB,MAAQA,MACdhB,MAAMiB,SAAWA,SACjBjB,MAAMkB,YAAcA,YACpBlB,MAAMpH,UAAYA,UACXoH,MAQX,MAvBAnO,WAAUkP,SAAUjB,QAsBpBiB,SAAS5O,UAAUgO,MAAQ,SAAU7N,QAASE,SAAW,MAAOF,SAAQe,WAAWrK,KAAMwJ,UAClFuO,UACTtB,KACE0B,WAAc,SAAUrB,QAMxB,QAASqB,YAAWrT,QAAS8K,WACzB,GAAIoH,OAAQF,OAAOP,KAAKvW,OAASA,IAGjC,OAFAgX,OAAMlS,QAAUA,QAChBkS,MAAMpH,UAAYA,UACXoH,MAQX,MAjBAnO,WAAUsP,WAAYrB,QAgBtBqB,WAAWhP,UAAUgO,MAAQ,SAAU7N,QAASE,SAAW,MAAOF,SAAQgB,aAAatK,KAAMwJ,UACtF2O,YACT1B,KACE3J,UAAa,SAAUgK,QAOvB,QAAShK,WAAU3H,SAAUE,MAAOC,QAClB,SAAVD,QAAoBA,MAAQ,GACjB,SAAXC,SAAqBA,OAAS,KAClC,IAAI0R,OAAQF,OAAOP,KAAKvW,OAASA,IAIjC,OAHAgX,OAAM7R,SAAWA,SACjB6R,MAAM3R,MAAQA,MACd2R,MAAM1R,OAASA,OACR0R,MAQX,MArBAnO,WAAUiE,UAAWgK,QAoBrBhK,UAAU3D,UAAUgO,MAAQ,SAAU7N,QAASE,SAAW,MAAOF,SAAQ8O,YAAYpY,KAAMwJ,UACpFsD,WACT2J,KACErJ,iBAAoB,SAAU0J,QAK9B,QAAS1J,kBAAiB1J,OACtB,GAAIsT,OAAQF,OAAOP,KAAKvW,KAAM,EAAG,EAAG,KAAOA,IAE3C,OADAgX,OAAMtT,MAAQA,MACPsT,MAQX,MAfAnO,WAAUuE,iBAAkB0J,QAc5B1J,iBAAiBjE,UAAUgO,MAAQ,SAAU7N,QAASE,SAAW,MAAOF,SAAQ8O,YAAYpY,KAAMwJ,UAC3F4D,kBACTN,WA+DM5B,UAAY,IAiGhBe,WAAa,QACbC,iBAAmB,GAAI4J,QAAO,KAAO7J,WAAa,OAAQ,KAS1DoM,YAAc,SACdhM,kBAAoB,GAAIyJ,QAAOuC,YAAa,KAC5CC,YAAc,SACdnM,kBAAoB,GAAI2J,QAAOwC,YAAa,KAC5CC,cAAgB,GAChB7M,2BAA8B,WAC9B,QAASA,+BAiZT,MA1YAA,4BAA2BvC,UAAUwC,MAAQ,SAAUF,SAAU3K,QAC7D,GAAqB0I,SAAU,GAAIgP,4BAA2B1X,OAE9D,OADAd,MAAKyY,8BAA8BjP,SAC3BH,mBAAmBrJ,KAAM6G,wBAAwB4E,UAAWjC,UAMxEkC,2BAA2BvC,UAAUsP,8BAAgC,SAAUjP,SAC3EA,QAAQkP,qBAAuBH,cAC/B/O,QAAQmP,mBACRnP,QAAQmP,gBAAgBJ,kBACxB/O,QAAQoP,YAAc,GAO1BlN,2BAA2BvC,UAAUO,aAAe,SAAU+B,SAAUjC,SACpE,GAAIwN,OAAQhX,KACSiX,WAAazN,QAAQyN,WAAa,EAClCC,SAAW1N,QAAQ0N,SAAW,EAC9BxH,UACAqH,cACrBtL,UAASoN,YAAY3X,QAAQ,SAAU4X,KAEnC,GADA9B,MAAMyB,8BAA8BjP,SACpB,GAAZsP,IAAIrP,KAAuB,CAC3B,GAAqBsP,YAAa,IACbC,OAASD,WAAWxJ,IACzCyJ,QAAOtO,MAAM,WAAWxJ,QAAQ,SAAUoV,GACtCyC,WAAWxJ,KAAO+G,EAClB5G,OAAO1N,KAAKgV,MAAMrN,WAAWoP,WAAYvP,YAE7CuP,WAAWxJ,KAAOyJ,WAEjB,IAAgB,GAAZF,IAAIrP,KAA4B,CACrC,GAAqBqG,YAAakH,MAAMpN,gBAAiC,IAAOJ,QAChFyN,aAAcnH,WAAWmH,WACzBC,UAAYpH,WAAWoH,SACvBH,YAAY/U,KAAK8N,gBAGjBtG,SAAQ1I,OAAOkB,KAAK,4EAG5B,IAAqB4L,KAAM,GAAIiJ,YAAWpL,SAAS8D,KAAMG,OAAQqH,YAIjE,OAHAnJ,KAAI3G,QAAUoG,0BAA0B5B,SAASxE,SACjD2G,IAAIqJ,WAAaA,WACjBrJ,IAAIsJ,SAAWA,SACRtJ,KAOXlC,2BAA2BvC,UAAUQ,WAAa,SAAU8B,SAAUjC,SAClE,GAAqByP,UAAWjZ,KAAKiK,WAAWwB,SAASvF,OAAQsD,SAC5C0P,UAAazN,SAASxE,SAAWwE,SAASxE,QAAQC,QAAW,IAClF,IAAI+R,SAASvB,sBAAuB,CAChC,GAAqByB,eAAgB,GAAItH,KACpBuH,SAAWF,aAahC,IAZAD,SAAS/S,OAAOhF,QAAQ,SAAUwC,OAC9B,GAAIkJ,SAASlJ,OAAQ,CACjB,GAAqB2V,aAAc,KACnC9X,QAAOC,KAAK6X,aAAanY,QAAQ,SAAUO,MACvC0F,mBAAmBkS,YAAY5X,OAAOP,QAAQ,SAAUoY,KAC/CF,SAASpU,eAAesU,MACzBH,cAAclH,IAAIqH,YAMlCH,cAAcI,KAAM,CACpB,GAAqBC,gBAAiBxR,gBAAgBmR,cAAcM,SACpEjQ,SAAQ1I,OAAOkB,KAAK,UAAayJ,SAAS8D,KAAO,iFAAoFiK,eAAerX,KAAK,QAGjK,GAAqBuX,UAAW,GAAItC,UAAS3L,SAAS8D,KAAM0J,SAI5D,OAHIC,aACAQ,SAASzS,SAAYC,OAAQgS,YAE1BQ,UAOXhO,2BAA2BvC,UAAUS,gBAAkB,SAAU6B,SAAUjC,SACvEA,QAAQyN,WAAa,EACrBzN,QAAQ0N,SAAW,CACnB,IAAqByC,OAAQtQ,mBAAmBrJ,KAAM6G,wBAAwB4E,SAASmE,WAAYpG,SAC9EmG,SAAWpF,oBAAoBkB,SAASmO,KAAMpQ,QAAQ1I,QACtD8M,IAAM,GAAImC,eAAcJ,SAAUgK,MAIvD,OAHA/L,KAAI3G,QAAUoG,0BAA0B5B,SAASxE,SACjD2G,IAAIqJ,WAAazN,QAAQyN,WACzBrJ,IAAIsJ,SAAW1N,QAAQ0N,SAChBtJ,KAOXlC,2BAA2BvC,UAAUU,cAAgB,SAAU4B,SAAUjC,SACrE,GAAIwN,OAAQhX,KACS4N,IAAM,GAAIiC,aAAYpE,SAAS3E,MAAMvD,IAAI,SAAU8S,GAAK,MAAOhN,oBAAmB2N,MAAOX,EAAG7M,WAEjH,OADAoE,KAAI3G,QAAUoG,0BAA0B5B,SAASxE,SAC1C2G,KAOXlC,2BAA2BvC,UAAUW,WAAa,SAAU2B,SAAUjC,SAClE,GAAIwN,OAAQhX,KACS4Y,YAAcpP,QAAQoP,YACtBiB,aAAe,EACf/S,MAAQ2E,SAAS3E,MAAMvD,IAAI,SAAUuW,MACtDtQ,QAAQoP,YAAcA,WACtB,IAAqBmB,UAAW1Q,mBAAmB2N,MAAO8C,KAAMtQ,QAEhE,OADAqQ,cAAerU,KAAKwU,IAAIH,aAAcrQ,QAAQoP,aACvCmB,UAEXvQ,SAAQoP,YAAciB,YACtB,IAAqBjM,KAAM,GAAI0J,UAASxQ,MAExC,OADA8G,KAAI3G,QAAUoG,0BAA0B5B,SAASxE,SAC1C2G,KAOXlC,2BAA2BvC,UAAUY,aAAe,SAAU0B,SAAUjC,SACpE,GAAqByQ,WAAYpN,mBAAmBpB,SAAS3G,QAAS0E,QAAQ1I,OAC9E0I,SAAQ0Q,sBAAwBD,SAChC,IAAqB/T,QACAiU,cAAgB1O,SAASvF,OAASuF,SAASvF,OAASjG,oBAAoB0G,SAC7F,IAA0B,GAAtBwT,cAAc1Q,KACdvD,OAASlG,KAAKgK,eAAgC,cAAiBR,aAE9D,CACD,GAAqB4Q,iBAAmB3O,SAAe,OAClC4O,SAAU,CAC/B,KAAKD,gBAAiB,CAClBC,SAAU,CACV,IAAqBC,gBACjBL,WAAU3U,SACVgV,aAAqB,OAAIL,UAAU3U,QAEvC8U,gBAAkBna,oBAAoB0G,MAAM2T,cAEhD9Q,QAAQoP,aAAeqB,UAAU9U,SAAW8U,UAAU5U,KACtD,IAAqB4T,UAAWjZ,KAAKiK,WAAWmQ,gBAAiB5Q,QACjEyP,UAASxB,YAAc4C,QACvBnU,OAAS+S,SAGb,MADAzP,SAAQ0Q,sBAAwB,KACzB,GAAI3C,YAAW0C,UAAW/T,SAOrCwF,2BAA2BvC,UAAUc,WAAa,SAAUwB,SAAUjC,SAClE,GAAqBoE,KAAM5N,KAAKua,cAAc9O,SAAUjC,QAExD,OADAxJ,MAAKwa,kBAAkB5M,IAAKpE,SACrBoE,KAOXlC,2BAA2BvC,UAAUoR,cAAgB,SAAU9O,SAAUjC,SACrE,GAAqBtD,UACjBE,OAAMC,QAAQoF,SAASvF,QACrBuF,SAAgB,OAAEvK,QAAQ,SAAUyL,YACT,gBAAdA,YACHA,YAAc1M,oBAAoB6B,WAClCoE,OAAOlE,KAAsB,YAG7BwH,QAAQ1I,OAAOkB,KAAK,mCAAqC2K,WAAa,oBAI1EzG,OAAOlE,KAAsB,cAKrCkE,OAAOlE,KAAKyJ,SAASvF,OAEzB,IAAqBwR,wBAAwB,EACxB+C,gBAAkB,IACvCvU,QAAOhF,QAAQ,SAAUwZ,WACrB,GAAI9N,SAAS8N,WAAY,CACrB,GAAqBC,UAAW,UACXrV,OAASqV,SAAiB,MAK/C,IAJIrV,SACAmV,gBAAkB,aACXE,UAAiB,SAEvBjD,sBACD,IAAK,GAAqBjW,QAAQkZ,UAAU,CACxC,GAAqBjX,OAAQiX,SAASlZ,KACtC,IAAIiC,MAAM4D,WAAWrD,QAAQuR,0BAA4B,EAAG,CACxDkC,uBAAwB,CACxB,WAMpB,IAAqB9J,KAAM,GAAI4J,UAAStR,OAAQuU,gBAAiBhP,SAASrK,OAE1E,OADAwM,KAAI8J,sBAAwBA,sBACrB9J,KAOXlC,2BAA2BvC,UAAUqR,kBAAoB,SAAU5M,IAAKpE,SACpE,GAAqB1E,SAAU0E,QAAQ0Q,sBAClBU,QAAUpR,QAAQoP,YAClBiC,UAAYrR,QAAQoP,WACrC9T,UAAW+V,UAAY,IACvBA,WAAa/V,QAAQK,SAAWL,QAAQO,OAE5CuI,IAAI1H,OAAOhF,QAAQ,SAAU4Z,OACL,gBAATA,QAEXvZ,OAAOC,KAAKsZ,OAAO5Z,QAAQ,SAAUO,MACjC,GAAqBkX,iBAAkBnP,QAAQmP,gBAAkBnP,QAA6B,sBACzEuR,eAAiBpC,gBAAgBlX,MACjCuZ,sBAAuB,CACxCD,kBACIF,WAAaD,SAAWC,WAAaE,eAAeF,WACpDD,SAAWG,eAAeH,UAC1BpR,QAAQ1I,OAAOkB,KAAK,qBAAwBP,KAAO,uCAA2CsZ,eAAeF,UAAY,YAAgBE,eAAeH,QAAU,4EAAgFC,UAAY,YAAgBD,QAAU,OACxRI,sBAAuB,GAK3BH,UAAYE,eAAeF,WAE3BG,uBACArC,gBAAgBlX,OAAUoZ,UAAWA,UAAWD,QAASA,UAEzDpR,QAAQvC,SACRD,oBAAoB8T,MAAMrZ,MAAO+H,QAAQvC,QAASuC,QAAQ1I,aAU1E4K,2BAA2BvC,UAAUa,eAAiB,SAAUyB,SAAUjC,SACtE,GAAIwN,OAAQhX,IACZ,KAAKwJ,QAAQ0Q,sBAET,MADA1Q,SAAQ1I,OAAOkB,KAAK,4DACb,GAAI2V,iBAEf,IAAqBsD,qBAAsB,EACtBC,0BAA4B,EAC5BC,WACAC,mBAAoB,EACpBC,qBAAsB,EACtBra,eAAiB,EACjBL,UAAY8K,SAAS3E,MAAMvD,IAAI,SAAU2C,QAC1D,GAAqBmR,UAAWL,MAAMuD,cAAcrU,OAAQsD,SACvC8R,UAA+B,MAAnBjE,SAASjW,OAAiBiW,SAASjW,OAASsL,cAAc2K,SAASnR,QAC/E9E,OAAS,CAS9B,OARiB,OAAbka,YACAJ,4BACA9Z,OAASiW,SAASjW,OAASka,WAE/BD,oBAAsBA,qBAAuBja,OAAS,GAAKA,OAAS,EACpEga,kBAAoBA,mBAAqBha,OAASJ,eAClDA,eAAiBI,OACjB+Z,QAAQnZ,KAAKZ,QACNiW,UAEPgE,sBACA7R,QAAQ1I,OAAOkB,KAAK,+DAEpBoZ,mBACA5R,QAAQ1I,OAAOkB,KAAK,uDAExB,IAAqB5B,QAASqL,SAAS3E,MAAM1G,OACxBmb,gBAAkB,CACnCL,2BAA4B,GAAKA,0BAA4B9a,OAC7DoJ,QAAQ1I,OAAOkB,KAAK,yEAEc,GAA7BkZ,4BACLK,gBAAkBN,qBAAuB7a,OAAS,GAEtD,IAAqB4X,OAAQ5X,OAAS,EACjBwY,YAAcpP,QAAQoP,YACtBsB,sBAA0B1Q,QAA8B,sBACxDgS,gBAAkBtB,sBAAsB/U,QAS7D,OARAxE,WAAUO,QAAQ,SAAUC,GAAIqQ,GAC5B,GAAqBpQ,QAASma,gBAAkB,EAAK/J,GAAKwG,MAAQ,EAAKuD,gBAAkB/J,EAAM2J,QAAQ3J,GAClFiK,sBAAwBra,OAASoa,eACtDhS,SAAQoP,YAAcA,YAAcsB,sBAAsB7U,MAAQoW,sBAClEvB,sBAAsB/U,SAAWsW,sBACjCzE,MAAMwD,kBAAkBrZ,GAAIqI,SAC5BrI,GAAGC,OAASA,SAET,GAAIuW,cAAahX,YAO5B+K,2BAA2BvC,UAAUe,eAAiB,SAAUuB,SAAUjC,SACtE,GAAqBmQ,OAAQtQ,mBAAmBrJ,KAAM6G,wBAAwB4E,SAASmE,WAAYpG,SAC9EoE,IAAM,GAAIgK,cAAa+B,MAE5C,OADA/L,KAAI3G,QAAUoG,0BAA0B5B,SAASxE,SAC1C2G,KAOXlC,2BAA2BvC,UAAUgB,kBAAoB,SAAUsB,SAAUjC,SACzEA,QAAQ0N,UACR,IAAqBtJ,KAAM,GAAIiK,gBAE/B,OADAjK,KAAI3G,QAAUoG,0BAA0B5B,SAASxE,SAC1C2G,KAOXlC,2BAA2BvC,UAAUiB,gBAAkB,SAAUqB,SAAUjC,SACvE,GAAqBoG,WAAY5P,KAAKkK,eAAeuB,SAASmE,UAAWpG,SACpDoE,IAAM,GAAIkK,eAAclI,UAE7C,OADAhC,KAAI3G,QAAUoG,0BAA0B5B,SAASxE,SAC1C2G,KAOXlC,2BAA2BvC,UAAUkB,WAAa,SAAUoB,SAAUjC,SAClE,GAAqBkS,gBAAmBlS,QAA6B,qBAChDvC,QAAYwE,SAASxE,WAC1CuC,SAAQyN,aACRzN,QAAQmS,aAAelQ,QACvB,IAAImQ,IAAKhQ,kBAAkBH,SAASI,UAAWA,SAAW+P,GAAG,GAAI1D,YAAc0D,GAAG,EAClFpS,SAAQkP,qBACJgD,eAAetb,OAAUsb,eAAiB,IAAM7P,SAAYA,SAChEvI,gBAAgBkG,QAAQmP,gBAAiBnP,QAAQkP,wBACjD,IAAqBiB,OAAQtQ,mBAAmBrJ,KAAM6G,wBAAwB4E,SAASmE,WAAYpG,QACnGA,SAAQmS,aAAe,KACvBnS,QAAQkP,qBAAuBgD,cAC/B,IAAqB9N,KAAM,GAAImK,UAASlM,SAAU5E,QAAQ+Q,OAAS,KAAK/Q,QAAQgR,UAAUC,YAAayB,MAGvG,OAFA/L,KAAIiO,iBAAmBpQ,SAASI,SAChC+B,IAAI3G,QAAUoG,0BAA0B5B,SAASxE,SAC1C2G,KAOXlC,2BAA2BvC,UAAUmB,aAAe,SAAUmB,SAAUjC,SAC/DA,QAAQmS,cACTnS,QAAQ1I,OAAOkB,KAAK,+CAExB,IAAqB8C,SAA+B,SAArB2G,SAAS3G,SAClCK,SAAU,EAAGE,MAAO,EAAGC,OAAQ,QACjCT,cAAc4G,SAAS3G,QAAS0E,QAAQ1I,QAAQ,GAC/B8O,UAAYvG,mBAAmBrJ,KAAM6G,wBAAwB4E,SAASmE,WAAYpG,QACvG,OAAO,IAAI2O,YAAWrT,QAAS8K,YAE5BlE,8BAyBP8M,2BAA8B,WAI9B,QAASA,4BAA2B1X,QAChCd,KAAKc,OAASA,OACdd,KAAKiX,WAAa,EAClBjX,KAAKkX,SAAW,EAChBlX,KAAK8b,kBAAoB,KACzB9b,KAAK2b,aAAe,KACpB3b,KAAK0Y,qBAAuB,KAC5B1Y,KAAKka,sBAAwB,KAC7Bla,KAAK4Y,YAAc,EACnB5Y,KAAK2Y,mBACL3Y,KAAKiH,QAAU,KAEnB,MAAOuR,+BA8GPuD,sBAAyB,WACzB,QAASA,yBACL/b,KAAKgc,KAAO,GAAIrY,KAqCpB,MA/BAoY,uBAAsB5S,UAAU8S,QAAU,SAAUvb,SAChD,GAAqBwb,cAAelc,KAAKgc,KAAKpY,IAAIlD,QAOlD,OANIwb,cACAlc,KAAKgc,KAAKzL,OAAO7P,SAGjBwb,gBAEGA,cAOXH,sBAAsB5S,UAAUgT,OAAS,SAAUzb,QAASwb,cACxD,GAAqBE,sBAAuBpc,KAAKgc,KAAKpY,IAAIlD,QACrD0b,uBACDpc,KAAKgc,KAAKnY,IAAInD,QAAS0b,yBAE3BA,qBAAqBpa,KAAK0S,MAAM0H,qBAAsBF,eAM1DH,sBAAsB5S,UAAU4I,IAAM,SAAUrR,SAAW,MAAOV,MAAKgc,KAAKjK,IAAIrR,UAIhFqb,sBAAsB5S,UAAUkT,MAAQ,WAAcrc,KAAKgc,KAAKK,SACzDN,yBAcPO,0BAA4B,EAkB5BtO,gCAAmC,WACnC,QAASA,oCA6VT,MAhVAA,iCAAgC7E,UAAU8E,eAAiB,SAAUzN,OAAQmN,YAAaC,IAAKC,eAAgBC,YAAa7G,QAAS8G,gBAAiBjN,QACnI,SAAXA,SAAqBA,WACzBiN,gBAAkBA,iBAAmB,GAAIgO,sBACzC,IAAqBvS,SAAU,GAAI+S,0BAAyB/b,OAAQmN,YAAaI,gBAAiBjN,UAClG0I,SAAQvC,QAAUA,QAClBuC,QAAQgT,gBAAgBhW,WAAWqH,gBAAiB,KAAMrE,QAAQ1I,OAAQmG,SAC1E2G,IAAIuJ,MAAMnX,KAAMwJ,QAEhB,IAAqBuF,WAAYvF,QAAQuF,UAAU0N,OAAO,SAAUC,UAAY,MAAOA,UAASC,qBAChG,IAAI5N,UAAU3O,QAAUmB,OAAOC,KAAKsM,aAAa1N,OAAQ,CACrD,GAAqBwc,IAAK7N,UAAUA,UAAU3O,OAAS,EAClDwc,IAAGC,2BACJD,GAAGpW,WAAWsH,aAAc,KAAMtE,QAAQ1I,OAAQmG,SAG1D,MAAO8H,WAAU3O,OAAS2O,UAAUxL,IAAI,SAAUmZ,UAAY,MAAOA,UAASzO,oBACzEX,0BAA0BK,qBAAyB,EAAG,EAAG,IAAI,KAOtEK,gCAAgC7E,UAAUO,aAAe,SAAUkE,IAAKpE,WAQxEwE,gCAAgC7E,UAAUQ,WAAa,SAAUiE,IAAKpE,WAQtEwE,gCAAgC7E,UAAUS,gBAAkB,SAAUgE,IAAKpE,WAQ3EwE,gCAAgC7E,UAAUgB,kBAAoB,SAAUyD,IAAKpE,SACzE,GAAqBsT,qBAAsBtT,QAAQuE,gBAAgBkO,QAAQzS,QAAQ9I,QACnF,IAAIoc,oBAAqB,CACrB,GAAqBC,cAAevT,QAAQwT,iBAAiBpP,IAAI3G,SAC5C4T,UAAYrR,QAAQgT,gBAAgB5D,YACpCgC,QAAU5a,KAAKid,sBAAsBH,oBAAqBC,aAAgCA,aAAoB,QAC/HlC,YAAaD,SAGbpR,QAAQ0T,yBAAyBtC,SAGzCpR,QAAQ2T,aAAevP,KAO3BI,gCAAgC7E,UAAUiB,gBAAkB,SAAUwD,IAAKpE,SACvE,GAAqBuT,cAAevT,QAAQwT,iBAAiBpP,IAAI3G,QACjE8V,cAAaG,2BACbld,KAAKkK,eAAe0D,IAAIgC,UAAWmN,cACnCvT,QAAQ0T,yBAAyBH,aAAaP,gBAAgB5D,aAC9DpP,QAAQ2T,aAAevP,KAQ3BI,gCAAgC7E,UAAU8T,sBAAwB,SAAUf,aAAc1S,QAASvC,SAC/F,GAAqB4T,WAAYrR,QAAQgT,gBAAgB5D,YACpCiB,aAAegB,UAGf1V,SAA+B,MAApB8B,QAAQ9B,SAAmBb,mBAAmB2C,QAAQ9B,UAAY,KAC7EE,MAAyB,MAAjB4B,QAAQ5B,MAAgBf,mBAAmB2C,QAAQ5B,OAAS,IAQzF,OAPiB,KAAbF,UACA+W,aAAahb,QAAQ,SAAUkc,aAC3B,GAAqBC,oBAAqB7T,QAAQ8T,4BAA4BF,YAAajY,SAAUE,MACrGwU,cACIrU,KAAKwU,IAAIH,aAAcwD,mBAAmBlY,SAAWkY,mBAAmBhY,SAG7EwU,cAOX7L,gCAAgC7E,UAAUe,eAAiB,SAAU0D,IAAKpE,SACtEA,QAAQ+T,cAAc3P,IAAI3G,SAAS,GACnC2G,IAAIgC,UAAUuH,MAAMnX,KAAMwJ,SAC1BA,QAAQ2T,aAAevP,KAO3BI,gCAAgC7E,UAAUU,cAAgB,SAAU+D,IAAKpE,SACrE,GAAIwN,OAAQhX,KACSwd,gBAAkBhU,QAAQgU,gBAC1BC,IAAMjU,QACNvC,QAAU2G,IAAI3G,OACnC,IAAIA,UAAYA,QAAQC,QAAUD,QAAQ5B,SACtCoY,IAAMjU,QAAQwT,iBAAiB/V,SAC/BwW,IAAIP,2BACiB,MAAjBjW,QAAQ5B,OAAe,CACnBoY,IAAIN,uBAAwB3F,YAC5BiG,IAAIjB,gBAAgBkB,wBACpBD,IAAIN,aAAeQ,2BAEvB,IAAqBtY,OAAQf,mBAAmB2C,QAAQ5B,MACxDoY,KAAIG,cAAcvY,OAGtBuI,IAAI9G,MAAM1G,SACVwN,IAAI9G,MAAM5F,QAAQ,SAAUmV,GAAK,MAAOA,GAAEc,MAAMH,MAAOyG,OAEvDA,IAAIjB,gBAAgBqB,wBAIhBJ,IAAID,gBAAkBA,iBACtBC,IAAIP,4BAGZ1T,QAAQ2T,aAAevP,KAO3BI,gCAAgC7E,UAAUW,WAAa,SAAU8D,IAAKpE,SAClE,GAAIwN,OAAQhX,KACS8d,kBACAjE,aAAerQ,QAAQgT,gBAAgB5D,YACvCvT,MAAQuI,IAAI3G,SAAW2G,IAAI3G,QAAQ5B,MAAQf,mBAAmBsJ,IAAI3G,QAAQ5B,OAAS,CACxGuI,KAAI9G,MAAM5F,QAAQ,SAAUmV,GACxB,GAAqB0G,cAAevT,QAAQwT,iBAAiBpP,IAAI3G,QAC7D5B,QACA0X,aAAaa,cAAcvY,OAE/BgR,EAAEc,MAAMH,MAAO+F,cACflD,aAAerU,KAAKwU,IAAIH,aAAckD,aAAaP,gBAAgB5D,aACnEkF,eAAe9b,KAAK+a,aAAaP,mBAKrCsB,eAAe5c,QAAQ,SAAUwb,UAAY,MAAOlT,SAAQgT,gBAAgBuB,6BAA6BrB,YACzGlT,QAAQ0T,yBAAyBrD,cACjCrQ,QAAQ2T,aAAevP,KAO3BI,gCAAgC7E,UAAUiP,YAAc,SAAUxK,IAAKpE,SACnE,GAAIoE,cAAeR,kBAAkB,CACjC,GAAqBL,UAAWvD,QAAQtC,OACpCQ,kBAAkBkG,IAAIlK,MAAO8F,QAAQtC,OAAQsC,QAAQ1I,QACrD8M,IAAIlK,MAAM4D,UACd,OAAOzC,eAAckI,SAAUvD,QAAQ1I,QAGvC,OAASqE,SAAUyI,IAAIzI,SAAUE,MAAOuI,IAAIvI,MAAOC,OAAQsI,IAAItI,SAQvE0I,gCAAgC7E,UAAUY,aAAe,SAAU6D,IAAKpE,SACpE,GAAqB1E,SAAU0E,QAAQ0Q,sBAAwBla,KAAKoY,YAAYxK,IAAI9I,QAAS0E,SACxEkT,SAAWlT,QAAQgT,eACpC1X,SAAQO,QACRmE,QAAQwU,cAAclZ,QAAQO,OAC9BqX,SAASgB,wBAEb,IAAqBrG,UAAWzJ,IAAIjH,KAChC0Q,oBAAoBM,cACpB3X,KAAKgK,eAAeqN,SAAU7N,UAG9BA,QAAQwU,cAAclZ,QAAQK,UAC9BnF,KAAKiK,WAA4B,SAAYT,SAC7CkT,SAASmB,yBAEbrU,QAAQ0Q,sBAAwB,KAChC1Q,QAAQ2T,aAAevP,KAO3BI,gCAAgC7E,UAAUc,WAAa,SAAU2D,IAAKpE,SAClE,GAAqBkT,UAAWlT,QAAQgT,gBACnB1X,QAAY0E,QAA8B,uBAG1D1E,SAAW4X,SAASuB,4BAA4B7d,QACjDsc,SAASwB,cAEb,IAAqB5Y,QAAUR,SAAWA,QAAQQ,QAAWsI,IAAItI,MAC7DsI,KAAI6J,YACJiF,SAASyB,eAAe7Y,QAGxBoX,SAASlW,UAAUoH,IAAI1H,OAAQZ,OAAQkE,QAAQ1I,OAAQ0I,QAAQvC,SAEnEuC,QAAQ2T,aAAevP,KAO3BI,gCAAgC7E,UAAUa,eAAiB,SAAU4D,IAAKpE,SACtE,GAAqB0Q,uBAA0B1Q,QAA8B,sBACxDqR,UAAerR,QAAyB,gBAAErE,SAC1CA,SAAW+U,sBAAsB/U,SACjC4X,aAAevT,QAAQwT,mBACvBoB,cAAgBrB,aAAaP,eAClD4B,eAAc9Y,OAAS4U,sBAAsB5U,OAC7CsI,IAAI1H,OAAOhF,QAAQ,SAAU4Y,MACzB,GAAqB1Y,QAAS0Y,KAAK1Y,QAAU,CAC7Cgd,eAAcC,YAAYjd,OAAS+D,UACnCiZ,cAAc5X,UAAUsT,KAAK5T,OAAQ4T,KAAKxU,OAAQkE,QAAQ1I,OAAQ0I,QAAQvC,SAC1EmX,cAAcP,0BAIlBrU,QAAQgT,gBAAgBuB,6BAA6BK,eAGrD5U,QAAQ0T,yBAAyBrC,UAAY1V,UAC7CqE,QAAQ2T,aAAevP,KAO3BI,gCAAgC7E,UAAUkB,WAAa,SAAUuD,IAAKpE,SAClE,GAAIwN,OAAQhX,KAGS6a,UAAYrR,QAAQgT,gBAAgB5D,YACpC3R,QAAY2G,IAAI3G,YAChB5B,MAAQ4B,QAAQ5B,MAAQf,mBAAmB2C,QAAQ5B,OAAS,CAC7EA,SAAUmE,QAAQ2T,uBAAwB3F,WAC5B,GAAbqD,WAAkBrR,QAAQgT,gBAAgByB,4BAA4B7d,UACvEoJ,QAAQgT,gBAAgBkB,wBACxBlU,QAAQ2T,aAAeQ,2BAE3B,IAAqB9D,cAAegB,UACfyD,KAAO9U,QAAQyL,YAAYrH,IAAI/B,SAAU+B,IAAIiO,iBAAkBjO,IAAIoK,MAAOpK,IAAIsK,cAAajR,QAAQgR,SAAyBzO,QAAQ1I,OACzJ0I,SAAQ+U,kBAAoBD,KAAKle,MACjC,IAAqBoe,qBAAsB,IAC3CF,MAAKpd,QAAQ,SAAUR,QAAS8Q,GAC5BhI,QAAQiV,kBAAoBjN,CAC5B,IAAqBuL,cAAevT,QAAQwT,iBAAiBpP,IAAI3G,QAASvG,QACtE2E,QACA0X,aAAaa,cAAcvY,OAE3B3E,UAAY8I,QAAQ9I,UACpB8d,oBAAsBzB,aAAaP,iBAEvC5O,IAAIgC,UAAUuH,MAAMH,MAAO+F,cAI3BA,aAAaP,gBAAgBqB,uBAC7B,IAAqBjD,SAAUmC,aAAaP,gBAAgB5D,WAC5DiB,cAAerU,KAAKwU,IAAIH,aAAce,WAE1CpR,QAAQiV,kBAAoB,EAC5BjV,QAAQ+U,kBAAoB,EAC5B/U,QAAQ0T,yBAAyBrD,cAC7B2E,sBACAhV,QAAQgT,gBAAgBuB,6BAA6BS,qBACrDhV,QAAQgT,gBAAgBkB,yBAE5BlU,QAAQ2T,aAAevP,KAO3BI,gCAAgC7E,UAAUmB,aAAe,SAAUsD,IAAKpE,SACpE,GAAqBkV,eAAkBlV,QAAsB,cACxCoT,GAAKpT,QAAQgT,gBACb1X,QAAU8I,IAAI9I,QACdK,SAAWK,KAAKmZ,IAAI7Z,QAAQK,UAC5ByZ,QAAUzZ,UAAYqE,QAAQ+U,kBAAoB,GAClDlZ,MAAQF,SAAWqE,QAAQiV,kBAC3BI,mBAAqB/Z,QAAQK,SAAW,EAAI,UAAYL,QAAQQ,MACrF,QAAQuZ,oBACJ,IAAK,UACDxZ,MAAQuZ,QAAUvZ,KAClB,MACJ,KAAK,OACDA,MAAQqZ,cAAcI,mBAG9B,GAAqBpC,UAAWlT,QAAQgT,eACpCnX,QACAqX,SAASkB,cAAcvY,MAE3B,IAAqB0Z,cAAerC,SAAS9D,WAC7ChL,KAAIgC,UAAUuH,MAAMnX,KAAMwJ,SAC1BA,QAAQ2T,aAAevP,IAKvB8Q,cAAcI,mBACTlC,GAAGhE,YAAcmG,cAAiBnC,GAAG/B,UAAY6D,cAAclC,gBAAgB3B,YAEjF7M,mCAEP2P,8BACApB,yBAA4B,WAS5B,QAASA,0BAAyByC,QAASte,QAASqN,gBAAiBjN,OAAQiO,UAAWkQ,iBACpFjf,KAAKgf,QAAUA,QACfhf,KAAKU,QAAUA,QACfV,KAAK+N,gBAAkBA,gBACvB/N,KAAKc,OAASA,OACdd,KAAK+O,UAAYA,UACjB/O,KAAK0e,cAAgB,KACrB1e,KAAKka,sBAAwB,KAC7Bla,KAAKmd,aAAeQ,2BACpB3d,KAAKwd,gBAAkB,EACvBxd,KAAKiH,WACLjH,KAAKye,kBAAoB,EACzBze,KAAKue,kBAAoB,EACzBve,KAAK8e,mBAAqB,EAC1B9e,KAAKwc,gBAAkByC,iBAAmB,GAAIC,iBAAgBxe,QAAS,GACvEqO,UAAU/M,KAAKhC,KAAKwc,iBA6IxB,MA3IAjb,QAAOmV,eAAe6F,yBAAyBpT,UAAW,UAItDvF,IAAK,WAAc,MAAO5D,MAAKiH,QAAQC,QACvCyP,YAAY,EACZC,cAAc,IAOlB2F,yBAAyBpT,UAAUoU,cAAgB,SAAUtW,QAASkY,cAClE,GAAInI,OAAQhX,IACZ,IAAKiH,QAAL,CAEA,GAAqBmY,YAAa,QACbC,gBAAkBrf,KAAKiH,OAEjB,OAAvBmY,WAAWja,WACX,gBAAoBA,SAAWb,mBAAmB8a,WAAWja,WAEzC,MAApBia,WAAW/Z,QACXga,gBAAgBha,MAAQf,mBAAmB8a,WAAW/Z,OAE1D,IAAqBia,WAAYF,WAAWlY,MAC5C,IAAIoY,UAAW,CACX,GAAqBC,kBAAqBF,gBAAuB,MAC5DE,oBACDA,iBAAmBvf,KAAKiH,QAAQC,WAEpC3F,OAAOC,KAAK8d,WAAWpe,QAAQ,SAAUqO,MAChC4P,cAAiBI,iBAAiBva,eAAeuK,QAClDgQ,iBAAiBhQ,MAAQ7H,kBAAkB4X,UAAU/P,MAAOgQ,iBAAkBvI,MAAMlW,cAQpGyb,yBAAyBpT,UAAUqW,aAAe,WAC9C,GAAqBvY,WACrB,IAAIjH,KAAKiH,QAAS,CACd,GAAqBwY,aAAczf,KAAKiH,QAAQC,MAChD,IAAIuY,YAAa,CACb,GAAqBrG,UAAWnS,QAAgB,SAChD1F,QAAOC,KAAKxB,KAAKiH,QAAQC,QAAQhG,QAAQ,SAAUqO,MAAQ6J,SAAS7J,MAAQkQ,YAAYlQ,SAGhG,MAAOtI,UAQXsV,yBAAyBpT,UAAU6T,iBAAmB,SAAU/V,QAASvG,QAASgf,SAC9D,SAAZzY,UAAsBA,QAAU,KACpC,IAAqB0Y,QAASjf,SAAWV,KAAKU,QACzB8I,QAAU,GAAI+S,0BAAyBvc,KAAKgf,QAASW,OAAQ3f,KAAK+N,gBAAiB/N,KAAKc,OAAQd,KAAK+O,UAAW/O,KAAKwc,gBAAgBoD,KAAKD,OAAQD,SAAW,GASlL,OARAlW,SAAQ2T,aAAend,KAAKmd,aAC5B3T,QAAQ0Q,sBAAwBla,KAAKka,sBACrC1Q,QAAQvC,QAAUjH,KAAKwf,eACvBhW,QAAQ+T,cAActW,SACtBuC,QAAQiV,kBAAoBze,KAAKye,kBACjCjV,QAAQ+U,kBAAoBve,KAAKue,kBACjC/U,QAAQkV,cAAgB1e,KACxBA,KAAKwd,kBACEhU,SAMX+S,yBAAyBpT,UAAU+T,yBAA2B,SAAUwC,SAIpE,MAHA1f,MAAKmd,aAAeQ,2BACpB3d,KAAKwc,gBAAkBxc,KAAKwc,gBAAgBoD,KAAK5f,KAAKU,QAASgf,SAC/D1f,KAAK+O,UAAU/M,KAAKhC,KAAKwc,iBAClBxc,KAAKwc,iBAQhBD,yBAAyBpT,UAAUmU,4BAA8B,SAAUF,YAAajY,SAAUE,OAC9F,GAAqBwa,iBACjB1a,SAAsB,MAAZA,SAAmBA,SAAWiY,YAAYjY,SACpDE,MAAOrF,KAAKwc,gBAAgB5D,aAAwB,MAATvT,MAAgBA,MAAQ,GAAK+X,YAAY/X,MACpFC,OAAQ,IAESwa,QAAU,GAAIC,oBAAmB3C,YAAY1c,QAAS0c,YAAYzc,UAAWyc,YAAY7P,cAAe6P,YAAY5P,eAAgBqS,eAAgBzC,YAAY4C,wBAErL,OADAhgB,MAAK+O,UAAU/M,KAAK8d,SACbD,gBAMXtD,yBAAyBpT,UAAU6U,cAAgB,SAAUiC,MACzDjgB,KAAKwc,gBAAgB6B,YAAYre,KAAKwc,gBAAgBrX,SAAW8a,OAMrE1D,yBAAyBpT,UAAUyU,cAAgB,SAAUvY,OAErDA,MAAQ,GACRrF,KAAKwc,gBAAgBoB,cAAcvY,QAY3CkX,yBAAyBpT,UAAU8L,YAAc,SAAUpJ,SAAUgQ,iBAAkB7D,MAAOE,YAAaD,SAAUnX,QACjH,GAAqB6T,WAIrB,IAHIuD,aACAvD,QAAQ3S,KAAKhC,KAAKU,SAElBmL,SAASzL,OAAS,EAAG,CACrB,GAAqB8T,OAAiB,GAAT8D,KAC7BrD,SAAQ3S,KAAK0S,MAAMC,QAAS3U,KAAKgf,QAAQ7J,MAAMnV,KAAKU,QAASmL,SAAUqI,QAK3E,MAHK+D,WAA8B,GAAlBtD,QAAQvU,QACrBU,OAAOkB,KAAK,WAAc6Z,iBAAmB,4CAAgDA,iBAAmB,uDAE7GlH,SAEJ4H,4BAEP2C,gBAAmB,WAMnB,QAASA,iBAAgBxe,QAASma,UAAWqF,8BACzClgB,KAAKU,QAAUA,QACfV,KAAK6a,UAAYA,UACjB7a,KAAKkgB,6BAA+BA,6BACpClgB,KAAKmF,SAAW,EAChBnF,KAAKmgB,qBACLngB,KAAKogB,oBACLpgB,KAAKqgB,WAAa,GAAI1c,KACtB3D,KAAKsgB,iBACLtgB,KAAKugB,kBACLvgB,KAAKwgB,aACLxgB,KAAKygB,0BAA4B,KAC5BzgB,KAAKkgB,+BACNlgB,KAAKkgB,6BAA+B,GAAIvc,MAE5C3D,KAAK0gB,qBAAuBnf,OAAO6H,OAAOpJ,KAAKwgB,cAC/CxgB,KAAK2gB,sBAA0B3gB,KAAKkgB,6BAA6Btc,IAAIlD,SAChEV,KAAK2gB,wBACN3gB,KAAK2gB,sBAAwB3gB,KAAK0gB,qBAClC1gB,KAAKkgB,6BAA6Brc,IAAInD,QAASV,KAAK0gB,uBAExD1gB,KAAK4gB,gBAsPT,MAjPA1B,iBAAgB/V,UAAUwT,kBAAoB,WAC1C,OAAQ3c,KAAKqgB,WAAW9G,MACpB,IAAK,GACD,OAAO,CACX,KAAK,GACD,MAAOvZ,MAAKie,4BAA4B7d,OAAS,CACrD,SACI,OAAO,IAMnB8e,gBAAgB/V,UAAU8U,0BAA4B,WAAc,MAAO1c,QAAOC,KAAKxB,KAAKogB,mBAC5F7e,OAAOmV,eAAewI,gBAAgB/V,UAAW,eAI7CvF,IAAK,WAAc,MAAO5D,MAAK6a,UAAY7a,KAAKmF,UAChDwR,YAAY,EACZC,cAAc,IAMlBsI,gBAAgB/V,UAAUyU,cAAgB,SAAUvY,OAKhD,GAAqBwb,iBAA0C,GAAxB7gB,KAAKqgB,WAAW9G,MAAahY,OAAOC,KAAKxB,KAAKugB,gBAAgBngB,MACjGJ,MAAKmF,UAAY0b,iBACjB7gB,KAAKqe,YAAYre,KAAK4Y,YAAcvT,OAChCwb,iBACA7gB,KAAK0d,yBAIT1d,KAAK6a,WAAaxV,OAQ1B6Z,gBAAgB/V,UAAUyW,KAAO,SAAUlf,QAASkY,aAEhD,MADA5Y,MAAK6d,wBACE,GAAIqB,iBAAgBxe,QAASkY,aAAe5Y,KAAK4Y,YAAa5Y,KAAKkgB,+BAK9EhB,gBAAgB/V,UAAUyX,cAAgB,WAClC5gB,KAAKogB,mBACLpgB,KAAKmgB,kBAAoBngB,KAAKogB,kBAElCpgB,KAAKogB,iBAAqBpgB,KAAKqgB,WAAWzc,IAAI5D,KAAKmF,UAC9CnF,KAAKogB,mBACNpgB,KAAKogB,iBAAmB7e,OAAO6H,OAAOpJ,KAAKwgB,cAC3CxgB,KAAKqgB,WAAWxc,IAAI7D,KAAKmF,SAAUnF,KAAKogB,oBAMhDlB,gBAAgB/V,UAAU+U,aAAe,WACrCle,KAAKmF,UAAYmX,0BACjBtc,KAAK4gB,iBAMT1B,gBAAgB/V,UAAUkV,YAAc,SAAU4B,MAC9CjgB,KAAK6d,wBACL7d,KAAKmF,SAAW8a,KAChBjgB,KAAK4gB,iBAOT1B,gBAAgB/V,UAAU2X,aAAe,SAAUrf,KAAMiC,OACrD1D,KAAK0gB,qBAAqBjf,MAAQiC,MAClC1D,KAAK2gB,sBAAsBlf,MAAQiC,MACnC1D,KAAKsgB,cAAc7e,OAAUwe,KAAMjgB,KAAK4Y,YAAalV,MAAOA,QAKhEwb,gBAAgB/V,UAAU0T,wBAA0B,WAAc,MAAO7c,MAAKygB,4BAA8BzgB,KAAKogB;EAKjHlB,gBAAgB/V,UAAUgV,eAAiB,SAAU7Y,QACjD,GAAI0R,OAAQhX,IACRsF,UACAtF,KAAKmgB,kBAA0B,OAAI7a,QAQvC/D,OAAOC,KAAKxB,KAAK2gB,uBAAuBzf,QAAQ,SAAUO,MACtDuV,MAAMwJ,UAAU/e,MAAQuV,MAAM2J,sBAAsBlf,OAASxB,oBAAoB6B,WACjFkV,MAAMoJ,iBAAiB3e,MAAQxB,oBAAoB6B,aAEvD9B,KAAKygB,0BAA4BzgB,KAAKogB,kBAS1ClB,gBAAgB/V,UAAU3C,UAAY,SAAU8B,MAAOhD,OAAQxE,OAAQmG,SACnE,GAAI+P,OAAQhX,IACRsF,UACAtF,KAAKmgB,kBAA0B,OAAI7a,OAEvC,IAAqB4B,QAAUD,SAAWA,QAAQC,WAC7BhB,OAASqI,cAAcjG,MAAOtI,KAAK2gB,sBACxDpf,QAAOC,KAAK0E,QAAQhF,QAAQ,SAAUO,MAClC,GAAqB4F,KAAMK,kBAAkBxB,OAAOzE,MAAOyF,OAAQpG,OACnEkW,OAAMuJ,eAAe9e,MAAQ4F,IACxB2P,MAAM0J,qBAAqB1b,eAAevD,QAC3CuV,MAAMwJ,UAAU/e,MAAQuV,MAAM2J,sBAAsB3b,eAAevD,MAC/DuV,MAAM2J,sBAAsBlf,MAC5BxB,oBAAoB6B,YAE5BkV,MAAM8J,aAAarf,KAAM4F,QAMjC6X,gBAAgB/V,UAAU0U,sBAAwB,WAC9C,GAAI7G,OAAQhX,KACSkG,OAASlG,KAAKugB,eACdnP,MAAQ7P,OAAOC,KAAK0E,OACrB,IAAhBkL,MAAMhR,SAEVJ,KAAKugB,kBACLnP,MAAMlQ,QAAQ,SAAUO,MACpB,GAAqB4F,KAAMnB,OAAOzE,KAClCuV,OAAMoJ,iBAAiB3e,MAAQ4F,MAEnC9F,OAAOC,KAAKxB,KAAK0gB,sBAAsBxf,QAAQ,SAAUO,MAChDuV,MAAMoJ,iBAAiBpb,eAAevD,QACvCuV,MAAMoJ,iBAAiB3e,MAAQuV,MAAM0J,qBAAqBjf,WAOtEyd,gBAAgB/V,UAAUuU,sBAAwB,WAC9C,GAAI1G,OAAQhX,IACZuB,QAAOC,KAAKxB,KAAK0gB,sBAAsBxf,QAAQ,SAAUO,MACrD,GAAqB4F,KAAM2P,MAAM0J,qBAAqBjf,KACtDuV,OAAMuJ,eAAe9e,MAAQ4F,IAC7B2P,MAAM8J,aAAarf,KAAM4F,QAMjC6X,gBAAgB/V,UAAU4X,iBAAmB,WAAc,MAAO/gB,MAAKqgB,WAAWzc,IAAI5D,KAAKmF,WAC3F5D,OAAOmV,eAAewI,gBAAgB/V,UAAW,cAI7CvF,IAAK,WACD,GAAqBod,cACrB,KAAK,GAAqBvf,QAAQzB,MAAKogB,iBACnCY,WAAWhf,KAAKP,KAEpB,OAAOuf,aAEXrK,YAAY,EACZC,cAAc,IAMlBsI,gBAAgB/V,UAAU4U,6BAA+B,SAAUrB,UAC/D,GAAI1F,OAAQhX,IACZuB,QAAOC,KAAKkb,SAAS4D,eAAepf,QAAQ,SAAUO,MAClD,GAAqBwf,UAAWjK,MAAMsJ,cAAc7e,MAC/Byf,SAAWxE,SAAS4D,cAAc7e,QAClDwf,UAAYC,SAASjB,KAAOgB,SAAShB,OACtCjJ,MAAM8J,aAAarf,KAAMyf,SAASxd,UAO9Cwb,gBAAgB/V,UAAU8E,eAAiB,WACvC,GAAI+I,OAAQhX,IACZA,MAAK6d,uBACL,IAAqBtQ,eAAgB,GAAIsE,KACpBrE,eAAiB,GAAIqE,KACrBwI,QAAmC,IAAzBra,KAAKqgB,WAAW9G,MAAgC,IAAlBvZ,KAAKmF,SAC7Cgc,iBACrBnhB,MAAKqgB,WAAWnf,QAAQ,SAAUkgB,SAAUnB,MACxC,GAAqBoB,eAAgB/a,WAAW8a,UAAU,EAC1D7f,QAAOC,KAAK6f,eAAengB,QAAQ,SAAUO,MACzC,GAAqBiC,OAAQ2d,cAAc5f,KACvCiC,QAASzD,oBAAoB4B,WAC7B0L,cAAc0E,IAAIxQ,MAEbiC,OAASzD,oBAAoB6B,YAClC0L,eAAeyE,IAAIxQ,QAGtB4Y,UACDgH,cAAsB,OAAIpB,KAAOjJ,MAAM7R,UAE3Cgc,eAAenf,KAAKqf,gBAExB,IAAqBC,UAAW/T,cAAcgM,KAAOvR,gBAAgBuF,cAAckM,aAC9D8H,UAAY/T,eAAe+L,KAAOvR,gBAAgBwF,eAAeiM,YAEtF,IAAIY,QAAS,CACT,GAAqBmH,KAAML,eAAe,GACrBM,IAAM3b,QAAQ0b,IACnCA,KAAY,OAAI,EAChBC,IAAY,OAAI,EAChBN,gBAAkBK,IAAKC,KAE3B,MAAOnU,2BAA0BtN,KAAKU,QAASygB,eAAgBG,SAAUC,UAAWvhB,KAAKmF,SAAUnF,KAAK6a,UAAW7a,KAAKsF,QAAQ,IAE7H4Z,mBAEPa,mBAAsB,SAAUjJ,QAUhC,QAASiJ,oBAAmBrf,QAASC,UAAW4M,cAAeC,eAAgB1I,QAAS4c,0BACnD,SAA7BA,2BAAuCA,0BAA2B,EACtE,IAAI1K,OAAQF,OAAOP,KAAKvW,KAAMU,QAASoE,QAAQO,QAAUrF,IAOzD,OANAgX,OAAMtW,QAAUA,QAChBsW,MAAMrW,UAAYA,UAClBqW,MAAMzJ,cAAgBA,cACtByJ,MAAMxJ,eAAiBA,eACvBwJ,MAAM0K,yBAA2BA,yBACjC1K,MAAMlS,SAAYK,SAAUL,QAAQK,SAAUE,MAAOP,QAAQO,MAAOC,OAAQR,QAAQQ,QAC7E0R,MAsDX,MAxEAnO,WAAUkX,mBAAoBjJ,QAuB9BiJ,mBAAmB5W,UAAUwT,kBAAoB,WAAc,MAAO3c,MAAKW,UAAUP,OAAS,GAI9F2f,mBAAmB5W,UAAU8E,eAAiB,WAC1C,GAAqBtN,WAAYX,KAAKW,UAClCib,GAAK5b,KAAK8E,QAASO,MAAQuW,GAAGvW,MAAOF,SAAWyW,GAAGzW,SAAUG,OAASsW,GAAGtW,MAC7E,IAAItF,KAAK0hB,0BAA4Brc,MAAO,CACxC,GAAqBsc,iBACAhf,UAAYwC,SAAWE,MACvBuc,YAAcvc,MAAQ1C,UAEtBkf,iBAAmBvb,WAAW3F,UAAU,IAAI,EACjEkhB,kBAAyB,OAAI,EAC7BF,aAAa3f,KAAK6f,iBAClB,IAAqBC,kBAAmBxb,WAAW3F,UAAU,IAAI,EACjEmhB,kBAAyB,OAAI5T,YAAY0T,aACzCD,aAAa3f,KAAK8f,iBAiBlB,KAAK,GADgB9J,OAAQrX,UAAUP,OAAS,EACtBoR,EAAI,EAAGA,GAAKwG,MAAOxG,IAAK,CAC9C,GAAqBrQ,IAAKmF,WAAW3F,UAAU6Q,IAAI,GAC9BuQ,UAAa5gB,GAAY,OACzB6gB,eAAiB3c,MAAQ0c,UAAY5c,QAC1DhE,IAAW,OAAI+M,YAAY8T,eAAiBrf,WAC5Cgf,aAAa3f,KAAKb,IAGtBgE,SAAWxC,UACX0C,MAAQ,EACRC,OAAS,GACT3E,UAAYghB,aAEhB,MAAOrU,2BAA0BtN,KAAKU,QAASC,UAAWX,KAAKuN,cAAevN,KAAKwN,eAAgBrI,SAAUE,MAAOC,QAAQ,IAEzHya,oBACTb,iBAmCE+C,UAAa,WAKb,QAASA,WAAUjD,QAAS1W,OACxBtI,KAAKgf,QAAUA,OACf,IAAqBle,WACA8M,IAAMpC,kBAAkBlD,MAAOxH,OACpD,IAAIA,OAAOV,OAAQ,CACf,GAAqB8hB,cAAe,iCAAmCphB,OAAOqB,KAAK,KACnF,MAAM,IAAID,OAAMggB,cAEpBliB,KAAKmiB,cAAgBvU,IAsBzB,MAZAqU,WAAU9Y,UAAUiZ,eAAiB,SAAU1hB,QAASmN,eAAgBwU,kBAAmBpb,QAAS8G,iBAChG,GAAqBuU,OAAQlc,MAAMC,QAAQwH,gBAAkB5H,gBAAgB4H,gBAAkB,eAC1E0U,KAAOnc,MAAMC,QAAQgc,mBAAqBpc,gBAAgBoc,mBAAqB,kBAC/EvhB,SACrBiN,iBAAkBA,iBAAmB,GAAIgO,sBACzC,IAAqBlR,QAAS6C,wBAAwB1N,KAAKgf,QAASte,QAASV,KAAKmiB,cAAeG,MAAOC,KAAMtb,QAAS8G,gBAAiBjN,OACxI,IAAIA,OAAOV,OAAQ,CACf,GAAqB8hB,cAAe,+BAAiCphB,OAAOqB,KAAK,KACjF,MAAM,IAAID,OAAMggB,cAEpB,MAAOrX,SAEJoX,aAWPO,yBAA4B,WAC5B,QAASA,6BAET,MAAOA,6BAKPC,6BAAgC,WAChC,QAASA,iCAkBT,MAXAA,8BAA6BtZ,UAAUvH,sBAAwB,SAAU8gB,aAAc5hB,QAAU,MAAO4hB,eAQxGD,6BAA6BtZ,UAAUpH,oBAAsB,SAAU4gB,qBAAsBC,mBAAoBlf,MAAO5C,QACpH,MAAO,QAEJ2hB,gCAcPI,6BAAgC,SAAU/L,QAE1C,QAAS+L,gCACL,MAAkB,QAAX/L,QAAmBA,OAAOpC,MAAM1U,KAAM0I,YAAc1I,KAiC/D,MAnCA6I,WAAUga,6BAA8B/L,QASxC+L,6BAA6B1Z,UAAUvH,sBAAwB,SAAU8gB,aAAc5hB,QACnF,MAAO4F,qBAAoBgc,eAS/BG,6BAA6B1Z,UAAUpH,oBAAsB,SAAU4gB,qBAAsBC,mBAAoBlf,MAAO5C,QACpH,GAAqB6D,MAAO,GACPme,OAASpf,MAAM4D,WAAWyb,MAC/C,IAAIC,qBAAqBJ,qBAAiC,IAAVlf,OAAyB,MAAVA,MAC3D,GAAqB,gBAAVA,OACPiB,KAAO,SAEN,CACD,GAAqBse,mBAAoBvf,MAAMc,MAAM,yBACjDye,oBAAoD,GAA/BA,kBAAkB,GAAG7iB,QAC1CU,OAAOkB,KAAK,uCAAyC2gB,qBAAuB,IAAMjf,OAI9F,MAAOof,QAASne,MAEbke,8BACTL,0BACEQ,qBAAuBtU,eAAe,iUACrChE,MAAM,MAwDPwY,gBACAlT,2BAA8B,WAM9B,QAASA,4BAA2BmT,aAAcvV,IAAKwV,cACnDpjB,KAAKmjB,aAAeA,aACpBnjB,KAAK4N,IAAMA,IACX5N,KAAKojB,aAAeA,aA6DxB,MAtDApT,4BAA2B7G,UAAU3E,MAAQ,SAAU2K,aAAcC,WACjE,MAAOH,2BAA0BjP,KAAK4N,IAAI+B,SAAUR,aAAcC,YAQtEY,2BAA2B7G,UAAUka,YAAc,SAAUC,UAAWpc,OAAQpG,QAC5E,GAAqByiB,mBAAoBvjB,KAAKojB,aAAa,KACtCI,YAAcxjB,KAAKojB,aAAaE,WAChCG,aAAeF,kBAAoBA,kBAAkBF,YAAYnc,OAAQpG,UAC9F,OAAO0iB,aAAcA,YAAYH,YAAYnc,OAAQpG,QAAU2iB,cAYnEzT,2BAA2B7G,UAAUwC,MAAQ,SAAUnL,OAAQE,QAASyO,aAAcC,UAAWsU,eAAgBC,YAAa5V,iBAC1H,GAAqBjN,WACA8iB,0BAA4B5jB,KAAK4N,IAAI3G,SAAWjH,KAAK4N,IAAI3G,QAAQC,QAAUgc,aAC3EW,uBAAyBH,gBAAkBA,eAAexc,QAAUgc,aACpEY,mBAAqB9jB,KAAKqjB,YAAYlU,aAAc0U,uBAAwB/iB,QAC5EijB,oBAAsBJ,aAAeA,YAAYzc,QAAUgc,aAC3Dc,gBAAkBhkB,KAAKqjB,YAAYjU,UAAW2U,oBAAqBjjB,QACnEkO,gBAAkB,GAAI6C,KACtBoS,YAAc,GAAItgB,KAClBugB,aAAe,GAAIvgB,KACnBwgB,UAA0B,SAAd/U,UACZgV,kBAAqBld,OAAQgP,YAAa0N,0BAA2BG,sBACrEhV,UAAYrB,wBAAwBlN,OAAQE,QAASV,KAAK4N,IAAIgC,UAAWkU,mBAAoBE,gBAAiBI,iBAAkBrW,gBAAiBjN,OACtK,IAAIA,OAAOV,OACP,MAAOuO,6BAA4BjO,QAASV,KAAKmjB,aAAchU,aAAcC,UAAW+U,UAAWL,mBAAoBE,sBAAyBC,YAAaC,aAAcpjB,OAE/KiO,WAAU7N,QAAQ,SAAU0b,IACxB,GAAqB/H,KAAM+H,GAAGlc,QACT4gB,SAAWhe,gBAAgB2gB,YAAapP,OAC7D+H,IAAGrP,cAAcrM,QAAQ,SAAUO,MAAQ,MAAO6f,UAAS7f,OAAQ,GACnE,IAAqB8f,WAAYje,gBAAgB4gB,aAAcrP,OAC/D+H,IAAGpP,eAAetM,QAAQ,SAAUO,MAAQ,MAAO8f,WAAU9f,OAAQ,IACjEoT,MAAQnU,SACRsO,gBAAgBiD,IAAI4C,MAG5B,IAAqBwP,qBAAsBrc,gBAAgBgH,gBAAgByK,SAC3E,OAAO9K,6BAA4BjO,QAASV,KAAKmjB,aAAchU,aAAcC,UAAW+U,UAAWL,mBAAoBE,gBAAiBjV,UAAWsV,oBAAqBJ,YAAaC,eAElLlU,8BAWPsU,qBAAwB,WAKxB,QAASA,sBAAqBpe,OAAQqe,eAClCvkB,KAAKkG,OAASA,OACdlG,KAAKukB,cAAgBA,cA8BzB,MAvBAD,sBAAqBnb,UAAUka,YAAc,SAAUnc,OAAQpG,QAC3D,GAAqBgN,gBACA0W,eAAiB1e,QAAQ9F,KAAKukB,cAmBnD,OAlBAhjB,QAAOC,KAAK0F,QAAQhG,QAAQ,SAAUsC,KAClC,GAAqBE,OAAQwD,OAAO1D,IACvB,OAATE,QACA8gB,eAAehhB,KAAOE,SAG9B1D,KAAKkG,OAAOA,OAAOhF,QAAQ,SAAUwC,OACjC,GAAqB,gBAAVA,OAAoB,CAC3B,GAAqB+gB,YAAa,KAClCljB,QAAOC,KAAKijB,YAAYvjB,QAAQ,SAAUO,MACtC,GAAqB4F,KAAMod,WAAWhjB,KAClC4F,KAAIjH,OAAS,IACbiH,IAAMK,kBAAkBL,IAAKmd,eAAgB1jB,SAEjDgN,YAAYrM,MAAQ4F,SAIzByG,aAEJwW,wBAmBP9U,iBAAoB,WAKpB,QAASA,kBAAiBD,KAAM3B,KAC5B,GAAIoJ,OAAQhX,IACZA,MAAKuP,KAAOA,KACZvP,KAAK4N,IAAMA,IACX5N,KAAK0kB,uBACL1kB,KAAK0P,UACL9B,IAAI8B,OAAOxO,QAAQ,SAAU0M,KACzB,GAAqB2W,eAAiB3W,IAAI3G,SAAW2G,IAAI3G,QAAQC,UACjE8P,OAAMtH,OAAO9B,IAAI2B,MAAQ,GAAI+U,sBAAqB1W,IAAIjH,MAAO4d,iBAEjEtU,kBAAkBjQ,KAAK0P,OAAQ,OAAQ,KACvCO,kBAAkBjQ,KAAK0P,OAAQ,QAAS,KACxC9B,IAAImJ,YAAY7V,QAAQ,SAAU0M,KAC9BoJ,MAAM0N,oBAAoB1iB,KAAK,GAAIgO,4BAA2BT,KAAM3B,IAAKoJ,MAAMtH,WAEnF1P,KAAK2kB,mBAAqBlV,yBAAyBF,KAAMvP,KAAK0P,QA4BlE,MA1BAnO,QAAOmV,eAAelH,iBAAiBrG,UAAW,mBAI9CvF,IAAK,WAAc,MAAO5D,MAAK4N,IAAIqJ,WAAa,GAChDN,YAAY,EACZC,cAAc,IAOlBpH,iBAAiBrG,UAAUyb,gBAAkB,SAAUzV,aAAcC,WACjE,GAAqBuK,OAAQ3Z,KAAK0kB,oBAAoB3Y,KAAK,SAAU8Y,GAAK,MAAOA,GAAErgB,MAAM2K,aAAcC,YACvG,OAAOuK,QAAS,MAQpBnK,iBAAiBrG,UAAU2b,YAAc,SAAU3V,aAAcjI,OAAQpG,QACrE,MAAOd,MAAK2kB,mBAAmBtB,YAAYlU,aAAcjI,OAAQpG,SAE9D0O,oBAyCPuV,sBAAwB,GAAIhJ,uBAC5BiJ,wBAA2B,WAK3B,QAASA,yBAAwBhG,QAASiG,aACtCjlB,KAAKgf,QAAUA,QACfhf,KAAKilB,YAAcA,YACnBjlB,KAAKklB,eACLllB,KAAKmlB,gBACLnlB,KAAKG,WAsJT,MA/IA6kB,yBAAwB7b,UAAUic,SAAW,SAAUlhB,GAAIuH,UACvD,GAAqB3K,WACA8M,IAAMpC,kBAAkBC,SAAU3K,OACvD,IAAIA,OAAOV,OACP,KAAM,IAAI8B,OAAM,8DAAgEpB,OAAOqB,KAAK,MAG5FnC,MAAKklB,YAAYhhB,IAAM0J,KAS/BoX,wBAAwB7b,UAAUkc,aAAe,SAAU7T,EAAG5Q,UAAWC,YACrE,GAAqBH,SAAU8Q,EAAE9Q,QACZC,UAAYJ,mBAAmBP,KAAKgf,QAAShf,KAAKilB,YAAavkB,QAAS8Q,EAAE7Q,UAAWC,UAAWC,WACrH,OAAOb,MAAKgf,QAAQ5J,QAAQ1U,QAASC,UAAW6Q,EAAErM,SAAUqM,EAAEnM,MAAOmM,EAAElM,YAQ3E0f,wBAAwB7b,UAAUC,OAAS,SAAUlF,GAAIxD,QAASuG,SAC9D,GAAI+P,OAAQhX,IACI,UAAZiH,UAAsBA,WAC1B,IAEqBiV,cAFApb,UACA8M,IAAM5N,KAAKklB,YAAYhhB,IAEvBohB,cAAgB,GAAI3hB,IAYzC,IAXIiK,KACAsO,aAAexO,wBAAwB1N,KAAKgf,QAASte,QAASkN,UAAa3G,QAAS8d,sBAAuBjkB,QAC3Gob,aAAahb,QAAQ,SAAUqkB,MAC3B,GAAqBrf,QAAS5C,gBAAgBgiB,cAAeC,KAAK7kB,WAClE6kB,MAAK/X,eAAetM,QAAQ,SAAUO,MAAQ,MAAOyE,QAAOzE,MAAQ,WAIxEX,OAAOkB,KAAK,uEACZka,iBAEApb,OAAOV,OACP,KAAM,IAAI8B,OAAM,+DAAiEpB,OAAOqB,KAAK,MAEjGmjB,eAAcpkB,QAAQ,SAAUgF,OAAQxF,SACpCa,OAAOC,KAAK0E,QAAQhF,QAAQ,SAAUO,MAAQyE,OAAOzE,MAAQuV,MAAMgI,QAAQ3N,aAAa3Q,QAASe,KAAMxB,oBAAoB6B,eAE/H,IAAqB3B,SAAU+b,aAAa3Y,IAAI,SAAUiO,GACtD,GAAqBtL,QAASof,cAAc1hB,IAAI4N,EAAE9Q,QAClD,OAAOsW,OAAMqO,aAAa7T,KAAOtL,UAEhB7D,OAASnC,oBAAoBC,QAIlD,OAHAH,MAAKmlB,aAAajhB,IAAM7B,OACxBA,OAAOQ,UAAU,WAAc,MAAOmU,OAAMwO,QAAQthB,MACpDlE,KAAKG,QAAQ6B,KAAKK,QACXA,QAMX2iB,wBAAwB7b,UAAUqc,QAAU,SAAUthB,IAClD,GAAqB7B,QAASrC,KAAKylB,WAAWvhB,GAC9C7B,QAAOmjB,gBACAxlB,MAAKmlB,aAAajhB,GACzB,IAAqBoM,OAAQtQ,KAAKG,QAAQ8D,QAAQ5B,OAC9CiO,QAAS,GACTtQ,KAAKG,QAAQ0F,OAAOyK,MAAO,IAOnC0U,wBAAwB7b,UAAUsc,WAAa,SAAUvhB,IACrD,GAAqB7B,QAASrC,KAAKmlB,aAAajhB,GAChD,KAAK7B,OACD,KAAM,IAAIH,OAAM,oDAAsDgC,GAE1E,OAAO7B,SASX2iB,wBAAwB7b,UAAUuc,OAAS,SAAUxhB,GAAIxD,QAAS4B,UAAWE,UAEzE,GAAqBmjB,WAAY3iB,mBAAmBtC,QAAS,GAAI,GAAI,GAErE,OADA0B,gBAAepC,KAAKylB,WAAWvhB,IAAK5B,UAAWqjB,UAAWnjB,UACnD,cASXwiB,wBAAwB7b,UAAUpF,QAAU,SAAUG,GAAIxD,QAASqD,QAAS6hB,MACxE,GAAe,YAAX7hB,QAEA,WADA/D,MAAKolB,SAASlhB,GAAsB0hB,KAAK,GAG7C,IAAe,UAAX7hB,QAAqB,CACrB,GAAqBkD,SAAY2e,KAAK,MAEtC,YADA5lB,MAAKoJ,OAAOlF,GAAIxD,QAASuG,SAG7B,GAAqB5E,QAASrC,KAAKylB,WAAWvhB,GAC9C,QAAQH,SACJ,IAAK,OACD1B,OAAOwjB,MACP,MACJ,KAAK,QACDxjB,OAAOyjB,OACP,MACJ,KAAK,QACDzjB,OAAO0jB,OACP,MACJ,KAAK,UACD1jB,OAAO2jB,SACP,MACJ,KAAK,SACD3jB,OAAO4jB,QACP,MACJ,KAAK,OACD5jB,OAAO6jB,MACP,MACJ,KAAK,cACD7jB,OAAO8jB,YAAYzhB,WAA6BkhB,KAAK,IACrD,MACJ,KAAK,UACD5lB,KAAKwlB,QAAQthB,MAIlB8gB,2BAcPoB,iBAAmB,oBACnBC,gBAAkB,qBAClBC,mBAAqB,sBACrBC,kBAAoB,uBACpBC,sBACAC,oBACAC,YAAa,GACbC,cAAe,KACfC,cAAc,EACdC,sBAAsB,GAEtBtV,4BACAmV,YAAa,GACbC,cAAe,KACfC,cAAc,EACdC,sBAAsB,GAMtBvV,aAAe,eAKfwV,WAAc,WAId,QAASA,YAAWxe,OAChB,GAAqBye,OAAQze,OAASA,MAAMtD,eAAe,SACtCtB,MAAQqjB,MAAQze,MAAa,MAAIA,KAEtD,IADAtI,KAAK0D,MAAQ8M,sBAAsB9M,OAC/BqjB,MAAO,CACP,GAAqB9f,SAAUnB,QAAyB,aACjDmB,SAAe,MACtBjH,KAAKiH,QAAU,YAGfjH,MAAKiH,UAEJjH,MAAKiH,QAAQC,SACdlH,KAAKiH,QAAQC,WA0BrB,MAvBA3F,QAAOmV,eAAeoQ,WAAW3d,UAAW,UAIxCvF,IAAK,WAAc,MAAQ5D,MAAKiH,QAAc,QAC9C0P,YAAY,EACZC,cAAc,IAMlBkQ,WAAW3d,UAAU6d,cAAgB,SAAU/f,SAC3C,GAAqBqY,WAAYrY,QAAQC,MACzC,IAAIoY,UAAW,CACX,GAAqBG,aAAgBzf,KAAKiH,QAAe,MACzD1F,QAAOC,KAAK8d,WAAWpe,QAAQ,SAAUO,MACZ,MAArBge,YAAYhe,QACZge,YAAYhe,MAAQ6d,UAAU7d,WAKvCqlB,cAEPG,WAAa,OACbC,oBAAsB,GAAIJ,YAAWG,YACrCE,oBAAsB,GAAIL,YAAW,WACrCM,6BAAgC,WAMhC,QAASA,8BAA6BljB,GAAImjB,YAAaC,SACnDtnB,KAAKkE,GAAKA,GACVlE,KAAKqnB,YAAcA,YACnBrnB,KAAKsnB,QAAUA,QACftnB,KAAKG,WACLH,KAAKunB,aACLvnB,KAAKwnB,UACLxnB,KAAKynB,kBAAoB,GAAI9jB,KAC7B3D,KAAK0nB,eAAiB,UAAYxjB,GAClCsO,SAAS6U,YAAarnB,KAAK0nB,gBAgY/B,MAvXAN,8BAA6Bje,UAAUuc,OAAS,SAAUhlB,QAAS6O,KAAMoY,MAAOnlB,UAC5E,GAAIwU,OAAQhX,IACZ,KAAKA,KAAKunB,UAAUviB,eAAeuK,MAC/B,KAAM,IAAIrN,OAAM,oDAAuDylB,MAAQ,oCAAwCpY,KAAO,oBAElI,IAAa,MAAToY,OAAiC,GAAhBA,MAAMvnB,OACvB,KAAM,IAAI8B,OAAM,8CAAiDqN,KAAO,6CAE5E,KAAKmB,oBAAoBiX,OACrB,KAAM,IAAIzlB,OAAM,yCAA4CylB,MAAQ,gCAAoCpY,KAAO,sBAEnH,IAAqBqY,WAAYtkB,gBAAgBtD,KAAKynB,kBAAmB/mB,YACpD2C,MAASkM,KAAMA,KAAMoY,MAAOA,MAAOnlB,SAAUA,SAClEolB,WAAU5lB,KAAKqB,KACf,IAAqBwkB,oBAAqBvkB,gBAAgBtD,KAAKsnB,QAAQQ,gBAAiBpnB,WAMxF,OALKmnB,oBAAmB7iB,eAAeuK,QACnCiD,SAAS9R,QAASkV,sBAClBpD,SAAS9R,QAASkV,qBAAuB,IAAMrG,MAC/CsY,mBAAmBtY,MAAQ,MAExB,WAIHyH,MAAMsQ,QAAQS,WAAW,WACrB,GAAqBzX,OAAQsX,UAAU3jB,QAAQZ,KAC3CiN,QAAS,GACTsX,UAAU/hB,OAAOyK,MAAO,GAEvB0G,MAAMuQ,UAAUhY,aACVsY,oBAAmBtY,UAU1C6X,6BAA6Bje,UAAUic,SAAW,SAAU7V,KAAM3B,KAC9D,OAAI5N,KAAKunB,UAAUhY,QAKfvP,KAAKunB,UAAUhY,MAAQ3B,KAChB,IAOfwZ,6BAA6Bje,UAAU6e,YAAc,SAAUzY,MAC3D,GAAqB0Y,SAAUjoB,KAAKunB,UAAUhY,KAC9C,KAAK0Y,QACD,KAAM,IAAI/lB,OAAM,mCAAsCqN,KAAO,6BAEjE,OAAO0Y,UASXb,6BAA6Bje,UAAU8e,QAAU,SAAUvnB,QAASuC,YAAaS,MAAOwkB,mBACpF,GAAIlR,OAAQhX,IACc,UAAtBkoB,oBAAgCA,mBAAoB,EACxD,IAAqBD,SAAUjoB,KAAKgoB,YAAY/kB,aAC3BZ,OAAS,GAAI8lB,2BAA0BnoB,KAAKkE,GAAIjB,YAAavC,SAC7DmnB,mBAAqB7nB,KAAKsnB,QAAQQ,gBAAgBlkB,IAAIlD,QACtEmnB,sBACDrV,SAAS9R,QAASkV,sBAClBpD,SAAS9R,QAASkV,qBAAuB,IAAM3S,aAC/CjD,KAAKsnB,QAAQQ,gBAAgBjkB,IAAInD,QAASmnB,uBAE9C,IAAqB3kB,WAAY2kB,mBAAmB5kB,aAC/BE,QAAU,GAAI2jB,YAAWpjB,OACzBqjB,MAAQrjB,OAASA,MAAMsB,eAAe,QAK3D,KAJK+hB,OAAS7jB,WACVC,QAAQ6jB,cAAc9jB,UAAU+D,SAEpC4gB,mBAAmB5kB,aAAeE,QAC7BD,WAGA,GAAIA,YAAcikB,oBACnB,MAAO9kB,YAHPa,WAAYgkB,mBAKhB,IAAqB/C,WAAYhhB,QAAQO,QAAUujB,UAOnD,IAAK9C,WAAajhB,UAAUQ,QAAUP,QAAQO,MAA9C,CAmBA,GAAqB0kB,kBAAmB9kB,gBAAgBtD,KAAKsnB,QAAQe,iBAAkB3nB,WACvF0nB,kBAAiBlnB,QAAQ,SAAUmB,QAK3BA,OAAOqkB,aAAe1P,MAAM9S,IAAM7B,OAAOY,aAAeA,aAAeZ,OAAOimB,QAC9EjmB,OAAOmjB,WAGf,IAAqB1V,YAAamY,QAAQrD,gBAAgB1hB,UAAUQ,MAAOP,QAAQO,OAC9D6kB,sBAAuB,CAC5C,KAAKzY,WAAY,CACb,IAAKoY,kBACD,MACJpY,YAAamY,QAAQtD,mBACrB4D,sBAAuB,EAuB3B,MArBAvoB,MAAKsnB,QAAQkB,qBACbxoB,KAAKwnB,OAAOxlB,MAAOtB,QAASA,QAASuC,YAAaA,YAAa6M,WAAYA,WAAY5M,UAAWA,UAAWC,QAASA,QAASd,OAAQA,OAAQkmB,qBAAsBA,uBAChKA,uBACD/V,SAAS9R,QAAS0lB,kBAClB/jB,OAAOI,QAAQ,WAAcgQ,YAAY/R,QAAS0lB,qBAEtD/jB,OAAOO,OAAO,WACV,GAAqB0N,OAAQ0G,MAAM7W,QAAQ8D,QAAQ5B,OAC/CiO,QAAS,GACT0G,MAAM7W,QAAQ0F,OAAOyK,MAAO,EAEhC,IAAqBnQ,SAAU6W,MAAMsQ,QAAQe,iBAAiBzkB,IAAIlD,QAClE,IAAIP,QAAS,CACT,GAAqBsoB,SAAUtoB,QAAQ8D,QAAQ5B,OAC3ComB,UAAW,GACXtoB,QAAQ0F,OAAO4iB,QAAS,MAIpCzoB,KAAKG,QAAQ6B,KAAKK,QAClB+lB,iBAAiBpmB,KAAKK,QACfA,OAvDH,IAAK+Q,UAAUlQ,UAAUgE,OAAQ/D,QAAQ+D,QAAS,CAC9C,GAAqBpG,WACA4nB,aAAeT,QAAQnD,YAAY5hB,UAAUQ,MAAOR,UAAUgE,OAAQpG,QACtE6nB,WAAaV,QAAQnD,YAAY3hB,QAAQO,MAAOP,QAAQ+D,OAAQpG,OACjFA,QAAOV,OACPJ,KAAKsnB,QAAQsB,YAAY9nB,QAGzBd,KAAKsnB,QAAQS,WAAW,WACpBnhB,YAAYlG,QAASgoB,cACrBliB,UAAU9F,QAASioB,gBAmDvCvB,6BAA6Bje,UAAU0f,WAAa,SAAUtZ,MAC1D,GAAIyH,OAAQhX,WACLA,MAAKunB,UAAUhY,MACtBvP,KAAKsnB,QAAQQ,gBAAgB5mB,QAAQ,SAAU4nB,SAAUpoB,eAAkBooB,UAASvZ,QACpFvP,KAAKynB,kBAAkBvmB,QAAQ,SAAU0mB,UAAWlnB,SAChDsW,MAAMyQ,kBAAkB5jB,IAAInD,QAASknB,UAAUnL,OAAO,SAAU9C,OAAS,MAAOA,OAAMpK,MAAQA,WAOtG6X,6BAA6Bje,UAAU4f,kBAAoB,SAAUroB,SACjEV,KAAKsnB,QAAQQ,gBAAgBvX,OAAO7P,SACpCV,KAAKynB,kBAAkBlX,OAAO7P,QAC9B,IAAqBsoB,gBAAiBhpB,KAAKsnB,QAAQe,iBAAiBzkB,IAAIlD,QACpEsoB,kBACAA,eAAe9nB,QAAQ,SAAUmB,QAAU,MAAOA,QAAOmjB,YACzDxlB,KAAKsnB,QAAQe,iBAAiB9X,OAAO7P,WAS7C0mB,6BAA6Bje,UAAU8f,mBAAqB,SAAUtb,YAAanE,QAAS4L,SACxF,GAAI4B,OAAQhX,IACI,UAAZoV,UAAsBA,SAAU,GACpCpV,KAAKsnB,QAAQ9mB,OAAO2U,MAAMxH,YAAapB,qBAAqB,GAAMrL,QAAQ,SAAU2T,KAChF,GAAIO,SAAWlD,cAAc2C,IAAKmC,MAAM0Q,gBAAiB,CACrD,GAAqBwB,SAAUlS,MAAMsQ,QAAQ6B,wBAAwBvlB,IAAIiR,IAErEqU,UACAA,QAAQE,WAAWvU,IAAKrL,SAAS,GAErCwN,MAAMoS,WAAWvU,IAAKrL,SAAS,OAG/BwN,OAAM+R,kBAAkBlU,QAUpCuS,6BAA6Bje,UAAUigB,WAAa,SAAU1oB,QAAS8I,QAAS6f,cAC5E,GAAIrS,OAAQhX,KACS+S,OAAS/S,KAAKsnB,SAC9B+B,cAAgB3oB,QAAQ4oB,mBACzBtpB,KAAKipB,mBAAmBvoB,QAAS8I,SAAS,EAE9C,IAAqB+f,eAAgBxW,OAAO+U,gBAAgBlkB,IAAIlD,QAChE,IAAI6oB,cAAe,CACf,GAAqBC,aAWrB,IAVAjoB,OAAOC,KAAK+nB,eAAeroB,QAAQ,SAAU+B,aAGzC,GAAI+T,MAAMuQ,UAAUtkB,aAAc,CAC9B,GAAqBZ,QAAS2U,MAAMiR,QAAQvnB,QAASuC,YAAagkB,YAAY,EAC1E5kB,SACAmnB,UAAUxnB,KAAKK,WAIvBmnB,UAAUppB,OAGV,MAFA2S,QAAO0W,qBAAqBzpB,KAAKkE,GAAIxD,SAAS,EAAM8I,aACpDtJ,qBAAoBspB,WAAW5mB,OAAO,WAAc,MAAOmQ,QAAOC,iBAAiBtS,WAM3F,GAAqBgpB,oCAAoC,CACzD,IAAI3W,OAAO4W,gBAAiB,CACxB,GAAqBC,gBAAiB7W,OAAO5S,QAAQC,OAAS2S,OAAO8W,wBAAwBjmB,IAAIlD,WAKjG,IAAIkpB,gBAAkBA,eAAexpB,OACjCspB,mCAAoC,MAIpC,KADA,GAAqBI,UAAWppB,QACzBopB,SAAWA,SAAS9X,YAAY,CACnC,GAAqB+X,UAAWhX,OAAO+U,gBAAgBlkB,IAAIkmB,SAC3D,IAAIC,SAAU,CACVL,mCAAoC,CACpC,SAShB,GAAqB9B,WAAY5nB,KAAKynB,kBAAkB7jB,IAAIlD,QAC5D,IAAIknB,UAAW,CACX,GAAqBoC,mBAAoB,GAAInY,IAC7C+V,WAAU1mB,QAAQ,SAAU+oB,UACxB,GAAqBhnB,aAAcgnB,SAAS1a,IAC5C,KAAIya,kBAAkBjY,IAAI9O,aAA1B,CAEA+mB,kBAAkB/X,IAAIhP,YACtB,IAAqBglB,SAAUjR,MAAMuQ,UAAUtkB,aAC1B6M,WAAamY,QAAQtD,mBACrBuF,cAAkBnX,OAAO+U,gBAAgBlkB,IAAIlD,SAC7CwC,UAAYgnB,cAAcjnB,cAAgBikB,oBAC1C/jB,QAAU,GAAI2jB,YAAWG,YACzB5kB,OAAS,GAAI8lB,2BAA0BnR,MAAM9S,GAAIjB,YAAavC,QACnFsW,OAAMsQ,QAAQkB,qBACdxR,MAAMwQ,OAAOxlB,MACTtB,QAASA,QACTuC,YAAaA,YACb6M,WAAYA,WACZ5M,UAAWA,UACXC,QAASA,QACTd,OAAQA,OACRkmB,sBAAsB,OAM9BmB,kCACA3W,OAAO0W,qBAAqBzpB,KAAKkE,GAAIxD,SAAS,EAAO8I,UAKrDuJ,OAAOgV,WAAW,WAAc,MAAO/Q,OAAM+R,kBAAkBroB,WAC/DqS,OAAOoX,uBAAuBzpB,SAC9BqS,OAAOqX,mBAAmB1pB,QAAS8I,WAQ3C4d,6BAA6Bje,UAAUkhB,WAAa,SAAU3pB,QAAS4pB,QAAU9X,SAAS9R,QAASV,KAAK0nB,iBAKxGN,6BAA6Bje,UAAUohB,uBAAyB,SAAUC,aACtE,GAAIxT,OAAQhX,KACSkc,eA4BrB,OA3BAlc,MAAKwnB,OAAOtmB,QAAQ,SAAUyY,OAC1B,GAAqBtX,QAASsX,MAAMtX,MACpC,KAAIA,OAAOooB,UAAX,CAEA,GAAqB/pB,SAAUiZ,MAAMjZ,QAChBknB,UAAY5Q,MAAMyQ,kBAAkB7jB,IAAIlD,QACzDknB,YACAA,UAAU1mB,QAAQ,SAAU+oB,UACxB,GAAIA,SAAS1a,MAAQoK,MAAM1W,YAAa,CACpC,GAAqB0iB,WAAY3iB,mBAAmBtC,QAASiZ,MAAM1W,YAAa0W,MAAMzW,UAAUQ,MAAOiW,MAAMxW,QAAQO,MACrH,WAAqB,MAAI8mB,YACzBpoB,eAAeuX,MAAMtX,OAAQ4nB,SAAStC,MAAOhC,UAAWsE,SAASznB,aAIzEH,OAAOqoB,iBACP1T,MAAMsQ,QAAQS,WAAW,WAGrB1lB,OAAOmjB,YAIXtJ,aAAala,KAAK2X,UAG1B3Z,KAAKwnB,UACEtL,aAAayO,KAAK,SAAUtX,EAAGtK,GAGlC,GAAqB6hB,IAAKvX,EAAEvD,WAAWlC,IAAIsJ,SACtB2T,GAAK9hB,EAAE+G,WAAWlC,IAAIsJ,QAC3C,OAAU,IAAN0T,IAAiB,GAANC,GACJD,GAAKC,GAET7T,MAAMsQ,QAAQ9mB,OAAOwU,gBAAgB3B,EAAE3S,QAASqI,EAAErI,SAAW,GAAI,KAOhF0mB,6BAA6Bje,UAAUqc,QAAU,SAAUhc,SACvDxJ,KAAKG,QAAQe,QAAQ,SAAU+U,GAAK,MAAOA,GAAEuP,YAC7CxlB,KAAKipB,mBAAmBjpB,KAAKqnB,YAAa7d,UAM9C4d,6BAA6Bje,UAAU2hB,oBAAsB,SAAUpqB,SACnE,GAAqBqqB,eAAe,CAKpC,OAJI/qB,MAAKynB,kBAAkB1V,IAAIrR,WAC3BqqB,cAAe,GACnBA,eACK/qB,KAAKwnB,OAAOzb,KAAK,SAAU4N,OAAS,MAAOA,OAAMjZ,UAAYA,WAA+BqqB,cAG9F3D,gCAMP4D,0BAA6B,WAK7B,QAASA,2BAA0BxqB,OAAQykB,aACvCjlB,KAAKQ,OAASA,OACdR,KAAKilB,YAAcA,YACnBjlB,KAAKG,WACLH,KAAKirB,gBAAkB,GAAItnB,KAC3B3D,KAAKqoB,iBAAmB,GAAI1kB,KAC5B3D,KAAK6pB,wBAA0B,GAAIlmB,KACnC3D,KAAK8nB,gBAAkB,GAAInkB,KAC3B3D,KAAKkrB,cAAgB,GAAIrZ,KACzB7R,KAAK2pB,gBAAkB,EACvB3pB,KAAKwoB,mBAAqB,EAC1BxoB,KAAKmrB,oBACLnrB,KAAKorB,kBACLprB,KAAKqrB,aACLrrB,KAAKsrB,iBACLtrB,KAAKmpB,wBAA0B,GAAIxlB,KACnC3D,KAAKurB,0BACLvrB,KAAKwrB,0BACLxrB,KAAKyrB,kBAAoB,SAAU/qB,QAAS8I,WA8yBhD,MAtyBAwhB,2BAA0B7hB,UAAUihB,mBAAqB,SAAU1pB,QAAS8I,SAAWxJ,KAAKyrB,kBAAkB/qB,QAAS8I,UACvHjI,OAAOmV,eAAesU,0BAA0B7hB,UAAW,iBAIvDvF,IAAK,WACD,GAAqBzD,WAQrB,OAPAH,MAAKorB,eAAelqB,QAAQ,SAAUwqB,IAClCA,GAAGvrB,QAAQe,QAAQ,SAAUmB,QACrBA,OAAOimB,QACPnoB,QAAQ6B,KAAKK,YAIlBlC,SAEXwW,YAAY,EACZC,cAAc,IAOlBoU,0BAA0B7hB,UAAUwiB,gBAAkB,SAAUjF,YAAaW,aACzE,GAAqBqE,IAAK,GAAItE,8BAA6BV,YAAaW,YAAarnB,KAgBrF,OAfIqnB,aAAYrV,WACZhS,KAAK4rB,sBAAsBF,GAAIrE,cAM/BrnB,KAAKirB,gBAAgBpnB,IAAIwjB,YAAaqE,IAMtC1rB,KAAK6rB,oBAAoBxE,cAEtBrnB,KAAKmrB,iBAAiBzE,aAAegF,IAOhDV,0BAA0B7hB,UAAUyiB,sBAAwB,SAAUF,GAAIrE,aACtE,GAAqBrP,OAAQhY,KAAKorB,eAAehrB,OAAS,CAC1D,IAAI4X,OAAS,EAAG,CAEZ,IAAK,GADgB8T,QAAQ,EACHta,EAAIwG,MAAOxG,GAAK,EAAGA,IAAK,CAC9C,GAAqBua,eAAgB/rB,KAAKorB,eAAe5Z,EACzD,IAAIxR,KAAKQ,OAAOwU,gBAAgB+W,cAAc1E,YAAaA,aAAc,CACrErnB,KAAKorB,eAAevlB,OAAO2L,EAAI,EAAG,EAAGka,IACrCI,OAAQ,CACR,QAGHA,OACD9rB,KAAKorB,eAAevlB,OAAO,EAAG,EAAG6lB,QAIrC1rB,MAAKorB,eAAeppB,KAAK0pB,GAG7B,OADA1rB,MAAKmpB,wBAAwBtlB,IAAIwjB,YAAaqE,IACvCA,IAOXV,0BAA0B7hB,UAAUic,SAAW,SAAUsB,YAAaW,aAClE,GAAqBqE,IAAK1rB,KAAKmrB,iBAAiBzE,YAIhD,OAHKgF,MACDA,GAAK1rB,KAAK2rB,gBAAgBjF,YAAaW,cAEpCqE,IAQXV,0BAA0B7hB,UAAU6iB,gBAAkB,SAAUtF,YAAanX,KAAM0Y,SAC/E,GAAqByD,IAAK1rB,KAAKmrB,iBAAiBzE,YAC5CgF,KAAMA,GAAGtG,SAAS7V,KAAM0Y,UACxBjoB,KAAK2pB,mBAQbqB,0BAA0B7hB,UAAUqc,QAAU,SAAUkB,YAAald,SACjE,GAAIwN,OAAQhX,IACZ,IAAK0mB,YAAL,CAEA,GAAqBgF,IAAK1rB,KAAKisB,gBAAgBvF,YAC/C1mB,MAAK+nB,WAAW,WACZ/Q,MAAMmS,wBAAwB5Y,OAAOmb,GAAGrE,mBACjCrQ,OAAMmU,iBAAiBzE,YAC9B,IAAqBpW,OAAQ0G,MAAMoU,eAAennB,QAAQynB,GACtDpb,QAAS,GACT0G,MAAMoU,eAAevlB,OAAOyK,MAAO,KAG3CtQ,KAAKksB,yBAAyB,WAAc,MAAOR,IAAGlG,QAAQhc,aAMlEwhB,0BAA0B7hB,UAAU8iB,gBAAkB,SAAU/nB,IAAM,MAAOlE,MAAKmrB,iBAAiBjnB,KAQnG8mB,0BAA0B7hB,UAAU8e,QAAU,SAAUvB,YAAahmB,QAAS6O,KAAM7L,OAChF,QAAI+M,cAAc/P,WACdV,KAAKisB,gBAAgBvF,aAAauB,QAAQvnB,QAAS6O,KAAM7L,QAClD,IAWfsnB,0BAA0B7hB,UAAUkhB,WAAa,SAAU3D,YAAahmB,QAAS4pB,OAAQ6B,cACrF,GAAK1b,cAAc/P,SAAnB,CAIA,GAAqB0rB,SAAW1rB,QAAQ4Q,aACpC8a,UAAWA,QAAQzF,gBACnByF,QAAQzF,eAAgB,GAKxBD,aACA1mB,KAAKisB,gBAAgBvF,aAAa2D,WAAW3pB,QAAS4pB,QAGtD6B,cACAnsB,KAAK6rB,oBAAoBnrB,WAOjCsqB,0BAA0B7hB,UAAU0iB,oBAAsB,SAAUnrB,SAAWV,KAAKurB,uBAAuBvpB,KAAKtB,UAMhHsqB,0BAA0B7hB,UAAUkjB,sBAAwB,SAAU3rB,QAASgD,OACvEA,MACK1D,KAAKkrB,cAAcnZ,IAAIrR,WACxBV,KAAKkrB,cAAcjZ,IAAIvR,SACvB8R,SAAS9R,QAAS4lB,qBAGjBtmB,KAAKkrB,cAAcnZ,IAAIrR,WAC5BV,KAAKkrB,cAAc3a,OAAO7P,SAC1B+R,YAAY/R,QAAS4lB,sBAU7B0E,0BAA0B7hB,UAAUigB,WAAa,SAAU1C,YAAahmB,QAAS8I,QAAS6f,cACtF,IAAK5Y,cAAc/P,SAEf,WADAV,MAAKoqB,mBAAmB1pB,QAAS8I,QAGrC,IAAqBkiB,IAAKhF,YAAc1mB,KAAKisB,gBAAgBvF,aAAe,IACxEgF,IACAA,GAAGtC,WAAW1oB,QAAS8I,QAAS6f,cAGhCrpB,KAAKypB,qBAAqB/C,YAAahmB,SAAS,EAAO8I,UAU/DwhB,0BAA0B7hB,UAAUsgB,qBAAuB,SAAU/C,YAAahmB,QAASkmB,aAAcpd,SACrGxJ,KAAKwrB,uBAAuBxpB,KAAKtB,SACjCA,QAAQ4Q,eACJoV,YAAaA,YACbC,cAAend,QAASod,aAAcA,aACtCC,sBAAsB,IAW9BmE,0BAA0B7hB,UAAUuc,OAAS,SAAUgB,YAAahmB,QAAS6O,KAAMoY,MAAOnlB,UACtF,MAAIiO,eAAc/P,SACPV,KAAKisB,gBAAgBvF,aAAahB,OAAOhlB,QAAS6O,KAAMoY,MAAOnlB,UAEnE,cAOXwoB,0BAA0B7hB,UAAUmjB,kBAAoB,SAAU3S,MAAO4S,cACrE,MAAO5S,OAAM7J,WAAWnE,MAAM3L,KAAKQ,OAAQmZ,MAAMjZ,QAASiZ,MAAMzW,UAAUQ,MAAOiW,MAAMxW,QAAQO,MAAOiW,MAAMzW,UAAU+D,QAAS0S,MAAMxW,QAAQ8D,QAASslB,eAM1JvB,0BAA0B7hB,UAAUghB,uBAAyB,SAAUqC,kBACnE,GAAIxV,OAAQhX,KACS+Q,SAAW/Q,KAAKQ,OAAO2U,MAAMqX,iBAAkBjgB,qBAAqB,EACzFwE,UAAS7P,QAAQ,SAAUR,SACvB,GAAqBP,SAAU6W,MAAMqR,iBAAiBzkB,IAAIlD,QACtDP,UACAA,QAAQe,QAAQ,SAAUmB,QAIlBA,OAAOimB,OACPjmB,OAAOqoB,kBAAmB,EAG1BroB,OAAOmjB,WAInB,IAAqBsD,UAAW9R,MAAM8Q,gBAAgBlkB,IAAIlD,QACtDooB,WACAvnB,OAAOC,KAAKsnB,UAAU5nB,QAAQ,SAAU+B,aAAe,MAAO6lB,UAAS7lB,aAAekkB,wBAGrD,GAArCnnB,KAAK6pB,wBAAwBtQ,OAEjCxI,SAAW/Q,KAAKQ,OAAO2U,MAAMqX,iBAAkBhgB,uBAAuB,GAClEuE,SAAS3Q,QACT2Q,SAAS7P,QAAQ,SAAUR,SACvB,GAAqBP,SAAU6W,MAAM6S,wBAAwBjmB,IAAIlD,QAC7DP,UACAA,QAAQe,QAAQ,SAAUmB,QAAU,MAAOA,QAAO4jB,eAQlE+E,0BAA0B7hB,UAAUsjB,kBAAoB,WACpD,GAAIzV,OAAQhX,IACZ,OAAO,IAAI0sB,SAAQ,SAAUC,SACzB,MAAI3V,OAAM7W,QAAQC,OACPF,oBAAoB8W,MAAM7W,SAASyC,OAAO,WAAc,MAAO+pB,iBAGtEA,cAQZ3B,0BAA0B7hB,UAAU6J,iBAAmB,SAAUtS,SAC7D,GAAIsW,OAAQhX,KACSosB,QAAW1rB,QAAQ4Q,aACxC,IAAI8a,SAAWA,QAAQzF,cAAe,CAGlC,GADAjmB,QAAQ4Q,cAAgBmV,mBACpB2F,QAAQ1F,YAAa,CACrB1mB,KAAKmqB,uBAAuBzpB,QAC5B,IAAqBgrB,IAAK1rB,KAAKisB,gBAAgBG,QAAQ1F,YACnDgF,KACAA,GAAG3C,kBAAkBroB,SAG7BV,KAAKoqB,mBAAmB1pB,QAAS0rB,QAAQzF,eAEzC3mB,KAAKQ,OAAOuU,eAAerU,QAAS6lB,oBACpCvmB,KAAKqsB,sBAAsB3rB,SAAS,GAExCV,KAAKQ,OAAO2U,MAAMzU,QAAS6lB,mBAAmB,GAAMrlB,QAAQ,SAAUqI,MAClEyN,MAAMqV,sBAAsB3rB,SAAS,MAO7CsqB,0BAA0B7hB,UAAUyjB,MAAQ,SAAUpC,aAClD,GAAIxT,OAAQhX,IACQ,UAAhBwqB,cAA0BA,aAAc,EAC5C,IAAqBrqB,WAKrB,IAJIH,KAAKirB,gBAAgB1R,OACrBvZ,KAAKirB,gBAAgB/pB,QAAQ,SAAUwqB,GAAIhrB,SAAW,MAAOsW,OAAM4U,sBAAsBF,GAAIhrB,WAC7FV,KAAKirB,gBAAgB5O,SAErBrc,KAAKorB,eAAehrB,SACnBJ,KAAKwoB,oBAAsBxoB,KAAKwrB,uBAAuBprB,QAAS,CACjE,GAAqBysB,cACrB,KACI1sB,QAAUH,KAAK8sB,iBAAiBD,WAAYrC,aAEhD,QACI,IAAK,GAAqBhZ,GAAI,EAAGA,EAAIqb,WAAWzsB,OAAQoR,IACpDqb,WAAWrb,UAKnB,KAAK,GAAqBA,GAAI,EAAGA,EAAIxR,KAAKwrB,uBAAuBprB,OAAQoR,IAAK,CAC1E,GAAqB9Q,SAAUV,KAAKwrB,uBAAuBha,EAC3DxR,MAAKgT,iBAAiBtS,SAQ9B,GALAV,KAAKwoB,mBAAqB,EAC1BxoB,KAAKurB,uBAAuBnrB,OAAS,EACrCJ,KAAKwrB,uBAAuBprB,OAAS,EACrCJ,KAAKqrB,UAAUnqB,QAAQ,SAAUmO,IAAM,MAAOA,QAC9CrP,KAAKqrB,aACDrrB,KAAKsrB,cAAclrB,OAAQ,CAI3B,GAAqB2sB,YAAa/sB,KAAKsrB,aACvCtrB,MAAKsrB,iBACDnrB,QAAQC,OACRF,oBAAoBC,SAASyC,OAAO;AAAcmqB,WAAW7rB,QAAQ,SAAUmO,IAAM,MAAOA,UAG5F0d,WAAW7rB,QAAQ,SAAUmO,IAAM,MAAOA,UAQtD2b,0BAA0B7hB,UAAUyf,YAAc,SAAU9nB,QACxD,KAAM,IAAIoB,OAAM,kFAAoFpB,OAAOqB,KAAK,QAOpH6oB,0BAA0B7hB,UAAU2jB,iBAAmB,SAAUD,WAAYrC,aACzE,GAAIxT,OAAQhX,KACSusB,aAAe,GAAIxQ,uBACnBiR,kBACAC,kBAAoB,GAAItpB,KACxBupB,sBACAle,gBAAkB,GAAIrL,KACtBwpB,oBAAsB,GAAIxpB,KAC1BypB,qBAAuB,GAAIzpB,KAC3B0pB,oBAAsB,GAAIxb,IAC/C7R,MAAKkrB,cAAchqB,QAAQ,SAAUqI,MAEjC,IAAK,GADgB+jB,sBAAuBtW,MAAMxW,OAAO2U,MAAM5L,KAAM8c,iBAAiB,GAC5D7U,EAAI,EAAGA,EAAI8b,qBAAqBltB,OAAQoR,IAC9D6b,oBAAoBpb,IAAIqb,qBAAqB9b,KAUrD,KAAK,GAPgB+b,UAAW5a,cACX6a,cAAgBxtB,KAAKurB,uBAAuBnrB,OAC7DJ,KAAKurB,uBAAuB9O,OAAOhL,qBAAqBzR,KAAKurB,4BAKvC/Z,EAAI,EAAGA,EAAIgc,cAAcptB,OAAQoR,IACvDgB,SAASgb,cAAchc,GAAIkE,gBAI/B,KAAK,GAFgB+X,kBACAC,+BACKlc,EAAI,EAAGA,EAAIxR,KAAKwrB,uBAAuBprB,OAAQoR,IAAK,CAC1E,GAAqB9Q,SAAUV,KAAKwrB,uBAAuBha,GACtC4a,QAAW1rB,QAAQ4Q,aACpC8a,UAAWA,QAAQzF,gBACnBnU,SAAS9R,QAASiV,iBAClB8X,cAAczrB,KAAKtB,SACd0rB,QAAQxF,cACT8G,4BAA4B1rB,KAAKtB,UAI7CmsB,WAAW7qB,KAAK,WACZwrB,cAActsB,QAAQ,SAAUR,SAAW,MAAO+R,aAAY/R,QAASgV,mBACvE+X,cAAcvsB,QAAQ,SAAUR,SAC5B+R,YAAY/R,QAASiV,iBACrBqB,MAAMhE,iBAAiBtS,YAK/B,KAAK,GAFgBitB,eACAC,wBACKpc,EAAIxR,KAAKorB,eAAehrB,OAAS,EAAGoR,GAAK,EAAGA,IAAK,CACvE,GAAqBka,IAAK1rB,KAAKorB,eAAe5Z,EAC9Cka,IAAGnB,uBAAuBC,aAAatpB,QAAQ,SAAUyY,OACrD,GAAqBtX,QAASsX,MAAMtX,MACpCsrB,YAAW3rB,KAAKK,OAChB,IAAqB3B,SAAUiZ,MAAMjZ,OACrC,KAAK6sB,WAAavW,MAAMxW,OAAOwU,gBAAgBuY,SAAU7sB,SAErD,WADA2B,QAAOmjB,SAGX,IAAqBpI,aAAgBpG,MAAMsV,kBAAkB3S,MAAO4S,aACpE,IAAInP,YAAYtc,QAAUsc,YAAYtc,OAAOV,OAEzC,WADAwtB,sBAAqB5rB,KAAKob,YAK9B,IAAIzD,MAAM4O,qBAIN,MAHAlmB,QAAOI,QAAQ,WAAc,MAAOmE,aAAYlG,QAAS0c,YAAYvO,cACrExM,OAAOQ,UAAU,WAAc,MAAO2D,WAAU9F,QAAS0c,YAAYtO,gBACrEke,gBAAehrB,KAAKK,OAQxB+a,aAAYrO,UAAU7N,QAAQ,SAAU0b,IAAM,MAAOA,IAAGoD,yBAA0B,IAClFuM,aAAapQ,OAAOzb,QAAS0c,YAAYrO,UACzC,IAAqB+L,QAAUsC,YAAaA,YAAa/a,OAAQA,OAAQ3B,QAASA,QAClFwsB,oBAAmBlrB,KAAK8Y,OACxBsC,YAAYpO,gBAAgB9N,QAAQ,SAAUR,SAAW,MAAO4C,iBAAgB0L,gBAAiBtO,YAAasB,KAAKK,UACnH+a,YAAY7P,cAAcrM,QAAQ,SAAU2sB,UAAWntB,SACnD,GAAqB0Q,OAAQ7P,OAAOC,KAAKqsB,UACzC,IAAIzc,MAAMhR,OAAQ,CACd,GAAqB0tB,UAAaX,oBAAoBvpB,IAAIlD,QACrDotB,WACDX,oBAAoBtpB,IAAInD,QAASotB,SAAW,GAAIjc,MAEpDT,MAAMlQ,QAAQ,SAAUO,MAAQ,MAAOqsB,UAAS7b,IAAIxQ,WAG5D2b,YAAY5P,eAAetM,QAAQ,SAAU2sB,UAAWntB,SACpD,GAAqB0Q,OAAQ7P,OAAOC,KAAKqsB,WACpBE,OAAWX,qBAAqBxpB,IAAIlD,QACpDqtB,SACDX,qBAAqBvpB,IAAInD,QAASqtB,OAAS,GAAIlc,MAEnDT,MAAMlQ,QAAQ,SAAUO,MAAQ,MAAOssB,QAAO9b,IAAIxQ,YAI9D,GAAImsB,qBAAqBxtB,OAAQ,CAC7B,GAAqB4tB,YACrBJ,sBAAqB1sB,QAAQ,SAAUkc,aACnC4Q,SAAShsB,KAAK,IAAMob,YAAYna,YAAc,yBAC5Cma,YAAmB,OAAElc,QAAQ,SAAU+sB,OAAS,MAAOD,UAAShsB,KAAK,KAAOisB,MAAQ,UAE1FN,WAAWzsB,QAAQ,SAAUmB,QAAU,MAAOA,QAAOmjB,YACrDxlB,KAAK4oB,YAAYoF,UAKrB,IAAK,GADgBE,gCACK1c,EAAI,EAAGA,EAAIgc,cAAcptB,OAAQoR,IAAK,CAC5D,GAAqB9Q,SAAU8sB,cAAchc,EACxC+a,cAAaxa,IAAIrR,UAClBwtB,4BAA4BlsB,KAAKtB,SAGzC,GAAqBytB,uBAAwB,GAAIxqB,KAC5ByqB,uBACrBlB,oBAAmBhsB,QAAQ,SAAUyY,OACjC,GAAqBjZ,SAAUiZ,MAAMjZ,OACjC6rB,cAAaxa,IAAIrR,WACjB0tB,qBAAqBC,QAAQ3tB,SAC7BsW,MAAMsX,sBAAsB3U,MAAMtX,OAAOqkB,YAAa/M,MAAMyD,YAAa+Q,0BAGjFnB,eAAe9rB,QAAQ,SAAUmB,QAC7B,GAAqB3B,SAAU2B,OAAO3B,QACjB2U,gBAAkB2B,MAAMuX,oBAAoB7tB,SAAS,EAAO2B,OAAOqkB,YAAarkB,OAAOY,YAAa,KACzHoS,iBAAgBnU,QAAQ,SAAUstB,YAAclrB,gBAAgB6qB,sBAAuBztB,YAAasB,KAAKwsB,gBAE7GL,sBAAsBjtB,QAAQ,SAAUf,SAAW,MAAOA,SAAQe,QAAQ,SAAUmB,QAAU,MAAOA,QAAOmjB,aAE5G,IAAqBiJ,cAAetB,oBAAoB5T,KACpDzI,sBAAsB9Q,KAAKQ,OAAQ0tB,4BAA6Bf,oBAAqBltB,oBAAoB4B,YACzG,GAAI8B,KAEa+qB,cAAgB5d,sBAAsB9Q,KAAKQ,OAAQktB,4BAA6BN,qBAAsBntB,oBAAoB6B,YAC1H6sB,eACAC,aACrB1B,oBAAmBhsB,QAAQ,SAAUyY,OACjC,GAAIjZ,SAAUiZ,MAAMjZ,QAAS2B,OAASsX,MAAMtX,OAAQ+a,YAAczD,MAAMyD,WAGxE,IAAImP,aAAaxa,IAAIrR,SAAU,CAC3B,GAAI2sB,oBAAoBtb,IAAIrR,SAExB,WADAssB,gBAAehrB,KAAKK,OAGxB,IAAqBwsB,aAAc7X,MAAM8X,gBAAgBzsB,OAAOqkB,YAAatJ,YAAa+Q,sBAAuBlB,kBAAmBwB,aAAcC,cAClJrsB,QAAO0sB,cAAcF,YAErB,KAAK,GADgBG,mBAAoB,KACfxd,EAAI,EAAGA,EAAI4c,qBAAqBhuB,OAAQoR,IAAK,CACnE,GAAqByd,UAAWb,qBAAqB5c,EACrD,IAAIyd,WAAavuB,QACb,KACJ,IAAIsW,MAAMxW,OAAOwU,gBAAgBia,SAAUvuB,SAAU,CACjDsuB,kBAAoBC,QACpB,QAGR,GAAID,kBAAmB,CACnB,GAAqBE,eAAgBlY,MAAMqR,iBAAiBzkB,IAAIorB,kBAC5DE,gBAAiBA,cAAc9uB,SAC/BiC,OAAO8sB,aAAejvB,oBAAoBgvB,gBAE9ClC,eAAehrB,KAAKK,YAGpBssB,aAAY3sB,KAAKK,YAIrBuE,aAAYlG,QAAS0c,YAAYvO,YACjCxM,OAAOQ,UAAU,WAAc,MAAO2D,WAAU9F,QAAS0c,YAAYtO,YACrE8f,WAAW5sB,KAAKK,UAGxBusB,WAAW1tB,QAAQ,SAAUmB,QACzB,GAAqB+sB,mBAAoBnC,kBAAkBrpB,IAAIvB,OAAO3B,QACtE,IAAI0uB,mBAAqBA,kBAAkBhvB,OAAQ,CAC/C,GAAqByuB,aAAc3uB,oBAAoBkvB,kBACvD/sB,QAAO0sB,cAAcF,gBAM7B7B,eAAe9rB,QAAQ,SAAUmB,QACzBA,OAAO8sB,aACP9sB,OAAO8sB,aAAatsB,UAAU,WAAc,MAAOR,QAAOmjB,YAG1DnjB,OAAOmjB,WAMf,KAAK,GAAqBhU,GAAI,EAAGA,EAAIic,cAAcrtB,OAAQoR,IAAK,CAC5D,GAAqB9Q,SAAU+sB,cAAcjc,GACxB4a,QAAW1rB,QAAQ4Q,aAKxC,IAJAmB,YAAY/R,QAASiV,kBAIjByW,UAAWA,QAAQxF,aAAvB,CAEA,GAAqBzmB,WAIrB,IAAI6O,gBAAgBuK,KAAM,CACtB,GAAqB8V,sBAAuBrgB,gBAAgBpL,IAAIlD,QAC5D2uB,uBAAwBA,qBAAqBjvB,QAC7CD,QAAQ6B,KAAK0S,MAAMvU,QAASkvB,qBAGhC,KAAK,GADgBC,sBAAuBtvB,KAAKQ,OAAO2U,MAAMzU,QAAS8L,uBAAuB,GACpE+iB,EAAI,EAAGA,EAAID,qBAAqBlvB,OAAQmvB,IAAK,CACnE,GAAqBC,gBAAiBxgB,gBAAgBpL,IAAI0rB,qBAAqBC,GAC3EC,iBAAkBA,eAAepvB,QACjCD,QAAQ6B,KAAK0S,MAAMvU,QAASqvB,iBAIpCrvB,QAAQC,OACR0S,8BAA8B9S,KAAMU,QAASP,SAG7CH,KAAKgT,iBAAiBtS,UAc9B,MAVA+sB,eAAcrtB,OAAS,EACvBuuB,YAAYztB,QAAQ,SAAUmB,QAC1B2U,MAAM7W,QAAQ6B,KAAKK,QACnBA,OAAOO,OAAO,WACVP,OAAOmjB,SACP,IAAqBlV,OAAQ0G,MAAM7W,QAAQ8D,QAAQ5B,OACnD2U,OAAM7W,QAAQ0F,OAAOyK,MAAO,KAEhCjO,OAAOwjB,SAEJ8I,aAOX3D,0BAA0B7hB,UAAU2hB,oBAAsB,SAAUpE,YAAahmB,SAC7E,GAAqBqqB,eAAe,EACfqB,QAAW1rB,QAAQ4Q,aASxC,OARI8a,UAAWA,QAAQzF,gBACnBoE,cAAe,GACf/qB,KAAKqoB,iBAAiBtW,IAAIrR,WAC1BqqB,cAAe,GACf/qB,KAAK6pB,wBAAwB9X,IAAIrR,WACjCqqB,cAAe,GACf/qB,KAAK8nB,gBAAgB/V,IAAIrR,WACzBqqB,cAAe,GACZ/qB,KAAKisB,gBAAgBvF,aAAaoE,oBAAoBpqB,UAAYqqB,cAM7EC,0BAA0B7hB,UAAU4e,WAAa,SAAUvlB,UAAYxC,KAAKqrB,UAAUrpB,KAAKQ,WAK3FwoB,0BAA0B7hB,UAAU+iB,yBAA2B,SAAU1pB,UAAYxC,KAAKsrB,cAActpB,KAAKQ,WAS7GwoB,0BAA0B7hB,UAAUolB,oBAAsB,SAAU7tB,QAAS+uB,iBAAkB/I,YAAazjB,YAAaysB,cACrH,GAAqBvvB,WACrB,IAAIsvB,iBAAkB,CAClB,GAAqBE,uBAAwB3vB,KAAK6pB,wBAAwBjmB,IAAIlD,QAC1EivB,yBACAxvB,QAAUwvB,2BAGb,CACD,GAAqB3G,gBAAiBhpB,KAAKqoB,iBAAiBzkB,IAAIlD,QAChE,IAAIsoB,eAAgB,CAChB,GAAqB4G,uBAAwBF,cAAgBA,cAAgBzI,UAC7E+B,gBAAe9nB,QAAQ,SAAUmB,QACzBA,OAAOimB,SAENsH,sBAAwBvtB,OAAOY,aAAeA,cAEnD9C,QAAQ6B,KAAKK,WAazB,OATIqkB,aAAezjB,eACf9C,QAAUA,QAAQsc,OAAO,SAAUpa,QAC/B,QAAIqkB,aAAeA,aAAerkB,OAAOqkB,gBAErCzjB,aAAeA,aAAeZ,OAAOY,gBAK1C9C,SAQX6qB,0BAA0B7hB,UAAUmlB,sBAAwB,SAAU5H,YAAatJ,YAAa+Q,uBAC5F,GAAInX,OAAQhX,IAGZ4G,aAAYwW,YAAY1c,QAAS0c,YAAYvO,WAC7C,IAAqB5L,aAAcma,YAAYna,YAC1B0K,YAAcyP,YAAY1c,QAG1BmvB,kBAAoBzS,YAAYxO,oBAAsBxL,OAAYsjB,YAClEoJ,kBAAoB1S,YAAYxO,oBAAsBxL,OAAYH,WACvFma,aAAYrO,UAAUxL,IAAI,SAAUwsB,qBAChC,GAAqBrvB,SAAUqvB,oBAAoBrvB,QAC9B+uB,iBAAmB/uB,UAAYiN,YAC/BxN,QAAUmD,gBAAgB6qB,sBAAuBztB,YACjD2U,gBAAkB2B,MAAMuX,oBAAoB7tB,QAAS+uB,iBAAkBI,kBAAmBC,kBAAmB1S,YAAYja,QAC9IkS,iBAAgBnU,QAAQ,SAAUmB,QAC9B,GAAqB2tB,YAAc3tB,OAAO4tB,eACtCD,YAAWE,eACXF,WAAWE,gBAEf/vB,QAAQ6B,KAAKK,aAazB2oB,0BAA0B7hB,UAAU2lB,gBAAkB,SAAUpI,YAAatJ,YAAa+Q,sBAAuBlB,kBAAmBwB,aAAcC,eAC9I,GAAI1X,OAAQhX,KACSiD,YAAcma,YAAYna,YAC1B0K,YAAcyP,YAAY1c,QAG1ByvB,qBACAC,oBAAsB,GAAIve,KAC1Bwe,eAAiB,GAAIxe,KACrBye,cAAgBlT,YAAYrO,UAAUxL,IAAI,SAAUwsB,qBACrE,GAAqBrvB,SAAUqvB,oBAAoBrvB,OACnD0vB,qBAAoBne,IAAIvR,QAExB,IAAqB0rB,SAAU1rB,QAAQ4Q,aACvC,IAAI8a,SAAWA,QAAQvF,qBACnB,MAAO,IAAI5mB,qBAAoBI,mBACnC,IAAqBovB,kBAAmB/uB,UAAYiN,YAC/B0H,gBAAkBpC,qBAAqBkb,sBAAsBvqB,IAAIlD,UAAY8lB,oBAC7FjjB,IAAI,SAAU0S,GAAK,MAAOA,GAAEga,mBAC5BxT,OAAO,SAAUxG,GAKlB,GAAqBsa,IAAK,CAC1B,SAAOA,GAAG7vB,SAAU6vB,GAAG7vB,UAAYA,UAElBE,UAAY6tB,aAAa7qB,IAAIlD,SAC7BG,WAAa6tB,cAAc9qB,IAAIlD,SAC/BC,UAAYJ,mBAAmByW,MAAMxW,OAAQwW,MAAMiO,YAAavkB,QAASqvB,oBAAoBpvB,UAAWC,UAAWC,YACnHwB,OAAS2U,MAAMqO,aAAa0K,oBAAqBpvB,UAAW0U,gBAMjF,IAHI0a,oBAAoBtiB,aAAewf,mBACnCoD,eAAepe,IAAIvR,SAEnB+uB,iBAAkB,CAClB,GAAqBe,eAAgB,GAAIrI,2BAA0BzB,YAAazjB,YAAavC,QAC7F8vB,eAAczB,cAAc1sB,QAC5B8tB,kBAAkBnuB,KAAKwuB,eAE3B,MAAOnuB,SAEX8tB,mBAAkBjvB,QAAQ,SAAUmB,QAChCiB,gBAAgB0T,MAAM6S,wBAAyBxnB,OAAO3B,YAAasB,KAAKK,QACxEA,OAAOO,OAAO,WAAc,MAAOwN,oBAAmB4G,MAAM6S,wBAAyBxnB,OAAO3B,QAAS2B,YAEzG+tB,oBAAoBlvB,QAAQ,SAAUR,SAAW,MAAO8R,UAAS9R,QAASmV,yBAC1E,IAAqBxT,QAASnC,oBAAoBowB,cAQlD,OAPAjuB,QAAOQ,UAAU,WACbutB,oBAAoBlvB,QAAQ,SAAUR,SAAW,MAAO+R,aAAY/R,QAASmV,0BAC7ErP,UAAUmH,YAAayP,YAAYtO,YAIvCuhB,eAAenvB,QAAQ,SAAUR,SAAW4C,gBAAgB2pB,kBAAmBvsB,YAAasB,KAAKK,UAC1FA,QAQX2oB,0BAA0B7hB,UAAUkc,aAAe,SAAUjI,YAAazc,UAAW0U,iBACjF,MAAI1U,WAAUP,OAAS,EACZJ,KAAKQ,OAAO4U,QAAQgI,YAAY1c,QAASC,UAAWyc,YAAYjY,SAAUiY,YAAY/X,MAAO+X,YAAY9X,OAAQ+P,iBAIrH,GAAIpV,qBAAoBI,qBAE5B2qB,6BAEP7C,0BAA6B,WAM7B,QAASA,2BAA0BzB,YAAazjB,YAAavC,SACzDV,KAAK0mB,YAAcA,YACnB1mB,KAAKiD,YAAcA,YACnBjD,KAAKU,QAAUA,QACfV,KAAKywB,QAAU,GAAIxwB,qBAAoBI,oBACvCL,KAAK0wB,qBAAsB,EAC3B1wB,KAAK2wB,oBACL3wB,KAAK4wB,YAAa,EAClB5wB,KAAK0qB,kBAAmB,EAmI5B,MAjIAnpB,QAAOmV,eAAeyR,0BAA0Bhf,UAAW,UAIvDvF,IAAK,WAAc,MAAmC,IAA5B5D,KAAK0wB,qBAC/B/Z,YAAY,EACZC,cAAc,IAElBrV,OAAOmV,eAAeyR,0BAA0Bhf,UAAW,aAIvDvF,IAAK,WAAc,MAAO5D,MAAK4wB,YAC/Bja,YAAY,EACZC,cAAc,IAMlBuR,0BAA0Bhf,UAAU4lB,cAAgB,SAAU1sB,QAC1D,GAAI2U,OAAQhX,IACRA,MAAK0wB,sBAET1wB,KAAKywB,QAAUpuB,OACfd,OAAOC,KAAKxB,KAAK2wB,kBAAkBzvB,QAAQ,SAAUymB,OACjD3Q,MAAM2Z,iBAAiBhJ,OAAOzmB,QAAQ,SAAUsB,UAAY,MAAOJ,gBAAeC,OAAQslB,MAAOvkB,OAAWZ,cAEhHxC,KAAK2wB,oBACL3wB,KAAK0wB,qBAAsB,IAK/BvI,0BAA0Bhf,UAAU8mB,cAAgB,WAAc,MAAOjwB,MAAKywB,SAM9EtI,0BAA0Bhf,UAAU0nB,YAAc,SAAUthB,KAAM/M,UAC9Dc,gBAAgBtD,KAAK2wB,iBAAkBphB,SAAUvN,KAAKQ,WAM1D2lB,0BAA0Bhf,UAAUvG,OAAS,SAAUyM,IAC/CrP,KAAKsoB,QACLtoB,KAAK6wB,YAAY,OAAQxhB,IAE7BrP,KAAKywB,QAAQ7tB,OAAOyM,KAMxB8Y,0BAA0Bhf,UAAU1G,QAAU,SAAU4M,IAChDrP,KAAKsoB,QACLtoB,KAAK6wB,YAAY,QAASxhB,IAE9BrP,KAAKywB,QAAQhuB,QAAQ4M,KAMzB8Y,0BAA0Bhf,UAAUtG,UAAY,SAAUwM,IAClDrP,KAAKsoB,QACLtoB,KAAK6wB,YAAY,UAAWxhB,IAEhCrP,KAAKywB,QAAQ5tB,UAAUwM,KAK3B8Y,0BAA0Bhf,UAAU+c,KAAO,WAAclmB,KAAKywB,QAAQvK,QAItEiC,0BAA0Bhf,UAAU2nB,WAAa,WAAc,OAAO9wB,KAAKsoB,QAAiBtoB,KAAKywB,QAAQK,cAIzG3I,0BAA0Bhf,UAAU0c,KAAO,YAAe7lB,KAAKsoB,QAAUtoB,KAAKywB,QAAQ5K,QAItFsC,0BAA0Bhf,UAAU2c,MAAQ,YAAe9lB,KAAKsoB,QAAUtoB,KAAKywB,QAAQ3K,SAIvFqC,0BAA0Bhf,UAAU6c,QAAU,YAAehmB,KAAKsoB,QAAUtoB,KAAKywB,QAAQzK,WAIzFmC,0BAA0Bhf,UAAU8c,OAAS,WAAcjmB,KAAKywB,QAAQxK,UAIxEkC,0BAA0Bhf,UAAUqc,QAAU,WAC1CxlB,KAAK4wB,YAAa,EAClB5wB,KAAKywB,QAAQjL,WAKjB2C,0BAA0Bhf,UAAU4c,MAAQ,YAAe/lB,KAAKsoB,QAAUtoB,KAAKywB,QAAQ1K,SAKvFoC,0BAA0Bhf,UAAUgd,YAAc,SAAUlQ,GACnDjW,KAAKsoB,QACNtoB,KAAKywB,QAAQtK,YAAYlQ,IAMjCkS,0BAA0Bhf,UAAU4nB,YAAc,WAAc,MAAO/wB,MAAKsoB,OAAS,EAAItoB,KAAKywB,QAAQM,eACtGxvB,OAAOmV,eAAeyR,0BAA0Bhf,UAAW,aAIvDvF,IAAK,WAAc,MAAO5D,MAAKywB,QAAQ9tB,WACvCgU,YAAY,EACZC,cAAc,IAEXuR,6BAwHP5V,kBAAoB,YAiHpBye,gBAAmB,WAKnB,QAASA,iBAAgBxwB,OAAQC,YAC7B,GAAIuW,OAAQhX,IACZA,MAAKixB,iBACLjxB,KAAKyrB,kBAAoB,SAAU/qB,QAAS8I,WAC5CxJ,KAAKkxB,kBAAoB,GAAIlG,2BAA0BxqB,OAAQC,YAC/DT,KAAKmxB,gBAAkB,GAAInM,yBAAwBxkB,OAAQC,YAC3DT,KAAKkxB,kBAAkBzF,kBAAoB,SAAU/qB,QAAS8I,SAC1D,MAAOwN,OAAMyU,kBAAkB/qB,QAAS8I,UA4HhD,MAjHAwnB,iBAAgB7nB,UAAU6iB,gBAAkB,SAAUoF,YAAa1K,YAAaW,YAAa9X,KAAM9D,UAC/F,GAAqB4lB,UAAWD,YAAc,IAAM7hB,KAC/B0Y,QAAUjoB,KAAKixB,cAAcI,SAClD,KAAKpJ,QAAS,CACV,GAAqBnnB,WACA8M,IAAOpC,kBAAmC,SAAY1K,OAC3E,IAAIA,OAAOV,OACP,KAAM,IAAI8B,OAAM,0BAA6BqN,KAAO,0DAA6DzO,OAAOqB,KAAK,SAEjI8lB,SAAU3Y,aAAaC,KAAM3B,KAC7B5N,KAAKixB,cAAcI,UAAYpJ,QAEnCjoB,KAAKkxB,kBAAkBlF,gBAAgBtF,YAAanX,KAAM0Y,UAO9D+I,gBAAgB7nB,UAAUic,SAAW,SAAUsB,YAAaW,aACxDrnB,KAAKkxB,kBAAkB9L,SAASsB,YAAaW,cAOjD2J,gBAAgB7nB,UAAUqc,QAAU,SAAUkB,YAAald,SACvDxJ,KAAKkxB,kBAAkB1L,QAAQkB,YAAald,UAShDwnB,gBAAgB7nB,UAAUmoB,SAAW,SAAU5K,YAAahmB,QAAS4pB,OAAQ6B,cACzEnsB,KAAKkxB,kBAAkB7G,WAAW3D,YAAahmB,QAAS4pB,OAAQ6B,eAQpE6E,gBAAgB7nB,UAAUooB,SAAW,SAAU7K,YAAahmB,QAAS8I,SACjExJ,KAAKkxB,kBAAkB9H,WAAW1C,YAAahmB,QAAS8I,UAO5DwnB,gBAAgB7nB,UAAUqoB,kBAAoB,SAAU9wB,QAAS+wB,SAC7DzxB,KAAKkxB,kBAAkB7E,sBAAsB3rB,QAAS+wB,UAS1DT,gBAAgB7nB,UAAUuoB,QAAU,SAAUhL,YAAahmB,QAASixB,SAAUjuB,OAC1E,GAA0B,KAAtBiuB,SAASxkB,OAAO,GAAW,CAC3B,GAAIyO,IAAK9X,qBAAqB6tB,UAAWztB,GAAK0X,GAAG,GAAIxX,OAASwX,GAAG,GAC5CgK,KAAO,KAC5B5lB,MAAKmxB,gBAAgBptB,QAAQG,GAAIxD,QAAS0D,OAAQwhB,UAGlD5lB,MAAKkxB,kBAAkBjJ,QAAQvB,YAAahmB,QAASixB,SAAUjuB,QAWvEstB,gBAAgB7nB,UAAUuc,OAAS,SAAUgB,YAAahmB,QAAS4B,UAAWsvB,WAAYpvB,UAEtF,GAA2B,KAAvBF,UAAU6K,OAAO,GAAW,CAC5B,GAAIyO,IAAK9X,qBAAqBxB,WAAY4B,GAAK0X,GAAG,GAAIxX,OAASwX,GAAG,EAClE,OAAO5b,MAAKmxB,gBAAgBzL,OAAOxhB,GAAIxD,QAAS0D,OAAQ5B,UAE5D,MAAOxC,MAAKkxB,kBAAkBxL,OAAOgB,YAAahmB,QAAS4B,UAAWsvB,WAAYpvB,WAMtFwuB,gBAAgB7nB,UAAUyjB,MAAQ,SAAUpC,aACpB,SAAhBA,cAA0BA,aAAc,GAC5CxqB,KAAKkxB,kBAAkBtE,MAAMpC,cAEjCjpB,OAAOmV,eAAesa,gBAAgB7nB,UAAW,WAI7CvF,IAAK,WACD,MAAS5D,MAAKkxB,kBAA0B,QACnCW,OAAyB7xB,KAAKmxB,gBAAuB,UAE9Dxa,YAAY,EACZC,cAAc,IAKlBoa,gBAAgB7nB,UAAUsjB,kBAAoB,WAAc,MAAOzsB,MAAKkxB,kBAAkBzE,qBACnFuE,mBAOPc,oBAAuB,WAOvB,QAASA,qBAAoBpxB,QAASC,UAAWsG,QAASoO,iBAC9B,SAApBA,kBAA8BA,mBAClC,IAAI2B,OAAQhX,IACZA,MAAKU,QAAUA,QACfV,KAAKW,UAAYA,UACjBX,KAAKiH,QAAUA,QACfjH,KAAKqV,gBAAkBA,gBACvBrV,KAAK+xB,cACL/xB,KAAKgyB,eACLhyB,KAAKiyB,iBACLjyB,KAAKkyB,cAAe,EACpBlyB,KAAKmyB,WAAY,EACjBnyB,KAAKoyB,UAAW,EAChBpyB,KAAK4wB,YAAa,EAClB5wB,KAAKigB,KAAO,EACZjgB,KAAKmvB,aAAe,KACpBnvB,KAAKqyB,kBACLryB,KAAKsyB,mBACLtyB,KAAKuyB,UAAatrB,QAAmB,SACrCjH,KAAKwyB,OAAUvrB,QAAgB,OAAK,EACpCjH,KAAKigB,KAAOjgB,KAAKuyB,UAAYvyB,KAAKwyB,OAC9B5pB,+BAA+B5I,KAAKuyB,UAAWvyB,KAAKwyB,SACpDnd,gBAAgBnU,QAAQ,SAAUmB,QAC9B,GAAqB6D,QAAS7D,OAAOiwB,eACrC/wB,QAAOC,KAAK0E,QAAQhF,QAAQ,SAAUO,MAAQ,MAAOuV,OAAMqb,eAAe5wB,MAAQyE,OAAOzE,UA6MrG,MAtMAqwB,qBAAoB3oB,UAAUspB,UAAY,WACjCzyB,KAAKmyB,YACNnyB,KAAKmyB,WAAY,EACjBnyB,KAAK+xB,WAAW7wB,QAAQ,SAAUmO,IAAM,MAAOA,QAC/CrP,KAAK+xB,gBAMbD,oBAAoB3oB,UAAU+c,KAAO,WACjClmB,KAAKqlB,eACLrlB,KAAK0yB,6BAKTZ,oBAAoB3oB,UAAUkc,aAAe,WACzC,GAAIrO,OAAQhX,IACZ,KAAIA,KAAKkyB,aAAT,CAEAlyB,KAAKkyB,cAAe,CACpB,IAAqBvxB,WAAYX,KAAKW,UAAU4C,IAAI,SAAU2C,QAAU,MAAOI,YAAWJ,QAAQ,KAC7EysB,mBAAqBpxB,OAAOC,KAAKxB,KAAKqyB,eAC3D,IAAIM,mBAAmBvyB,OAAQ,CAC3B,GAAqBwyB,oBAAqBjyB,UAAU,GAC/BkyB,sBAOrB,IANAF,mBAAmBzxB,QAAQ,SAAUO,MAC5BmxB,mBAAmB5tB,eAAevD,OACnCoxB,oBAAoB7wB,KAAKP,MAE7BmxB,mBAAmBnxB,MAAQuV,MAAMqb,eAAe5wB,QAEhDoxB,oBAAoBzyB,OASpB,IAAK,GARgB0yB,QAAS9yB,KAC1B+yB,QAAU,WACV,GAAqB5xB,IAAKR,UAAU6Q,EACpCqhB,qBAAoB3xB,QAAQ,SAAUO,MAClCN,GAAGM,MAAQ+R,cAAcsf,OAAOpyB,QAASe,SAIvB+P,EAAI,EAAGA,EAAI7Q,UAAUP,OAAQoR,IACnDuhB,UAIZ/yB,KAAKywB,QAAUzwB,KAAKgzB,qBAAqBhzB,KAAKU,QAASC,UAAWX,KAAKiH,SACvEjH,KAAKizB,eAAiBtyB,UAAUP,OAASO,UAAUA,UAAUP,OAAS,MACtEJ,KAAKywB,QAAQyC,iBAAiB,SAAU,WAAc,MAAOlc,OAAMyb,gBAKvEX,oBAAoB3oB,UAAUupB,0BAA4B,WAElD1yB,KAAKwyB,OACLxyB,KAAKmzB,uBAGLnzB,KAAKywB,QAAQ3K,SAUrBgM,oBAAoB3oB,UAAU6pB,qBAAuB,SAAUtyB,QAASC,UAAWsG,SAG/E,MAAQvG,SAAiB,QAAEC,UAAWsG,UAE1C1F,OAAOmV,eAAeob,oBAAoB3oB,UAAW,aAIjDvF,IAAK,WAAc,MAAO5D,MAAKywB,SAC/B9Z,YAAY,EACZC,cAAc,IAMlBkb,oBAAoB3oB,UAAU1G,QAAU,SAAU4M,IAAMrP,KAAKgyB,YAAYhwB,KAAKqN,KAK9EyiB,oBAAoB3oB,UAAUvG,OAAS,SAAUyM,IAAMrP,KAAK+xB,WAAW/vB,KAAKqN,KAK5EyiB,oBAAoB3oB,UAAUtG,UAAY,SAAUwM,IAAMrP,KAAKiyB,cAAcjwB,KAAKqN,KAIlFyiB,oBAAoB3oB,UAAU0c,KAAO,WACjC7lB,KAAKqlB,eACArlB,KAAK8wB,eACN9wB,KAAKgyB,YAAY9wB,QAAQ,SAAUmO,IAAM,MAAOA,QAChDrP,KAAKgyB,eACLhyB,KAAKoyB,UAAW,GAEpBpyB,KAAKywB,QAAQ5K,QAKjBiM,oBAAoB3oB,UAAU2c,MAAQ,WAClC9lB,KAAKkmB,OACLlmB,KAAKywB,QAAQ3K,SAKjBgM,oBAAoB3oB,UAAU8c,OAAS,WACnCjmB,KAAKkmB,OACLlmB,KAAKyyB,YACLzyB,KAAKywB,QAAQxK,UAKjB6L,oBAAoB3oB,UAAU4c,MAAQ,WAClC/lB,KAAKmzB,uBACLnzB,KAAK4wB,YAAa,EAClB5wB,KAAKmyB,WAAY,EACjBnyB,KAAKoyB,UAAW,GAKpBN,oBAAoB3oB,UAAUgqB,qBAAuB,WAC7CnzB,KAAKywB,SACLzwB,KAAKywB,QAAQ2C,UAMrBtB,oBAAoB3oB,UAAU6c,QAAU,WACpChmB,KAAK+lB,QACL/lB,KAAK6lB,QAKTiM,oBAAoB3oB,UAAU2nB,WAAa,WAAc,MAAO9wB,MAAKoyB,UAIrEN,oBAAoB3oB,UAAUqc,QAAU,WAC/BxlB,KAAK4wB,aACN5wB,KAAKmzB,uBACLnzB,KAAKyyB,YACLzyB,KAAK4wB,YAAa,EAClB5wB,KAAKiyB,cAAc/wB,QAAQ,SAAUmO,IAAM,MAAOA,QAClDrP,KAAKiyB,mBAObH,oBAAoB3oB,UAAUgd,YAAc,SAAUlQ,GAAKjW,KAAKywB,QAAQ7X,YAAc3C,EAAIjW,KAAKigB,MAI/F6R,oBAAoB3oB,UAAU4nB,YAAc,WAAc,MAAO/wB,MAAKywB,QAAQ7X,YAAc5Y,KAAKigB,MACjG1e,OAAOmV,eAAeob,oBAAoB3oB,UAAW,aAIjDvF,IAAK,WAAc,MAAO5D,MAAKwyB,OAASxyB,KAAKuyB,WAC7C5b,YAAY,EACZC,cAAc,IAKlBkb,oBAAoB3oB,UAAU+mB,cAAgB,WAC1C,GAAIlZ,OAAQhX,KACSkG,SACjBlG,MAAK8wB,cACLvvB,OAAOC,KAAKxB,KAAKizB,gBAAgB/xB,QAAQ,SAAUO,MACnC,UAARA,OACAyE,OAAOzE,MACHuV,MAAMmb,UAAYnb,MAAMic,eAAexxB,MAAQ+R,cAAcwD,MAAMtW,QAASe,SAI5FzB,KAAKsyB,gBAAkBpsB,QAEpB4rB,uBAePuB,oBAAuB,WACvB,QAASA,wBAuDT,MAhDAA,qBAAoBlqB,UAAU4L,eAAiB,SAAUrU,QAASmL,UAC9D,MAAOkJ,gBAAerU,QAASmL,WAOnCwnB,oBAAoBlqB,UAAU6L,gBAAkB,SAAUlB,KAAMC,MAAQ,MAAOiB,iBAAgBlB,KAAMC,OAOrGsf,oBAAoBlqB,UAAUgM,MAAQ,SAAUzU,QAASmL,SAAUqI,OAC/D,MAAOe,aAAYvU,QAASmL,SAAUqI,QAQ1Cmf,oBAAoBlqB,UAAUkI,aAAe,SAAU3Q,QAASe,KAAMgC,cAClE,MAAUgQ,QAAOC,iBAAiBhT,SAAWe,OAWjD4xB,oBAAoBlqB,UAAUiM,QAAU,SAAU1U,QAASC,UAAWwE,SAAUE,MAAOC,OAAQ+P,iBACnE,SAApBA,kBAA8BA,mBAClC,IAAqBie,MAAgB,GAATjuB,MAAa,OAAS,WAC7BkuB,eAAkBpuB,SAAUA,SAAUE,MAAOA,MAAOiuB,KAAMA,KAG3EhuB,UACAiuB,cAAsB,OAAIjuB,OAE9B,IAAqBkuB,6BAA+Bne,gBAAgBoH,OAAO,SAAUpa,QAAU,MAAOA,kBAAkByvB,sBACxH,OAAO,IAAIA,qBAAoBpxB,QAASC,UAAW4yB,cAAeC,8BAE/DH;;;;;;;;;;;;;;;;;;;;;AA+DX7zB,QAAQ8V,gBAAkBA,gBAC1B9V,QAAQi0B,WAAaxR,UACrBziB,QAAQk0B,0BAA4BlR,yBACpChjB,QAAQm0B,8BAAgClR,6BACxCjjB,QAAQo0B,8BAAgC/Q,6BACxCrjB,QAAQq0B,qBAAuB3e,oBAC/B1V,QAAQs0B,iBAAmB9C,gBAC3BxxB,QAAQu0B,qBAAuBV,oBAC/B7zB,QAAQw0B,uBAAyBrgB,sBACjCnU,QAAQy0B,qBAAuBnC,oBAE/BvwB,OAAOmV,eAAelX,QAAS,cAAgBkE,OAAO","file":"/Users/jasonaden/Projects/angular/dist/packages-dist/animations/bundles/animations-browser.umd.min.js","sourcesContent":["/**\n * @license Angular v5.0.0-beta.3-14502f5b34\n * (c) 2010-2017 Google, Inc. https://angular.io/\n * License: MIT\n */\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/animations')) :\n\ttypeof define === 'function' && define.amd ? define(['exports', '@angular/animations'], factory) :\n\t(factory((global.ng = global.ng || {}, global.ng.animations = global.ng.animations || {}, global.ng.animations.browser = global.ng.animations.browser || {}),global.ng.animations));\n}(this, (function (exports,_angular_animations) { 'use strict';\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * @param {?} players\n * @return {?}\n */\nfunction optimizeGroupPlayer(players) {\n    switch (players.length) {\n        case 0:\n            return new _angular_animations.NoopAnimationPlayer();\n        case 1:\n            return players[0];\n        default:\n            return new _angular_animations.ɵAnimationGroupPlayer(players);\n    }\n}\n/**\n * @param {?} driver\n * @param {?} normalizer\n * @param {?} element\n * @param {?} keyframes\n * @param {?=} preStyles\n * @param {?=} postStyles\n * @return {?}\n */\nfunction normalizeKeyframes(driver, normalizer, element, keyframes, preStyles, postStyles) {\n    if (preStyles === void 0) { preStyles = {}; }\n    if (postStyles === void 0) { postStyles = {}; }\n    var /** @type {?} */ errors = [];\n    var /** @type {?} */ normalizedKeyframes = [];\n    var /** @type {?} */ previousOffset = -1;\n    var /** @type {?} */ previousKeyframe = null;\n    keyframes.forEach(function (kf) {\n        var /** @type {?} */ offset = (kf['offset']);\n        var /** @type {?} */ isSameOffset = offset == previousOffset;\n        var /** @type {?} */ normalizedKeyframe = (isSameOffset && previousKeyframe) || {};\n        Object.keys(kf).forEach(function (prop) {\n            var /** @type {?} */ normalizedProp = prop;\n            var /** @type {?} */ normalizedValue = kf[prop];\n            if (prop !== 'offset') {\n                normalizedProp = normalizer.normalizePropertyName(normalizedProp, errors);\n                switch (normalizedValue) {\n                    case _angular_animations.ɵPRE_STYLE:\n                        normalizedValue = preStyles[prop];\n                        break;\n                    case _angular_animations.AUTO_STYLE:\n                        normalizedValue = postStyles[prop];\n                        break;\n                    default:\n                        normalizedValue =\n                            normalizer.normalizeStyleValue(prop, normalizedProp, normalizedValue, errors);\n                        break;\n                }\n            }\n            normalizedKeyframe[normalizedProp] = normalizedValue;\n        });\n        if (!isSameOffset) {\n            normalizedKeyframes.push(normalizedKeyframe);\n        }\n        previousKeyframe = normalizedKeyframe;\n        previousOffset = offset;\n    });\n    if (errors.length) {\n        var /** @type {?} */ LINE_START = '\\n - ';\n        throw new Error(\"Unable to animate due to the following errors:\" + LINE_START + errors.join(LINE_START));\n    }\n    return normalizedKeyframes;\n}\n/**\n * @param {?} player\n * @param {?} eventName\n * @param {?} event\n * @param {?} callback\n * @return {?}\n */\nfunction listenOnPlayer(player, eventName, event, callback) {\n    switch (eventName) {\n        case 'start':\n            player.onStart(function () { return callback(event && copyAnimationEvent(event, 'start', player.totalTime)); });\n            break;\n        case 'done':\n            player.onDone(function () { return callback(event && copyAnimationEvent(event, 'done', player.totalTime)); });\n            break;\n        case 'destroy':\n            player.onDestroy(function () { return callback(event && copyAnimationEvent(event, 'destroy', player.totalTime)); });\n            break;\n    }\n}\n/**\n * @param {?} e\n * @param {?=} phaseName\n * @param {?=} totalTime\n * @return {?}\n */\nfunction copyAnimationEvent(e, phaseName, totalTime) {\n    var /** @type {?} */ event = makeAnimationEvent(e.element, e.triggerName, e.fromState, e.toState, phaseName || e.phaseName, totalTime == undefined ? e.totalTime : totalTime);\n    var /** @type {?} */ data = ((e))['_data'];\n    if (data != null) {\n        ((event))['_data'] = data;\n    }\n    return event;\n}\n/**\n * @param {?} element\n * @param {?} triggerName\n * @param {?} fromState\n * @param {?} toState\n * @param {?=} phaseName\n * @param {?=} totalTime\n * @return {?}\n */\nfunction makeAnimationEvent(element, triggerName, fromState, toState, phaseName, totalTime) {\n    if (phaseName === void 0) { phaseName = ''; }\n    if (totalTime === void 0) { totalTime = 0; }\n    return { element: element, triggerName: triggerName, fromState: fromState, toState: toState, phaseName: phaseName, totalTime: totalTime };\n}\n/**\n * @param {?} map\n * @param {?} key\n * @param {?} defaultValue\n * @return {?}\n */\nfunction getOrSetAsInMap(map, key, defaultValue) {\n    var /** @type {?} */ value;\n    if (map instanceof Map) {\n        value = map.get(key);\n        if (!value) {\n            map.set(key, value = defaultValue);\n        }\n    }\n    else {\n        value = map[key];\n        if (!value) {\n            value = map[key] = defaultValue;\n        }\n    }\n    return value;\n}\n/**\n * @param {?} command\n * @return {?}\n */\nfunction parseTimelineCommand(command) {\n    var /** @type {?} */ separatorPos = command.indexOf(':');\n    var /** @type {?} */ id = command.substring(1, separatorPos);\n    var /** @type {?} */ action = command.substr(separatorPos + 1);\n    return [id, action];\n}\nvar _contains = function (elm1, elm2) { return false; };\nvar _matches = function (element, selector) {\n    return false;\n};\nvar _query = function (element, selector, multi) {\n    return [];\n};\nif (typeof Element != 'undefined') {\n    // this is well supported in all browsers\n    _contains = function (elm1, elm2) { return (elm1.contains(elm2)); };\n    if (Element.prototype.matches) {\n        _matches = function (element, selector) { return element.matches(selector); };\n    }\n    else {\n        var /** @type {?} */ proto = (Element.prototype);\n        var /** @type {?} */ fn_1 = proto.matchesSelector || proto.mozMatchesSelector || proto.msMatchesSelector ||\n            proto.oMatchesSelector || proto.webkitMatchesSelector;\n        if (fn_1) {\n            _matches = function (element, selector) { return fn_1.apply(element, [selector]); };\n        }\n    }\n    _query = function (element, selector, multi) {\n        var /** @type {?} */ results = [];\n        if (multi) {\n            results.push.apply(results, element.querySelectorAll(selector));\n        }\n        else {\n            var /** @type {?} */ elm = element.querySelector(selector);\n            if (elm) {\n                results.push(elm);\n            }\n        }\n        return results;\n    };\n}\nvar matchesElement = _matches;\nvar containsElement = _contains;\nvar invokeQuery = _query;\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * \\@experimental\n */\nvar NoopAnimationDriver = (function () {\n    function NoopAnimationDriver() {\n    }\n    /**\n     * @param {?} element\n     * @param {?} selector\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.matchesElement = function (element, selector) {\n        return matchesElement(element, selector);\n    };\n    /**\n     * @param {?} elm1\n     * @param {?} elm2\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.containsElement = function (elm1, elm2) { return containsElement(elm1, elm2); };\n    /**\n     * @param {?} element\n     * @param {?} selector\n     * @param {?} multi\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.query = function (element, selector, multi) {\n        return invokeQuery(element, selector, multi);\n    };\n    /**\n     * @param {?} element\n     * @param {?} prop\n     * @param {?=} defaultValue\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.computeStyle = function (element, prop, defaultValue) {\n        return defaultValue || '';\n    };\n    /**\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} duration\n     * @param {?} delay\n     * @param {?} easing\n     * @param {?=} previousPlayers\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.animate = function (element, keyframes, duration, delay, easing, previousPlayers) {\n        if (previousPlayers === void 0) { previousPlayers = []; }\n        return new _angular_animations.NoopAnimationPlayer();\n    };\n    return NoopAnimationDriver;\n}());\n/**\n * \\@experimental\n * @abstract\n */\nvar AnimationDriver = (function () {\n    function AnimationDriver() {\n    }\n    return AnimationDriver;\n}());\nAnimationDriver.NOOP = new NoopAnimationDriver();\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar ONE_SECOND = 1000;\nvar SUBSTITUTION_EXPR_START = '{{';\nvar SUBSTITUTION_EXPR_END = '}}';\nvar ENTER_CLASSNAME = 'ng-enter';\nvar LEAVE_CLASSNAME = 'ng-leave';\nvar ENTER_SELECTOR = '.ng-enter';\nvar LEAVE_SELECTOR = '.ng-leave';\nvar NG_TRIGGER_CLASSNAME = 'ng-trigger';\nvar NG_TRIGGER_SELECTOR = '.ng-trigger';\nvar NG_ANIMATING_CLASSNAME = 'ng-animating';\nvar NG_ANIMATING_SELECTOR = '.ng-animating';\n/**\n * @param {?} value\n * @return {?}\n */\nfunction resolveTimingValue(value) {\n    if (typeof value == 'number')\n        return value;\n    var /** @type {?} */ matches = ((value)).match(/^(-?[\\.\\d]+)(m?s)/);\n    if (!matches || matches.length < 2)\n        return 0;\n    return _convertTimeValueToMS(parseFloat(matches[1]), matches[2]);\n}\n/**\n * @param {?} value\n * @param {?} unit\n * @return {?}\n */\nfunction _convertTimeValueToMS(value, unit) {\n    switch (unit) {\n        case 's':\n            return value * ONE_SECOND;\n        default:\n            return value;\n    }\n}\n/**\n * @param {?} timings\n * @param {?} errors\n * @param {?=} allowNegativeValues\n * @return {?}\n */\nfunction resolveTiming(timings, errors, allowNegativeValues) {\n    return timings.hasOwnProperty('duration') ? (timings) :\n        parseTimeExpression(/** @type {?} */ (timings), errors, allowNegativeValues);\n}\n/**\n * @param {?} exp\n * @param {?} errors\n * @param {?=} allowNegativeValues\n * @return {?}\n */\nfunction parseTimeExpression(exp, errors, allowNegativeValues) {\n    var /** @type {?} */ regex = /^(-?[\\.\\d]+)(m?s)(?:\\s+(-?[\\.\\d]+)(m?s))?(?:\\s+([-a-z]+(?:\\(.+?\\))?))?$/i;\n    var /** @type {?} */ duration;\n    var /** @type {?} */ delay = 0;\n    var /** @type {?} */ easing = '';\n    if (typeof exp === 'string') {\n        var /** @type {?} */ matches = exp.match(regex);\n        if (matches === null) {\n            errors.push(\"The provided timing value \\\"\" + exp + \"\\\" is invalid.\");\n            return { duration: 0, delay: 0, easing: '' };\n        }\n        duration = _convertTimeValueToMS(parseFloat(matches[1]), matches[2]);\n        var /** @type {?} */ delayMatch = matches[3];\n        if (delayMatch != null) {\n            delay = _convertTimeValueToMS(Math.floor(parseFloat(delayMatch)), matches[4]);\n        }\n        var /** @type {?} */ easingVal = matches[5];\n        if (easingVal) {\n            easing = easingVal;\n        }\n    }\n    else {\n        duration = (exp);\n    }\n    if (!allowNegativeValues) {\n        var /** @type {?} */ containsErrors = false;\n        var /** @type {?} */ startIndex = errors.length;\n        if (duration < 0) {\n            errors.push(\"Duration values below 0 are not allowed for this animation step.\");\n            containsErrors = true;\n        }\n        if (delay < 0) {\n            errors.push(\"Delay values below 0 are not allowed for this animation step.\");\n            containsErrors = true;\n        }\n        if (containsErrors) {\n            errors.splice(startIndex, 0, \"The provided timing value \\\"\" + exp + \"\\\" is invalid.\");\n        }\n    }\n    return { duration: duration, delay: delay, easing: easing };\n}\n/**\n * @param {?} obj\n * @param {?=} destination\n * @return {?}\n */\nfunction copyObj(obj, destination) {\n    if (destination === void 0) { destination = {}; }\n    Object.keys(obj).forEach(function (prop) { destination[prop] = obj[prop]; });\n    return destination;\n}\n/**\n * @param {?} styles\n * @return {?}\n */\nfunction normalizeStyles(styles) {\n    var /** @type {?} */ normalizedStyles = {};\n    if (Array.isArray(styles)) {\n        styles.forEach(function (data) { return copyStyles(data, false, normalizedStyles); });\n    }\n    else {\n        copyStyles(styles, false, normalizedStyles);\n    }\n    return normalizedStyles;\n}\n/**\n * @param {?} styles\n * @param {?} readPrototype\n * @param {?=} destination\n * @return {?}\n */\nfunction copyStyles(styles, readPrototype, destination) {\n    if (destination === void 0) { destination = {}; }\n    if (readPrototype) {\n        // we make use of a for-in loop so that the\n        // prototypically inherited properties are\n        // revealed from the backFill map\n        for (var /** @type {?} */ prop in styles) {\n            destination[prop] = styles[prop];\n        }\n    }\n    else {\n        copyObj(styles, destination);\n    }\n    return destination;\n}\n/**\n * @param {?} element\n * @param {?} styles\n * @return {?}\n */\nfunction setStyles(element, styles) {\n    if (element['style']) {\n        Object.keys(styles).forEach(function (prop) {\n            var /** @type {?} */ camelProp = dashCaseToCamelCase(prop);\n            element.style[camelProp] = styles[prop];\n        });\n    }\n}\n/**\n * @param {?} element\n * @param {?} styles\n * @return {?}\n */\nfunction eraseStyles(element, styles) {\n    if (element['style']) {\n        Object.keys(styles).forEach(function (prop) {\n            var /** @type {?} */ camelProp = dashCaseToCamelCase(prop);\n            element.style[camelProp] = '';\n        });\n    }\n}\n/**\n * @param {?} steps\n * @return {?}\n */\nfunction normalizeAnimationEntry(steps) {\n    if (Array.isArray(steps)) {\n        if (steps.length == 1)\n            return steps[0];\n        return _angular_animations.sequence(steps);\n    }\n    return (steps);\n}\n/**\n * @param {?} value\n * @param {?} options\n * @param {?} errors\n * @return {?}\n */\nfunction validateStyleParams(value, options, errors) {\n    var /** @type {?} */ params = options.params || {};\n    var /** @type {?} */ matches = extractStyleParams(value);\n    if (matches.length) {\n        matches.forEach(function (varName) {\n            if (!params.hasOwnProperty(varName)) {\n                errors.push(\"Unable to resolve the local animation param \" + varName + \" in the given list of values\");\n            }\n        });\n    }\n}\nvar PARAM_REGEX = new RegExp(SUBSTITUTION_EXPR_START + \"\\\\s*(.+?)\\\\s*\" + SUBSTITUTION_EXPR_END, 'g');\n/**\n * @param {?} value\n * @return {?}\n */\nfunction extractStyleParams(value) {\n    var /** @type {?} */ params = [];\n    if (typeof value === 'string') {\n        var /** @type {?} */ val = value.toString();\n        var /** @type {?} */ match = void 0;\n        while (match = PARAM_REGEX.exec(val)) {\n            params.push(/** @type {?} */ (match[1]));\n        }\n        PARAM_REGEX.lastIndex = 0;\n    }\n    return params;\n}\n/**\n * @param {?} value\n * @param {?} params\n * @param {?} errors\n * @return {?}\n */\nfunction interpolateParams(value, params, errors) {\n    var /** @type {?} */ original = value.toString();\n    var /** @type {?} */ str = original.replace(PARAM_REGEX, function (_, varName) {\n        var /** @type {?} */ localVal = params[varName];\n        // this means that the value was never overidden by the data passed in by the user\n        if (!params.hasOwnProperty(varName)) {\n            errors.push(\"Please provide a value for the animation param \" + varName);\n            localVal = '';\n        }\n        return localVal.toString();\n    });\n    // we do this to assert that numeric values stay as they are\n    return str == original ? value : str;\n}\n/**\n * @param {?} iterator\n * @return {?}\n */\nfunction iteratorToArray(iterator) {\n    var /** @type {?} */ arr = [];\n    var /** @type {?} */ item = iterator.next();\n    while (!item.done) {\n        arr.push(item.value);\n        item = iterator.next();\n    }\n    return arr;\n}\n/**\n * @param {?} source\n * @param {?} destination\n * @return {?}\n */\n\nvar DASH_CASE_REGEXP = /-+([a-z0-9])/g;\n/**\n * @param {?} input\n * @return {?}\n */\nfunction dashCaseToCamelCase(input) {\n    return input.replace(DASH_CASE_REGEXP, function () {\n        var m = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            m[_i] = arguments[_i];\n        }\n        return m[1].toUpperCase();\n    });\n}\n/**\n * @param {?} duration\n * @param {?} delay\n * @return {?}\n */\nfunction allowPreviousPlayerStylesMerge(duration, delay) {\n    return duration === 0 || delay === 0;\n}\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = Object.setPrototypeOf ||\r\n    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = Object.assign || function __assign(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n};\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar EMPTY_ANIMATION_OPTIONS = {};\n/**\n * @record\n */\n\n/**\n * @abstract\n */\nvar Ast = (function () {\n    function Ast() {\n        this.options = EMPTY_ANIMATION_OPTIONS;\n    }\n    Object.defineProperty(Ast.prototype, \"params\", {\n        /**\n         * @return {?}\n         */\n        get: function () { return this.options['params'] || null; },\n        enumerable: true,\n        configurable: true\n    });\n    return Ast;\n}());\nvar TriggerAst = (function (_super) {\n    __extends(TriggerAst, _super);\n    /**\n     * @param {?} name\n     * @param {?} states\n     * @param {?} transitions\n     */\n    function TriggerAst(name, states, transitions) {\n        var _this = _super.call(this) || this;\n        _this.name = name;\n        _this.states = states;\n        _this.transitions = transitions;\n        _this.queryCount = 0;\n        _this.depCount = 0;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    TriggerAst.prototype.visit = function (visitor, context) { return visitor.visitTrigger(this, context); };\n    return TriggerAst;\n}(Ast));\nvar StateAst = (function (_super) {\n    __extends(StateAst, _super);\n    /**\n     * @param {?} name\n     * @param {?} style\n     */\n    function StateAst(name, style$$1) {\n        var _this = _super.call(this) || this;\n        _this.name = name;\n        _this.style = style$$1;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    StateAst.prototype.visit = function (visitor, context) { return visitor.visitState(this, context); };\n    return StateAst;\n}(Ast));\nvar TransitionAst = (function (_super) {\n    __extends(TransitionAst, _super);\n    /**\n     * @param {?} matchers\n     * @param {?} animation\n     */\n    function TransitionAst(matchers, animation) {\n        var _this = _super.call(this) || this;\n        _this.matchers = matchers;\n        _this.animation = animation;\n        _this.queryCount = 0;\n        _this.depCount = 0;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    TransitionAst.prototype.visit = function (visitor, context) { return visitor.visitTransition(this, context); };\n    return TransitionAst;\n}(Ast));\nvar SequenceAst = (function (_super) {\n    __extends(SequenceAst, _super);\n    /**\n     * @param {?} steps\n     */\n    function SequenceAst(steps) {\n        var _this = _super.call(this) || this;\n        _this.steps = steps;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    SequenceAst.prototype.visit = function (visitor, context) { return visitor.visitSequence(this, context); };\n    return SequenceAst;\n}(Ast));\nvar GroupAst = (function (_super) {\n    __extends(GroupAst, _super);\n    /**\n     * @param {?} steps\n     */\n    function GroupAst(steps) {\n        var _this = _super.call(this) || this;\n        _this.steps = steps;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    GroupAst.prototype.visit = function (visitor, context) { return visitor.visitGroup(this, context); };\n    return GroupAst;\n}(Ast));\nvar AnimateAst = (function (_super) {\n    __extends(AnimateAst, _super);\n    /**\n     * @param {?} timings\n     * @param {?} style\n     */\n    function AnimateAst(timings, style$$1) {\n        var _this = _super.call(this) || this;\n        _this.timings = timings;\n        _this.style = style$$1;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    AnimateAst.prototype.visit = function (visitor, context) { return visitor.visitAnimate(this, context); };\n    return AnimateAst;\n}(Ast));\nvar StyleAst = (function (_super) {\n    __extends(StyleAst, _super);\n    /**\n     * @param {?} styles\n     * @param {?} easing\n     * @param {?} offset\n     */\n    function StyleAst(styles, easing, offset) {\n        var _this = _super.call(this) || this;\n        _this.styles = styles;\n        _this.easing = easing;\n        _this.offset = offset;\n        _this.isEmptyStep = false;\n        _this.containsDynamicStyles = false;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    StyleAst.prototype.visit = function (visitor, context) { return visitor.visitStyle(this, context); };\n    return StyleAst;\n}(Ast));\nvar KeyframesAst = (function (_super) {\n    __extends(KeyframesAst, _super);\n    /**\n     * @param {?} styles\n     */\n    function KeyframesAst(styles) {\n        var _this = _super.call(this) || this;\n        _this.styles = styles;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    KeyframesAst.prototype.visit = function (visitor, context) { return visitor.visitKeyframes(this, context); };\n    return KeyframesAst;\n}(Ast));\nvar ReferenceAst = (function (_super) {\n    __extends(ReferenceAst, _super);\n    /**\n     * @param {?} animation\n     */\n    function ReferenceAst(animation) {\n        var _this = _super.call(this) || this;\n        _this.animation = animation;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    ReferenceAst.prototype.visit = function (visitor, context) { return visitor.visitReference(this, context); };\n    return ReferenceAst;\n}(Ast));\nvar AnimateChildAst = (function (_super) {\n    __extends(AnimateChildAst, _super);\n    function AnimateChildAst() {\n        return _super.call(this) || this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    AnimateChildAst.prototype.visit = function (visitor, context) { return visitor.visitAnimateChild(this, context); };\n    return AnimateChildAst;\n}(Ast));\nvar AnimateRefAst = (function (_super) {\n    __extends(AnimateRefAst, _super);\n    /**\n     * @param {?} animation\n     */\n    function AnimateRefAst(animation) {\n        var _this = _super.call(this) || this;\n        _this.animation = animation;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    AnimateRefAst.prototype.visit = function (visitor, context) { return visitor.visitAnimateRef(this, context); };\n    return AnimateRefAst;\n}(Ast));\nvar QueryAst = (function (_super) {\n    __extends(QueryAst, _super);\n    /**\n     * @param {?} selector\n     * @param {?} limit\n     * @param {?} optional\n     * @param {?} includeSelf\n     * @param {?} animation\n     */\n    function QueryAst(selector, limit, optional, includeSelf, animation) {\n        var _this = _super.call(this) || this;\n        _this.selector = selector;\n        _this.limit = limit;\n        _this.optional = optional;\n        _this.includeSelf = includeSelf;\n        _this.animation = animation;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    QueryAst.prototype.visit = function (visitor, context) { return visitor.visitQuery(this, context); };\n    return QueryAst;\n}(Ast));\nvar StaggerAst = (function (_super) {\n    __extends(StaggerAst, _super);\n    /**\n     * @param {?} timings\n     * @param {?} animation\n     */\n    function StaggerAst(timings, animation) {\n        var _this = _super.call(this) || this;\n        _this.timings = timings;\n        _this.animation = animation;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    StaggerAst.prototype.visit = function (visitor, context) { return visitor.visitStagger(this, context); };\n    return StaggerAst;\n}(Ast));\nvar TimingAst = (function (_super) {\n    __extends(TimingAst, _super);\n    /**\n     * @param {?} duration\n     * @param {?=} delay\n     * @param {?=} easing\n     */\n    function TimingAst(duration, delay, easing) {\n        if (delay === void 0) { delay = 0; }\n        if (easing === void 0) { easing = null; }\n        var _this = _super.call(this) || this;\n        _this.duration = duration;\n        _this.delay = delay;\n        _this.easing = easing;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    TimingAst.prototype.visit = function (visitor, context) { return visitor.visitTiming(this, context); };\n    return TimingAst;\n}(Ast));\nvar DynamicTimingAst = (function (_super) {\n    __extends(DynamicTimingAst, _super);\n    /**\n     * @param {?} value\n     */\n    function DynamicTimingAst(value) {\n        var _this = _super.call(this, 0, 0, '') || this;\n        _this.value = value;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    DynamicTimingAst.prototype.visit = function (visitor, context) { return visitor.visitTiming(this, context); };\n    return DynamicTimingAst;\n}(TimingAst));\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @record\n */\n\n/**\n * @param {?} visitor\n * @param {?} node\n * @param {?} context\n * @return {?}\n */\nfunction visitAnimationNode(visitor, node, context) {\n    switch (node.type) {\n        case 7 /* Trigger */:\n            return visitor.visitTrigger(/** @type {?} */ (node), context);\n        case 0 /* State */:\n            return visitor.visitState(/** @type {?} */ (node), context);\n        case 1 /* Transition */:\n            return visitor.visitTransition(/** @type {?} */ (node), context);\n        case 2 /* Sequence */:\n            return visitor.visitSequence(/** @type {?} */ (node), context);\n        case 3 /* Group */:\n            return visitor.visitGroup(/** @type {?} */ (node), context);\n        case 4 /* Animate */:\n            return visitor.visitAnimate(/** @type {?} */ (node), context);\n        case 5 /* Keyframes */:\n            return visitor.visitKeyframes(/** @type {?} */ (node), context);\n        case 6 /* Style */:\n            return visitor.visitStyle(/** @type {?} */ (node), context);\n        case 8 /* Reference */:\n            return visitor.visitReference(/** @type {?} */ (node), context);\n        case 9 /* AnimateChild */:\n            return visitor.visitAnimateChild(/** @type {?} */ (node), context);\n        case 10 /* AnimateRef */:\n            return visitor.visitAnimateRef(/** @type {?} */ (node), context);\n        case 11 /* Query */:\n            return visitor.visitQuery(/** @type {?} */ (node), context);\n        case 12 /* Stagger */:\n            return visitor.visitStagger(/** @type {?} */ (node), context);\n        default:\n            throw new Error(\"Unable to resolve animation metadata node #\" + node.type);\n    }\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */ var ANY_STATE = '*';\n/**\n * @param {?} transitionValue\n * @param {?} errors\n * @return {?}\n */\nfunction parseTransitionExpr(transitionValue, errors) {\n    var /** @type {?} */ expressions = [];\n    if (typeof transitionValue == 'string') {\n        ((transitionValue))\n            .split(/\\s*,\\s*/)\n            .forEach(function (str) { return parseInnerTransitionStr(str, expressions, errors); });\n    }\n    else {\n        expressions.push(/** @type {?} */ (transitionValue));\n    }\n    return expressions;\n}\n/**\n * @param {?} eventStr\n * @param {?} expressions\n * @param {?} errors\n * @return {?}\n */\nfunction parseInnerTransitionStr(eventStr, expressions, errors) {\n    if (eventStr[0] == ':') {\n        var /** @type {?} */ result = parseAnimationAlias(eventStr, errors);\n        if (typeof result == 'function') {\n            expressions.push(result);\n            return;\n        }\n        eventStr = (result);\n    }\n    var /** @type {?} */ match = eventStr.match(/^(\\*|[-\\w]+)\\s*(<?[=-]>)\\s*(\\*|[-\\w]+)$/);\n    if (match == null || match.length < 4) {\n        errors.push(\"The provided transition expression \\\"\" + eventStr + \"\\\" is not supported\");\n        return expressions;\n    }\n    var /** @type {?} */ fromState = match[1];\n    var /** @type {?} */ separator = match[2];\n    var /** @type {?} */ toState = match[3];\n    expressions.push(makeLambdaFromStates(fromState, toState));\n    var /** @type {?} */ isFullAnyStateExpr = fromState == ANY_STATE && toState == ANY_STATE;\n    if (separator[0] == '<' && !isFullAnyStateExpr) {\n        expressions.push(makeLambdaFromStates(toState, fromState));\n    }\n}\n/**\n * @param {?} alias\n * @param {?} errors\n * @return {?}\n */\nfunction parseAnimationAlias(alias, errors) {\n    switch (alias) {\n        case ':enter':\n            return 'void => *';\n        case ':leave':\n            return '* => void';\n        case ':increment':\n            return function (fromState, toState) { return parseFloat(toState) > parseFloat(fromState); };\n        case ':decrement':\n            return function (fromState, toState) { return parseFloat(toState) < parseFloat(fromState); };\n        default:\n            errors.push(\"The transition alias value \\\"\" + alias + \"\\\" is not supported\");\n            return '* => *';\n    }\n}\n/**\n * @param {?} lhs\n * @param {?} rhs\n * @return {?}\n */\nfunction makeLambdaFromStates(lhs, rhs) {\n    return function (fromState, toState) {\n        var /** @type {?} */ lhsMatch = lhs == ANY_STATE || lhs == fromState;\n        var /** @type {?} */ rhsMatch = rhs == ANY_STATE || rhs == toState;\n        if (!lhsMatch && typeof fromState === 'boolean') {\n            lhsMatch = fromState ? lhs === 'true' : lhs === 'false';\n        }\n        if (!rhsMatch && typeof toState === 'boolean') {\n            rhsMatch = toState ? rhs === 'true' : rhs === 'false';\n        }\n        return lhsMatch && rhsMatch;\n    };\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar SELF_TOKEN = ':self';\nvar SELF_TOKEN_REGEX = new RegExp(\"s*\" + SELF_TOKEN + \"s*,?\", 'g');\n/**\n * @param {?} metadata\n * @param {?} errors\n * @return {?}\n */\nfunction buildAnimationAst(metadata, errors) {\n    return new AnimationAstBuilderVisitor().build(metadata, errors);\n}\nvar LEAVE_TOKEN = ':leave';\nvar LEAVE_TOKEN_REGEX = new RegExp(LEAVE_TOKEN, 'g');\nvar ENTER_TOKEN = ':enter';\nvar ENTER_TOKEN_REGEX = new RegExp(ENTER_TOKEN, 'g');\nvar ROOT_SELECTOR = '';\nvar AnimationAstBuilderVisitor = (function () {\n    function AnimationAstBuilderVisitor() {\n    }\n    /**\n     * @param {?} metadata\n     * @param {?} errors\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.build = function (metadata, errors) {\n        var /** @type {?} */ context = new AnimationAstBuilderContext(errors);\n        this._resetContextStyleTimingState(context);\n        return (visitAnimationNode(this, normalizeAnimationEntry(metadata), context));\n    };\n    /**\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype._resetContextStyleTimingState = function (context) {\n        context.currentQuerySelector = ROOT_SELECTOR;\n        context.collectedStyles = {};\n        context.collectedStyles[ROOT_SELECTOR] = {};\n        context.currentTime = 0;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitTrigger = function (metadata, context) {\n        var _this = this;\n        var /** @type {?} */ queryCount = context.queryCount = 0;\n        var /** @type {?} */ depCount = context.depCount = 0;\n        var /** @type {?} */ states = [];\n        var /** @type {?} */ transitions = [];\n        metadata.definitions.forEach(function (def) {\n            _this._resetContextStyleTimingState(context);\n            if (def.type == 0 /* State */) {\n                var /** @type {?} */ stateDef_1 = (def);\n                var /** @type {?} */ name_1 = stateDef_1.name;\n                name_1.split(/\\s*,\\s*/).forEach(function (n) {\n                    stateDef_1.name = n;\n                    states.push(_this.visitState(stateDef_1, context));\n                });\n                stateDef_1.name = name_1;\n            }\n            else if (def.type == 1 /* Transition */) {\n                var /** @type {?} */ transition = _this.visitTransition(/** @type {?} */ (def), context);\n                queryCount += transition.queryCount;\n                depCount += transition.depCount;\n                transitions.push(transition);\n            }\n            else {\n                context.errors.push('only state() and transition() definitions can sit inside of a trigger()');\n            }\n        });\n        var /** @type {?} */ ast = new TriggerAst(metadata.name, states, transitions);\n        ast.options = normalizeAnimationOptions(metadata.options);\n        ast.queryCount = queryCount;\n        ast.depCount = depCount;\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitState = function (metadata, context) {\n        var /** @type {?} */ styleAst = this.visitStyle(metadata.styles, context);\n        var /** @type {?} */ astParams = (metadata.options && metadata.options.params) || null;\n        if (styleAst.containsDynamicStyles) {\n            var /** @type {?} */ missingSubs_1 = new Set();\n            var /** @type {?} */ params_1 = astParams || {};\n            styleAst.styles.forEach(function (value) {\n                if (isObject(value)) {\n                    var /** @type {?} */ stylesObj_1 = (value);\n                    Object.keys(stylesObj_1).forEach(function (prop) {\n                        extractStyleParams(stylesObj_1[prop]).forEach(function (sub) {\n                            if (!params_1.hasOwnProperty(sub)) {\n                                missingSubs_1.add(sub);\n                            }\n                        });\n                    });\n                }\n            });\n            if (missingSubs_1.size) {\n                var /** @type {?} */ missingSubsArr = iteratorToArray(missingSubs_1.values());\n                context.errors.push(\"state(\\\"\" + metadata.name + \"\\\", ...) must define default values for all the following style substitutions: \" + missingSubsArr.join(', '));\n            }\n        }\n        var /** @type {?} */ stateAst = new StateAst(metadata.name, styleAst);\n        if (astParams) {\n            stateAst.options = { params: astParams };\n        }\n        return stateAst;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitTransition = function (metadata, context) {\n        context.queryCount = 0;\n        context.depCount = 0;\n        var /** @type {?} */ entry = visitAnimationNode(this, normalizeAnimationEntry(metadata.animation), context);\n        var /** @type {?} */ matchers = parseTransitionExpr(metadata.expr, context.errors);\n        var /** @type {?} */ ast = new TransitionAst(matchers, entry);\n        ast.options = normalizeAnimationOptions(metadata.options);\n        ast.queryCount = context.queryCount;\n        ast.depCount = context.depCount;\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitSequence = function (metadata, context) {\n        var _this = this;\n        var /** @type {?} */ ast = new SequenceAst(metadata.steps.map(function (s) { return visitAnimationNode(_this, s, context); }));\n        ast.options = normalizeAnimationOptions(metadata.options);\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitGroup = function (metadata, context) {\n        var _this = this;\n        var /** @type {?} */ currentTime = context.currentTime;\n        var /** @type {?} */ furthestTime = 0;\n        var /** @type {?} */ steps = metadata.steps.map(function (step) {\n            context.currentTime = currentTime;\n            var /** @type {?} */ innerAst = visitAnimationNode(_this, step, context);\n            furthestTime = Math.max(furthestTime, context.currentTime);\n            return innerAst;\n        });\n        context.currentTime = furthestTime;\n        var /** @type {?} */ ast = new GroupAst(steps);\n        ast.options = normalizeAnimationOptions(metadata.options);\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitAnimate = function (metadata, context) {\n        var /** @type {?} */ timingAst = constructTimingAst(metadata.timings, context.errors);\n        context.currentAnimateTimings = timingAst;\n        var /** @type {?} */ styles;\n        var /** @type {?} */ styleMetadata = metadata.styles ? metadata.styles : _angular_animations.style({});\n        if (styleMetadata.type == 5 /* Keyframes */) {\n            styles = this.visitKeyframes(/** @type {?} */ (styleMetadata), context);\n        }\n        else {\n            var /** @type {?} */ styleMetadata_1 = (metadata.styles);\n            var /** @type {?} */ isEmpty = false;\n            if (!styleMetadata_1) {\n                isEmpty = true;\n                var /** @type {?} */ newStyleData = {};\n                if (timingAst.easing) {\n                    newStyleData['easing'] = timingAst.easing;\n                }\n                styleMetadata_1 = _angular_animations.style(newStyleData);\n            }\n            context.currentTime += timingAst.duration + timingAst.delay;\n            var /** @type {?} */ styleAst = this.visitStyle(styleMetadata_1, context);\n            styleAst.isEmptyStep = isEmpty;\n            styles = styleAst;\n        }\n        context.currentAnimateTimings = null;\n        return new AnimateAst(timingAst, styles);\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitStyle = function (metadata, context) {\n        var /** @type {?} */ ast = this._makeStyleAst(metadata, context);\n        this._validateStyleAst(ast, context);\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype._makeStyleAst = function (metadata, context) {\n        var /** @type {?} */ styles = [];\n        if (Array.isArray(metadata.styles)) {\n            ((metadata.styles)).forEach(function (styleTuple) {\n                if (typeof styleTuple == 'string') {\n                    if (styleTuple == _angular_animations.AUTO_STYLE) {\n                        styles.push(/** @type {?} */ (styleTuple));\n                    }\n                    else {\n                        context.errors.push(\"The provided style string value \" + styleTuple + \" is not allowed.\");\n                    }\n                }\n                else {\n                    styles.push(/** @type {?} */ (styleTuple));\n                }\n            });\n        }\n        else {\n            styles.push(metadata.styles);\n        }\n        var /** @type {?} */ containsDynamicStyles = false;\n        var /** @type {?} */ collectedEasing = null;\n        styles.forEach(function (styleData) {\n            if (isObject(styleData)) {\n                var /** @type {?} */ styleMap = (styleData);\n                var /** @type {?} */ easing = styleMap['easing'];\n                if (easing) {\n                    collectedEasing = (easing);\n                    delete styleMap['easing'];\n                }\n                if (!containsDynamicStyles) {\n                    for (var /** @type {?} */ prop in styleMap) {\n                        var /** @type {?} */ value = styleMap[prop];\n                        if (value.toString().indexOf(SUBSTITUTION_EXPR_START) >= 0) {\n                            containsDynamicStyles = true;\n                            break;\n                        }\n                    }\n                }\n            }\n        });\n        var /** @type {?} */ ast = new StyleAst(styles, collectedEasing, metadata.offset);\n        ast.containsDynamicStyles = containsDynamicStyles;\n        return ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype._validateStyleAst = function (ast, context) {\n        var /** @type {?} */ timings = context.currentAnimateTimings;\n        var /** @type {?} */ endTime = context.currentTime;\n        var /** @type {?} */ startTime = context.currentTime;\n        if (timings && startTime > 0) {\n            startTime -= timings.duration + timings.delay;\n        }\n        ast.styles.forEach(function (tuple) {\n            if (typeof tuple == 'string')\n                return;\n            Object.keys(tuple).forEach(function (prop) {\n                var /** @type {?} */ collectedStyles = context.collectedStyles[((context.currentQuerySelector))];\n                var /** @type {?} */ collectedEntry = collectedStyles[prop];\n                var /** @type {?} */ updateCollectedStyle = true;\n                if (collectedEntry) {\n                    if (startTime != endTime && startTime >= collectedEntry.startTime &&\n                        endTime <= collectedEntry.endTime) {\n                        context.errors.push(\"The CSS property \\\"\" + prop + \"\\\" that exists between the times of \\\"\" + collectedEntry.startTime + \"ms\\\" and \\\"\" + collectedEntry.endTime + \"ms\\\" is also being animated in a parallel animation between the times of \\\"\" + startTime + \"ms\\\" and \\\"\" + endTime + \"ms\\\"\");\n                        updateCollectedStyle = false;\n                    }\n                    // we always choose the smaller start time value since we\n                    // want to have a record of the entire animation window where\n                    // the style property is being animated in between\n                    startTime = collectedEntry.startTime;\n                }\n                if (updateCollectedStyle) {\n                    collectedStyles[prop] = { startTime: startTime, endTime: endTime };\n                }\n                if (context.options) {\n                    validateStyleParams(tuple[prop], context.options, context.errors);\n                }\n            });\n        });\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitKeyframes = function (metadata, context) {\n        var _this = this;\n        if (!context.currentAnimateTimings) {\n            context.errors.push(\"keyframes() must be placed inside of a call to animate()\");\n            return new KeyframesAst([]);\n        }\n        var /** @type {?} */ MAX_KEYFRAME_OFFSET = 1;\n        var /** @type {?} */ totalKeyframesWithOffsets = 0;\n        var /** @type {?} */ offsets = [];\n        var /** @type {?} */ offsetsOutOfOrder = false;\n        var /** @type {?} */ keyframesOutOfRange = false;\n        var /** @type {?} */ previousOffset = 0;\n        var /** @type {?} */ keyframes = metadata.steps.map(function (styles) {\n            var /** @type {?} */ style$$1 = _this._makeStyleAst(styles, context);\n            var /** @type {?} */ offsetVal = style$$1.offset != null ? style$$1.offset : consumeOffset(style$$1.styles);\n            var /** @type {?} */ offset = 0;\n            if (offsetVal != null) {\n                totalKeyframesWithOffsets++;\n                offset = style$$1.offset = offsetVal;\n            }\n            keyframesOutOfRange = keyframesOutOfRange || offset < 0 || offset > 1;\n            offsetsOutOfOrder = offsetsOutOfOrder || offset < previousOffset;\n            previousOffset = offset;\n            offsets.push(offset);\n            return style$$1;\n        });\n        if (keyframesOutOfRange) {\n            context.errors.push(\"Please ensure that all keyframe offsets are between 0 and 1\");\n        }\n        if (offsetsOutOfOrder) {\n            context.errors.push(\"Please ensure that all keyframe offsets are in order\");\n        }\n        var /** @type {?} */ length = metadata.steps.length;\n        var /** @type {?} */ generatedOffset = 0;\n        if (totalKeyframesWithOffsets > 0 && totalKeyframesWithOffsets < length) {\n            context.errors.push(\"Not all style() steps within the declared keyframes() contain offsets\");\n        }\n        else if (totalKeyframesWithOffsets == 0) {\n            generatedOffset = MAX_KEYFRAME_OFFSET / (length - 1);\n        }\n        var /** @type {?} */ limit = length - 1;\n        var /** @type {?} */ currentTime = context.currentTime;\n        var /** @type {?} */ currentAnimateTimings = ((context.currentAnimateTimings));\n        var /** @type {?} */ animateDuration = currentAnimateTimings.duration;\n        keyframes.forEach(function (kf, i) {\n            var /** @type {?} */ offset = generatedOffset > 0 ? (i == limit ? 1 : (generatedOffset * i)) : offsets[i];\n            var /** @type {?} */ durationUpToThisFrame = offset * animateDuration;\n            context.currentTime = currentTime + currentAnimateTimings.delay + durationUpToThisFrame;\n            currentAnimateTimings.duration = durationUpToThisFrame;\n            _this._validateStyleAst(kf, context);\n            kf.offset = offset;\n        });\n        return new KeyframesAst(keyframes);\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitReference = function (metadata, context) {\n        var /** @type {?} */ entry = visitAnimationNode(this, normalizeAnimationEntry(metadata.animation), context);\n        var /** @type {?} */ ast = new ReferenceAst(entry);\n        ast.options = normalizeAnimationOptions(metadata.options);\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitAnimateChild = function (metadata, context) {\n        context.depCount++;\n        var /** @type {?} */ ast = new AnimateChildAst();\n        ast.options = normalizeAnimationOptions(metadata.options);\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitAnimateRef = function (metadata, context) {\n        var /** @type {?} */ animation = this.visitReference(metadata.animation, context);\n        var /** @type {?} */ ast = new AnimateRefAst(animation);\n        ast.options = normalizeAnimationOptions(metadata.options);\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitQuery = function (metadata, context) {\n        var /** @type {?} */ parentSelector = ((context.currentQuerySelector));\n        var /** @type {?} */ options = ((metadata.options || {}));\n        context.queryCount++;\n        context.currentQuery = metadata;\n        var _a = normalizeSelector(metadata.selector), selector = _a[0], includeSelf = _a[1];\n        context.currentQuerySelector =\n            parentSelector.length ? (parentSelector + ' ' + selector) : selector;\n        getOrSetAsInMap(context.collectedStyles, context.currentQuerySelector, {});\n        var /** @type {?} */ entry = visitAnimationNode(this, normalizeAnimationEntry(metadata.animation), context);\n        context.currentQuery = null;\n        context.currentQuerySelector = parentSelector;\n        var /** @type {?} */ ast = new QueryAst(selector, options.limit || 0, !!options.optional, includeSelf, entry);\n        ast.originalSelector = metadata.selector;\n        ast.options = normalizeAnimationOptions(metadata.options);\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitStagger = function (metadata, context) {\n        if (!context.currentQuery) {\n            context.errors.push(\"stagger() can only be used inside of query()\");\n        }\n        var /** @type {?} */ timings = metadata.timings === 'full' ?\n            { duration: 0, delay: 0, easing: 'full' } :\n            resolveTiming(metadata.timings, context.errors, true);\n        var /** @type {?} */ animation = visitAnimationNode(this, normalizeAnimationEntry(metadata.animation), context);\n        return new StaggerAst(timings, animation);\n    };\n    return AnimationAstBuilderVisitor;\n}());\n/**\n * @param {?} selector\n * @return {?}\n */\nfunction normalizeSelector(selector) {\n    var /** @type {?} */ hasAmpersand = selector.split(/\\s*,\\s*/).find(function (token) { return token == SELF_TOKEN; }) ? true : false;\n    if (hasAmpersand) {\n        selector = selector.replace(SELF_TOKEN_REGEX, '');\n    }\n    selector = selector.replace(ENTER_TOKEN_REGEX, ENTER_SELECTOR)\n        .replace(LEAVE_TOKEN_REGEX, LEAVE_SELECTOR)\n        .replace(/@\\*/g, NG_TRIGGER_SELECTOR)\n        .replace(/@\\w+/g, function (match) { return NG_TRIGGER_SELECTOR + '-' + match.substr(1); })\n        .replace(/:animating/g, NG_ANIMATING_SELECTOR);\n    return [selector, hasAmpersand];\n}\n/**\n * @param {?} obj\n * @return {?}\n */\nfunction normalizeParams(obj) {\n    return obj ? copyObj(obj) : null;\n}\nvar AnimationAstBuilderContext = (function () {\n    /**\n     * @param {?} errors\n     */\n    function AnimationAstBuilderContext(errors) {\n        this.errors = errors;\n        this.queryCount = 0;\n        this.depCount = 0;\n        this.currentTransition = null;\n        this.currentQuery = null;\n        this.currentQuerySelector = null;\n        this.currentAnimateTimings = null;\n        this.currentTime = 0;\n        this.collectedStyles = {};\n        this.options = null;\n    }\n    return AnimationAstBuilderContext;\n}());\n/**\n * @param {?} styles\n * @return {?}\n */\nfunction consumeOffset(styles) {\n    if (typeof styles == 'string')\n        return null;\n    var /** @type {?} */ offset = null;\n    if (Array.isArray(styles)) {\n        styles.forEach(function (styleTuple) {\n            if (isObject(styleTuple) && styleTuple.hasOwnProperty('offset')) {\n                var /** @type {?} */ obj = (styleTuple);\n                offset = parseFloat(/** @type {?} */ (obj['offset']));\n                delete obj['offset'];\n            }\n        });\n    }\n    else if (isObject(styles) && styles.hasOwnProperty('offset')) {\n        var /** @type {?} */ obj = (styles);\n        offset = parseFloat(/** @type {?} */ (obj['offset']));\n        delete obj['offset'];\n    }\n    return offset;\n}\n/**\n * @param {?} value\n * @return {?}\n */\nfunction isObject(value) {\n    return !Array.isArray(value) && typeof value == 'object';\n}\n/**\n * @param {?} value\n * @param {?} errors\n * @return {?}\n */\nfunction constructTimingAst(value, errors) {\n    var /** @type {?} */ timings = null;\n    if (value.hasOwnProperty('duration')) {\n        timings = (value);\n    }\n    else if (typeof value == 'number') {\n        var /** @type {?} */ duration = resolveTiming(/** @type {?} */ (value), errors).duration;\n        return new TimingAst(/** @type {?} */ (value), 0, '');\n    }\n    var /** @type {?} */ strValue = (value);\n    var /** @type {?} */ isDynamic = strValue.split(/\\s+/).some(function (v) { return v.charAt(0) == '{' && v.charAt(1) == '{'; });\n    if (isDynamic) {\n        return new DynamicTimingAst(strValue);\n    }\n    timings = timings || resolveTiming(strValue, errors);\n    return new TimingAst(timings.duration, timings.delay, timings.easing);\n}\n/**\n * @param {?} options\n * @return {?}\n */\nfunction normalizeAnimationOptions(options) {\n    if (options) {\n        options = copyObj(options);\n        if (options['params']) {\n            options['params'] = ((normalizeParams(options['params'])));\n        }\n    }\n    else {\n        options = {};\n    }\n    return options;\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @record\n */\n\n/**\n * @param {?} element\n * @param {?} keyframes\n * @param {?} preStyleProps\n * @param {?} postStyleProps\n * @param {?} duration\n * @param {?} delay\n * @param {?=} easing\n * @param {?=} subTimeline\n * @return {?}\n */\nfunction createTimelineInstruction(element, keyframes, preStyleProps, postStyleProps, duration, delay, easing, subTimeline) {\n    if (easing === void 0) { easing = null; }\n    if (subTimeline === void 0) { subTimeline = false; }\n    return {\n        type: 1 /* TimelineAnimation */,\n        element: element,\n        keyframes: keyframes,\n        preStyleProps: preStyleProps,\n        postStyleProps: postStyleProps,\n        duration: duration,\n        delay: delay,\n        totalTime: duration + delay, easing: easing, subTimeline: subTimeline\n    };\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar ElementInstructionMap = (function () {\n    function ElementInstructionMap() {\n        this._map = new Map();\n    }\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    ElementInstructionMap.prototype.consume = function (element) {\n        var /** @type {?} */ instructions = this._map.get(element);\n        if (instructions) {\n            this._map.delete(element);\n        }\n        else {\n            instructions = [];\n        }\n        return instructions;\n    };\n    /**\n     * @param {?} element\n     * @param {?} instructions\n     * @return {?}\n     */\n    ElementInstructionMap.prototype.append = function (element, instructions) {\n        var /** @type {?} */ existingInstructions = this._map.get(element);\n        if (!existingInstructions) {\n            this._map.set(element, existingInstructions = []);\n        }\n        existingInstructions.push.apply(existingInstructions, instructions);\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    ElementInstructionMap.prototype.has = function (element) { return this._map.has(element); };\n    /**\n     * @return {?}\n     */\n    ElementInstructionMap.prototype.clear = function () { this._map.clear(); };\n    return ElementInstructionMap;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar ONE_FRAME_IN_MILLISECONDS = 1;\n/**\n * @param {?} driver\n * @param {?} rootElement\n * @param {?} ast\n * @param {?=} startingStyles\n * @param {?=} finalStyles\n * @param {?=} options\n * @param {?=} subInstructions\n * @param {?=} errors\n * @return {?}\n */\nfunction buildAnimationTimelines(driver, rootElement, ast, startingStyles, finalStyles, options, subInstructions, errors) {\n    if (startingStyles === void 0) { startingStyles = {}; }\n    if (finalStyles === void 0) { finalStyles = {}; }\n    if (errors === void 0) { errors = []; }\n    return new AnimationTimelineBuilderVisitor().buildKeyframes(driver, rootElement, ast, startingStyles, finalStyles, options, subInstructions, errors);\n}\nvar AnimationTimelineBuilderVisitor = (function () {\n    function AnimationTimelineBuilderVisitor() {\n    }\n    /**\n     * @param {?} driver\n     * @param {?} rootElement\n     * @param {?} ast\n     * @param {?} startingStyles\n     * @param {?} finalStyles\n     * @param {?} options\n     * @param {?=} subInstructions\n     * @param {?=} errors\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.buildKeyframes = function (driver, rootElement, ast, startingStyles, finalStyles, options, subInstructions, errors) {\n        if (errors === void 0) { errors = []; }\n        subInstructions = subInstructions || new ElementInstructionMap();\n        var /** @type {?} */ context = new AnimationTimelineContext(driver, rootElement, subInstructions, errors, []);\n        context.options = options;\n        context.currentTimeline.setStyles([startingStyles], null, context.errors, options);\n        ast.visit(this, context);\n        // this checks to see if an actual animation happened\n        var /** @type {?} */ timelines = context.timelines.filter(function (timeline) { return timeline.containsAnimation(); });\n        if (timelines.length && Object.keys(finalStyles).length) {\n            var /** @type {?} */ tl = timelines[timelines.length - 1];\n            if (!tl.allowOnlyTimelineStyles()) {\n                tl.setStyles([finalStyles], null, context.errors, options);\n            }\n        }\n        return timelines.length ? timelines.map(function (timeline) { return timeline.buildKeyframes(); }) :\n            [createTimelineInstruction(rootElement, [], [], [], 0, 0, '', false)];\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitTrigger = function (ast, context) {\n        // these values are not visited in this AST\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitState = function (ast, context) {\n        // these values are not visited in this AST\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitTransition = function (ast, context) {\n        // these values are not visited in this AST\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitAnimateChild = function (ast, context) {\n        var /** @type {?} */ elementInstructions = context.subInstructions.consume(context.element);\n        if (elementInstructions) {\n            var /** @type {?} */ innerContext = context.createSubContext(ast.options);\n            var /** @type {?} */ startTime = context.currentTimeline.currentTime;\n            var /** @type {?} */ endTime = this._visitSubInstructions(elementInstructions, innerContext, /** @type {?} */ (innerContext.options));\n            if (startTime != endTime) {\n                // we do this on the upper context because we created a sub context for\n                // the sub child animations\n                context.transformIntoNewTimeline(endTime);\n            }\n        }\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitAnimateRef = function (ast, context) {\n        var /** @type {?} */ innerContext = context.createSubContext(ast.options);\n        innerContext.transformIntoNewTimeline();\n        this.visitReference(ast.animation, innerContext);\n        context.transformIntoNewTimeline(innerContext.currentTimeline.currentTime);\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} instructions\n     * @param {?} context\n     * @param {?} options\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype._visitSubInstructions = function (instructions, context, options) {\n        var /** @type {?} */ startTime = context.currentTimeline.currentTime;\n        var /** @type {?} */ furthestTime = startTime;\n        // this is a special-case for when a user wants to skip a sub\n        // animation from being fired entirely.\n        var /** @type {?} */ duration = options.duration != null ? resolveTimingValue(options.duration) : null;\n        var /** @type {?} */ delay = options.delay != null ? resolveTimingValue(options.delay) : null;\n        if (duration !== 0) {\n            instructions.forEach(function (instruction) {\n                var /** @type {?} */ instructionTimings = context.appendInstructionToTimeline(instruction, duration, delay);\n                furthestTime =\n                    Math.max(furthestTime, instructionTimings.duration + instructionTimings.delay);\n            });\n        }\n        return furthestTime;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitReference = function (ast, context) {\n        context.updateOptions(ast.options, true);\n        ast.animation.visit(this, context);\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitSequence = function (ast, context) {\n        var _this = this;\n        var /** @type {?} */ subContextCount = context.subContextCount;\n        var /** @type {?} */ ctx = context;\n        var /** @type {?} */ options = ast.options;\n        if (options && (options.params || options.delay)) {\n            ctx = context.createSubContext(options);\n            ctx.transformIntoNewTimeline();\n            if (options.delay != null) {\n                if (ctx.previousNode instanceof StyleAst) {\n                    ctx.currentTimeline.snapshotCurrentStyles();\n                    ctx.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;\n                }\n                var /** @type {?} */ delay = resolveTimingValue(options.delay);\n                ctx.delayNextStep(delay);\n            }\n        }\n        if (ast.steps.length) {\n            ast.steps.forEach(function (s) { return s.visit(_this, ctx); });\n            // this is here just incase the inner steps only contain or end with a style() call\n            ctx.currentTimeline.applyStylesToKeyframe();\n            // this means that some animation function within the sequence\n            // ended up creating a sub timeline (which means the current\n            // timeline cannot overlap with the contents of the sequence)\n            if (ctx.subContextCount > subContextCount) {\n                ctx.transformIntoNewTimeline();\n            }\n        }\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitGroup = function (ast, context) {\n        var _this = this;\n        var /** @type {?} */ innerTimelines = [];\n        var /** @type {?} */ furthestTime = context.currentTimeline.currentTime;\n        var /** @type {?} */ delay = ast.options && ast.options.delay ? resolveTimingValue(ast.options.delay) : 0;\n        ast.steps.forEach(function (s) {\n            var /** @type {?} */ innerContext = context.createSubContext(ast.options);\n            if (delay) {\n                innerContext.delayNextStep(delay);\n            }\n            s.visit(_this, innerContext);\n            furthestTime = Math.max(furthestTime, innerContext.currentTimeline.currentTime);\n            innerTimelines.push(innerContext.currentTimeline);\n        });\n        // this operation is run after the AST loop because otherwise\n        // if the parent timeline's collected styles were updated then\n        // it would pass in invalid data into the new-to-be forked items\n        innerTimelines.forEach(function (timeline) { return context.currentTimeline.mergeTimelineCollectedStyles(timeline); });\n        context.transformIntoNewTimeline(furthestTime);\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitTiming = function (ast, context) {\n        if (ast instanceof DynamicTimingAst) {\n            var /** @type {?} */ strValue = context.params ?\n                interpolateParams(ast.value, context.params, context.errors) :\n                ast.value.toString();\n            return resolveTiming(strValue, context.errors);\n        }\n        else {\n            return { duration: ast.duration, delay: ast.delay, easing: ast.easing };\n        }\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitAnimate = function (ast, context) {\n        var /** @type {?} */ timings = context.currentAnimateTimings = this.visitTiming(ast.timings, context);\n        var /** @type {?} */ timeline = context.currentTimeline;\n        if (timings.delay) {\n            context.incrementTime(timings.delay);\n            timeline.snapshotCurrentStyles();\n        }\n        var /** @type {?} */ style$$1 = ast.style;\n        if (style$$1 instanceof KeyframesAst) {\n            this.visitKeyframes(style$$1, context);\n        }\n        else {\n            context.incrementTime(timings.duration);\n            this.visitStyle(/** @type {?} */ (style$$1), context);\n            timeline.applyStylesToKeyframe();\n        }\n        context.currentAnimateTimings = null;\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitStyle = function (ast, context) {\n        var /** @type {?} */ timeline = context.currentTimeline;\n        var /** @type {?} */ timings = ((context.currentAnimateTimings));\n        // this is a special case for when a style() call\n        // directly follows  an animate() call (but not inside of an animate() call)\n        if (!timings && timeline.getCurrentStyleProperties().length) {\n            timeline.forwardFrame();\n        }\n        var /** @type {?} */ easing = (timings && timings.easing) || ast.easing;\n        if (ast.isEmptyStep) {\n            timeline.applyEmptyStep(easing);\n        }\n        else {\n            timeline.setStyles(ast.styles, easing, context.errors, context.options);\n        }\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitKeyframes = function (ast, context) {\n        var /** @type {?} */ currentAnimateTimings = ((context.currentAnimateTimings));\n        var /** @type {?} */ startTime = (((context.currentTimeline))).duration;\n        var /** @type {?} */ duration = currentAnimateTimings.duration;\n        var /** @type {?} */ innerContext = context.createSubContext();\n        var /** @type {?} */ innerTimeline = innerContext.currentTimeline;\n        innerTimeline.easing = currentAnimateTimings.easing;\n        ast.styles.forEach(function (step) {\n            var /** @type {?} */ offset = step.offset || 0;\n            innerTimeline.forwardTime(offset * duration);\n            innerTimeline.setStyles(step.styles, step.easing, context.errors, context.options);\n            innerTimeline.applyStylesToKeyframe();\n        });\n        // this will ensure that the parent timeline gets all the styles from\n        // the child even if the new timeline below is not used\n        context.currentTimeline.mergeTimelineCollectedStyles(innerTimeline);\n        // we do this because the window between this timeline and the sub timeline\n        // should ensure that the styles within are exactly the same as they were before\n        context.transformIntoNewTimeline(startTime + duration);\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitQuery = function (ast, context) {\n        var _this = this;\n        // in the event that the first step before this is a style step we need\n        // to ensure the styles are applied before the children are animated\n        var /** @type {?} */ startTime = context.currentTimeline.currentTime;\n        var /** @type {?} */ options = ((ast.options || {}));\n        var /** @type {?} */ delay = options.delay ? resolveTimingValue(options.delay) : 0;\n        if (delay && (context.previousNode instanceof StyleAst ||\n            (startTime == 0 && context.currentTimeline.getCurrentStyleProperties().length))) {\n            context.currentTimeline.snapshotCurrentStyles();\n            context.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;\n        }\n        var /** @type {?} */ furthestTime = startTime;\n        var /** @type {?} */ elms = context.invokeQuery(ast.selector, ast.originalSelector, ast.limit, ast.includeSelf, options.optional ? true : false, context.errors);\n        context.currentQueryTotal = elms.length;\n        var /** @type {?} */ sameElementTimeline = null;\n        elms.forEach(function (element, i) {\n            context.currentQueryIndex = i;\n            var /** @type {?} */ innerContext = context.createSubContext(ast.options, element);\n            if (delay) {\n                innerContext.delayNextStep(delay);\n            }\n            if (element === context.element) {\n                sameElementTimeline = innerContext.currentTimeline;\n            }\n            ast.animation.visit(_this, innerContext);\n            // this is here just incase the inner steps only contain or end\n            // with a style() call (which is here to signal that this is a preparatory\n            // call to style an element before it is animated again)\n            innerContext.currentTimeline.applyStylesToKeyframe();\n            var /** @type {?} */ endTime = innerContext.currentTimeline.currentTime;\n            furthestTime = Math.max(furthestTime, endTime);\n        });\n        context.currentQueryIndex = 0;\n        context.currentQueryTotal = 0;\n        context.transformIntoNewTimeline(furthestTime);\n        if (sameElementTimeline) {\n            context.currentTimeline.mergeTimelineCollectedStyles(sameElementTimeline);\n            context.currentTimeline.snapshotCurrentStyles();\n        }\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitStagger = function (ast, context) {\n        var /** @type {?} */ parentContext = ((context.parentContext));\n        var /** @type {?} */ tl = context.currentTimeline;\n        var /** @type {?} */ timings = ast.timings;\n        var /** @type {?} */ duration = Math.abs(timings.duration);\n        var /** @type {?} */ maxTime = duration * (context.currentQueryTotal - 1);\n        var /** @type {?} */ delay = duration * context.currentQueryIndex;\n        var /** @type {?} */ staggerTransformer = timings.duration < 0 ? 'reverse' : timings.easing;\n        switch (staggerTransformer) {\n            case 'reverse':\n                delay = maxTime - delay;\n                break;\n            case 'full':\n                delay = parentContext.currentStaggerTime;\n                break;\n        }\n        var /** @type {?} */ timeline = context.currentTimeline;\n        if (delay) {\n            timeline.delayNextStep(delay);\n        }\n        var /** @type {?} */ startingTime = timeline.currentTime;\n        ast.animation.visit(this, context);\n        context.previousNode = ast;\n        // time = duration + delay\n        // the reason why this computation is so complex is because\n        // the inner timeline may either have a delay value or a stretched\n        // keyframe depending on if a subtimeline is not used or is used.\n        parentContext.currentStaggerTime =\n            (tl.currentTime - startingTime) + (tl.startTime - parentContext.currentTimeline.startTime);\n    };\n    return AnimationTimelineBuilderVisitor;\n}());\nvar DEFAULT_NOOP_PREVIOUS_NODE = ({});\nvar AnimationTimelineContext = (function () {\n    /**\n     * @param {?} _driver\n     * @param {?} element\n     * @param {?} subInstructions\n     * @param {?} errors\n     * @param {?} timelines\n     * @param {?=} initialTimeline\n     */\n    function AnimationTimelineContext(_driver, element, subInstructions, errors, timelines, initialTimeline) {\n        this._driver = _driver;\n        this.element = element;\n        this.subInstructions = subInstructions;\n        this.errors = errors;\n        this.timelines = timelines;\n        this.parentContext = null;\n        this.currentAnimateTimings = null;\n        this.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;\n        this.subContextCount = 0;\n        this.options = {};\n        this.currentQueryIndex = 0;\n        this.currentQueryTotal = 0;\n        this.currentStaggerTime = 0;\n        this.currentTimeline = initialTimeline || new TimelineBuilder(element, 0);\n        timelines.push(this.currentTimeline);\n    }\n    Object.defineProperty(AnimationTimelineContext.prototype, \"params\", {\n        /**\n         * @return {?}\n         */\n        get: function () { return this.options.params; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} options\n     * @param {?=} skipIfExists\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.updateOptions = function (options, skipIfExists) {\n        var _this = this;\n        if (!options)\n            return;\n        var /** @type {?} */ newOptions = (options);\n        var /** @type {?} */ optionsToUpdate = this.options;\n        // NOTE: this will get patched up when other animation methods support duration overrides\n        if (newOptions.duration != null) {\n            ((optionsToUpdate)).duration = resolveTimingValue(newOptions.duration);\n        }\n        if (newOptions.delay != null) {\n            optionsToUpdate.delay = resolveTimingValue(newOptions.delay);\n        }\n        var /** @type {?} */ newParams = newOptions.params;\n        if (newParams) {\n            var /** @type {?} */ paramsToUpdate_1 = ((optionsToUpdate.params));\n            if (!paramsToUpdate_1) {\n                paramsToUpdate_1 = this.options.params = {};\n            }\n            Object.keys(newParams).forEach(function (name) {\n                if (!skipIfExists || !paramsToUpdate_1.hasOwnProperty(name)) {\n                    paramsToUpdate_1[name] = interpolateParams(newParams[name], paramsToUpdate_1, _this.errors);\n                }\n            });\n        }\n    };\n    /**\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype._copyOptions = function () {\n        var /** @type {?} */ options = {};\n        if (this.options) {\n            var /** @type {?} */ oldParams_1 = this.options.params;\n            if (oldParams_1) {\n                var /** @type {?} */ params_1 = options['params'] = {};\n                Object.keys(this.options.params).forEach(function (name) { params_1[name] = oldParams_1[name]; });\n            }\n        }\n        return options;\n    };\n    /**\n     * @param {?=} options\n     * @param {?=} element\n     * @param {?=} newTime\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.createSubContext = function (options, element, newTime) {\n        if (options === void 0) { options = null; }\n        var /** @type {?} */ target = element || this.element;\n        var /** @type {?} */ context = new AnimationTimelineContext(this._driver, target, this.subInstructions, this.errors, this.timelines, this.currentTimeline.fork(target, newTime || 0));\n        context.previousNode = this.previousNode;\n        context.currentAnimateTimings = this.currentAnimateTimings;\n        context.options = this._copyOptions();\n        context.updateOptions(options);\n        context.currentQueryIndex = this.currentQueryIndex;\n        context.currentQueryTotal = this.currentQueryTotal;\n        context.parentContext = this;\n        this.subContextCount++;\n        return context;\n    };\n    /**\n     * @param {?=} newTime\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.transformIntoNewTimeline = function (newTime) {\n        this.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;\n        this.currentTimeline = this.currentTimeline.fork(this.element, newTime);\n        this.timelines.push(this.currentTimeline);\n        return this.currentTimeline;\n    };\n    /**\n     * @param {?} instruction\n     * @param {?} duration\n     * @param {?} delay\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.appendInstructionToTimeline = function (instruction, duration, delay) {\n        var /** @type {?} */ updatedTimings = {\n            duration: duration != null ? duration : instruction.duration,\n            delay: this.currentTimeline.currentTime + (delay != null ? delay : 0) + instruction.delay,\n            easing: ''\n        };\n        var /** @type {?} */ builder = new SubTimelineBuilder(instruction.element, instruction.keyframes, instruction.preStyleProps, instruction.postStyleProps, updatedTimings, instruction.stretchStartingKeyframe);\n        this.timelines.push(builder);\n        return updatedTimings;\n    };\n    /**\n     * @param {?} time\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.incrementTime = function (time) {\n        this.currentTimeline.forwardTime(this.currentTimeline.duration + time);\n    };\n    /**\n     * @param {?} delay\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.delayNextStep = function (delay) {\n        // negative delays are not yet supported\n        if (delay > 0) {\n            this.currentTimeline.delayNextStep(delay);\n        }\n    };\n    /**\n     * @param {?} selector\n     * @param {?} originalSelector\n     * @param {?} limit\n     * @param {?} includeSelf\n     * @param {?} optional\n     * @param {?} errors\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.invokeQuery = function (selector, originalSelector, limit, includeSelf, optional, errors) {\n        var /** @type {?} */ results = [];\n        if (includeSelf) {\n            results.push(this.element);\n        }\n        if (selector.length > 0) {\n            var /** @type {?} */ multi = limit != 1;\n            results.push.apply(results, this._driver.query(this.element, selector, multi));\n        }\n        if (!optional && results.length == 0) {\n            errors.push(\"`query(\\\"\" + originalSelector + \"\\\")` returned zero elements. (Use `query(\\\"\" + originalSelector + \"\\\", { optional: true })` if you wish to allow this.)\");\n        }\n        return results;\n    };\n    return AnimationTimelineContext;\n}());\nvar TimelineBuilder = (function () {\n    /**\n     * @param {?} element\n     * @param {?} startTime\n     * @param {?=} _elementTimelineStylesLookup\n     */\n    function TimelineBuilder(element, startTime, _elementTimelineStylesLookup) {\n        this.element = element;\n        this.startTime = startTime;\n        this._elementTimelineStylesLookup = _elementTimelineStylesLookup;\n        this.duration = 0;\n        this._previousKeyframe = {};\n        this._currentKeyframe = {};\n        this._keyframes = new Map();\n        this._styleSummary = {};\n        this._pendingStyles = {};\n        this._backFill = {};\n        this._currentEmptyStepKeyframe = null;\n        if (!this._elementTimelineStylesLookup) {\n            this._elementTimelineStylesLookup = new Map();\n        }\n        this._localTimelineStyles = Object.create(this._backFill, {});\n        this._globalTimelineStyles = ((this._elementTimelineStylesLookup.get(element)));\n        if (!this._globalTimelineStyles) {\n            this._globalTimelineStyles = this._localTimelineStyles;\n            this._elementTimelineStylesLookup.set(element, this._localTimelineStyles);\n        }\n        this._loadKeyframe();\n    }\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.containsAnimation = function () {\n        switch (this._keyframes.size) {\n            case 0:\n                return false;\n            case 1:\n                return this.getCurrentStyleProperties().length > 0;\n            default:\n                return true;\n        }\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.getCurrentStyleProperties = function () { return Object.keys(this._currentKeyframe); };\n    Object.defineProperty(TimelineBuilder.prototype, \"currentTime\", {\n        /**\n         * @return {?}\n         */\n        get: function () { return this.startTime + this.duration; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} delay\n     * @return {?}\n     */\n    TimelineBuilder.prototype.delayNextStep = function (delay) {\n        // in the event that a style() step is placed right before a stagger()\n        // and that style() step is the very first style() value in the animation\n        // then we need to make a copy of the keyframe [0, copy, 1] so that the delay\n        // properly applies the style() values to work with the stagger...\n        var /** @type {?} */ hasPreStyleStep = this._keyframes.size == 1 && Object.keys(this._pendingStyles).length;\n        if (this.duration || hasPreStyleStep) {\n            this.forwardTime(this.currentTime + delay);\n            if (hasPreStyleStep) {\n                this.snapshotCurrentStyles();\n            }\n        }\n        else {\n            this.startTime += delay;\n        }\n    };\n    /**\n     * @param {?} element\n     * @param {?=} currentTime\n     * @return {?}\n     */\n    TimelineBuilder.prototype.fork = function (element, currentTime) {\n        this.applyStylesToKeyframe();\n        return new TimelineBuilder(element, currentTime || this.currentTime, this._elementTimelineStylesLookup);\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype._loadKeyframe = function () {\n        if (this._currentKeyframe) {\n            this._previousKeyframe = this._currentKeyframe;\n        }\n        this._currentKeyframe = ((this._keyframes.get(this.duration)));\n        if (!this._currentKeyframe) {\n            this._currentKeyframe = Object.create(this._backFill, {});\n            this._keyframes.set(this.duration, this._currentKeyframe);\n        }\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.forwardFrame = function () {\n        this.duration += ONE_FRAME_IN_MILLISECONDS;\n        this._loadKeyframe();\n    };\n    /**\n     * @param {?} time\n     * @return {?}\n     */\n    TimelineBuilder.prototype.forwardTime = function (time) {\n        this.applyStylesToKeyframe();\n        this.duration = time;\n        this._loadKeyframe();\n    };\n    /**\n     * @param {?} prop\n     * @param {?} value\n     * @return {?}\n     */\n    TimelineBuilder.prototype._updateStyle = function (prop, value) {\n        this._localTimelineStyles[prop] = value;\n        this._globalTimelineStyles[prop] = value;\n        this._styleSummary[prop] = { time: this.currentTime, value: value };\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.allowOnlyTimelineStyles = function () { return this._currentEmptyStepKeyframe !== this._currentKeyframe; };\n    /**\n     * @param {?} easing\n     * @return {?}\n     */\n    TimelineBuilder.prototype.applyEmptyStep = function (easing) {\n        var _this = this;\n        if (easing) {\n            this._previousKeyframe['easing'] = easing;\n        }\n        // special case for animate(duration):\n        // all missing styles are filled with a `*` value then\n        // if any destination styles are filled in later on the same\n        // keyframe then they will override the overridden styles\n        // We use `_globalTimelineStyles` here because there may be\n        // styles in previous keyframes that are not present in this timeline\n        Object.keys(this._globalTimelineStyles).forEach(function (prop) {\n            _this._backFill[prop] = _this._globalTimelineStyles[prop] || _angular_animations.AUTO_STYLE;\n            _this._currentKeyframe[prop] = _angular_animations.AUTO_STYLE;\n        });\n        this._currentEmptyStepKeyframe = this._currentKeyframe;\n    };\n    /**\n     * @param {?} input\n     * @param {?} easing\n     * @param {?} errors\n     * @param {?=} options\n     * @return {?}\n     */\n    TimelineBuilder.prototype.setStyles = function (input, easing, errors, options) {\n        var _this = this;\n        if (easing) {\n            this._previousKeyframe['easing'] = easing;\n        }\n        var /** @type {?} */ params = (options && options.params) || {};\n        var /** @type {?} */ styles = flattenStyles(input, this._globalTimelineStyles);\n        Object.keys(styles).forEach(function (prop) {\n            var /** @type {?} */ val = interpolateParams(styles[prop], params, errors);\n            _this._pendingStyles[prop] = val;\n            if (!_this._localTimelineStyles.hasOwnProperty(prop)) {\n                _this._backFill[prop] = _this._globalTimelineStyles.hasOwnProperty(prop) ?\n                    _this._globalTimelineStyles[prop] :\n                    _angular_animations.AUTO_STYLE;\n            }\n            _this._updateStyle(prop, val);\n        });\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.applyStylesToKeyframe = function () {\n        var _this = this;\n        var /** @type {?} */ styles = this._pendingStyles;\n        var /** @type {?} */ props = Object.keys(styles);\n        if (props.length == 0)\n            return;\n        this._pendingStyles = {};\n        props.forEach(function (prop) {\n            var /** @type {?} */ val = styles[prop];\n            _this._currentKeyframe[prop] = val;\n        });\n        Object.keys(this._localTimelineStyles).forEach(function (prop) {\n            if (!_this._currentKeyframe.hasOwnProperty(prop)) {\n                _this._currentKeyframe[prop] = _this._localTimelineStyles[prop];\n            }\n        });\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.snapshotCurrentStyles = function () {\n        var _this = this;\n        Object.keys(this._localTimelineStyles).forEach(function (prop) {\n            var /** @type {?} */ val = _this._localTimelineStyles[prop];\n            _this._pendingStyles[prop] = val;\n            _this._updateStyle(prop, val);\n        });\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.getFinalKeyframe = function () { return this._keyframes.get(this.duration); };\n    Object.defineProperty(TimelineBuilder.prototype, \"properties\", {\n        /**\n         * @return {?}\n         */\n        get: function () {\n            var /** @type {?} */ properties = [];\n            for (var /** @type {?} */ prop in this._currentKeyframe) {\n                properties.push(prop);\n            }\n            return properties;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} timeline\n     * @return {?}\n     */\n    TimelineBuilder.prototype.mergeTimelineCollectedStyles = function (timeline) {\n        var _this = this;\n        Object.keys(timeline._styleSummary).forEach(function (prop) {\n            var /** @type {?} */ details0 = _this._styleSummary[prop];\n            var /** @type {?} */ details1 = timeline._styleSummary[prop];\n            if (!details0 || details1.time > details0.time) {\n                _this._updateStyle(prop, details1.value);\n            }\n        });\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.buildKeyframes = function () {\n        var _this = this;\n        this.applyStylesToKeyframe();\n        var /** @type {?} */ preStyleProps = new Set();\n        var /** @type {?} */ postStyleProps = new Set();\n        var /** @type {?} */ isEmpty = this._keyframes.size === 1 && this.duration === 0;\n        var /** @type {?} */ finalKeyframes = [];\n        this._keyframes.forEach(function (keyframe, time) {\n            var /** @type {?} */ finalKeyframe = copyStyles(keyframe, true);\n            Object.keys(finalKeyframe).forEach(function (prop) {\n                var /** @type {?} */ value = finalKeyframe[prop];\n                if (value == _angular_animations.ɵPRE_STYLE) {\n                    preStyleProps.add(prop);\n                }\n                else if (value == _angular_animations.AUTO_STYLE) {\n                    postStyleProps.add(prop);\n                }\n            });\n            if (!isEmpty) {\n                finalKeyframe['offset'] = time / _this.duration;\n            }\n            finalKeyframes.push(finalKeyframe);\n        });\n        var /** @type {?} */ preProps = preStyleProps.size ? iteratorToArray(preStyleProps.values()) : [];\n        var /** @type {?} */ postProps = postStyleProps.size ? iteratorToArray(postStyleProps.values()) : [];\n        // special case for a 0-second animation (which is designed just to place styles onscreen)\n        if (isEmpty) {\n            var /** @type {?} */ kf0 = finalKeyframes[0];\n            var /** @type {?} */ kf1 = copyObj(kf0);\n            kf0['offset'] = 0;\n            kf1['offset'] = 1;\n            finalKeyframes = [kf0, kf1];\n        }\n        return createTimelineInstruction(this.element, finalKeyframes, preProps, postProps, this.duration, this.startTime, this.easing, false);\n    };\n    return TimelineBuilder;\n}());\nvar SubTimelineBuilder = (function (_super) {\n    __extends(SubTimelineBuilder, _super);\n    /**\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} preStyleProps\n     * @param {?} postStyleProps\n     * @param {?} timings\n     * @param {?=} _stretchStartingKeyframe\n     */\n    function SubTimelineBuilder(element, keyframes, preStyleProps, postStyleProps, timings, _stretchStartingKeyframe) {\n        if (_stretchStartingKeyframe === void 0) { _stretchStartingKeyframe = false; }\n        var _this = _super.call(this, element, timings.delay) || this;\n        _this.element = element;\n        _this.keyframes = keyframes;\n        _this.preStyleProps = preStyleProps;\n        _this.postStyleProps = postStyleProps;\n        _this._stretchStartingKeyframe = _stretchStartingKeyframe;\n        _this.timings = { duration: timings.duration, delay: timings.delay, easing: timings.easing };\n        return _this;\n    }\n    /**\n     * @return {?}\n     */\n    SubTimelineBuilder.prototype.containsAnimation = function () { return this.keyframes.length > 1; };\n    /**\n     * @return {?}\n     */\n    SubTimelineBuilder.prototype.buildKeyframes = function () {\n        var /** @type {?} */ keyframes = this.keyframes;\n        var _a = this.timings, delay = _a.delay, duration = _a.duration, easing = _a.easing;\n        if (this._stretchStartingKeyframe && delay) {\n            var /** @type {?} */ newKeyframes = [];\n            var /** @type {?} */ totalTime = duration + delay;\n            var /** @type {?} */ startingGap = delay / totalTime;\n            // the original starting keyframe now starts once the delay is done\n            var /** @type {?} */ newFirstKeyframe = copyStyles(keyframes[0], false);\n            newFirstKeyframe['offset'] = 0;\n            newKeyframes.push(newFirstKeyframe);\n            var /** @type {?} */ oldFirstKeyframe = copyStyles(keyframes[0], false);\n            oldFirstKeyframe['offset'] = roundOffset(startingGap);\n            newKeyframes.push(oldFirstKeyframe);\n            /*\n              When the keyframe is stretched then it means that the delay before the animation\n              starts is gone. Instead the first keyframe is placed at the start of the animation\n              and it is then copied to where it starts when the original delay is over. This basically\n              means nothing animates during that delay, but the styles are still renderered. For this\n              to work the original offset values that exist in the original keyframes must be \"warped\"\n              so that they can take the new keyframe + delay into account.\n      \n              delay=1000, duration=1000, keyframes = 0 .5 1\n      \n              turns into\n      \n              delay=0, duration=2000, keyframes = 0 .33 .66 1\n             */\n            // offsets between 1 ... n -1 are all warped by the keyframe stretch\n            var /** @type {?} */ limit = keyframes.length - 1;\n            for (var /** @type {?} */ i = 1; i <= limit; i++) {\n                var /** @type {?} */ kf = copyStyles(keyframes[i], false);\n                var /** @type {?} */ oldOffset = (kf['offset']);\n                var /** @type {?} */ timeAtKeyframe = delay + oldOffset * duration;\n                kf['offset'] = roundOffset(timeAtKeyframe / totalTime);\n                newKeyframes.push(kf);\n            }\n            // the new starting keyframe should be added at the start\n            duration = totalTime;\n            delay = 0;\n            easing = '';\n            keyframes = newKeyframes;\n        }\n        return createTimelineInstruction(this.element, keyframes, this.preStyleProps, this.postStyleProps, duration, delay, easing, true);\n    };\n    return SubTimelineBuilder;\n}(TimelineBuilder));\n/**\n * @param {?} offset\n * @param {?=} decimalPoints\n * @return {?}\n */\nfunction roundOffset(offset, decimalPoints) {\n    if (decimalPoints === void 0) { decimalPoints = 3; }\n    var /** @type {?} */ mult = Math.pow(10, decimalPoints - 1);\n    return Math.round(offset * mult) / mult;\n}\n/**\n * @param {?} input\n * @param {?} allStyles\n * @return {?}\n */\nfunction flattenStyles(input, allStyles) {\n    var /** @type {?} */ styles = {};\n    var /** @type {?} */ allProperties;\n    input.forEach(function (token) {\n        if (token === '*') {\n            allProperties = allProperties || Object.keys(allStyles);\n            allProperties.forEach(function (prop) { styles[prop] = _angular_animations.AUTO_STYLE; });\n        }\n        else {\n            copyStyles(/** @type {?} */ (token), false, styles);\n        }\n    });\n    return styles;\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar Animation = (function () {\n    /**\n     * @param {?} _driver\n     * @param {?} input\n     */\n    function Animation(_driver, input) {\n        this._driver = _driver;\n        var /** @type {?} */ errors = [];\n        var /** @type {?} */ ast = buildAnimationAst(input, errors);\n        if (errors.length) {\n            var /** @type {?} */ errorMessage = \"animation validation failed:\\n\" + errors.join(\"\\n\");\n            throw new Error(errorMessage);\n        }\n        this._animationAst = ast;\n    }\n    /**\n     * @param {?} element\n     * @param {?} startingStyles\n     * @param {?} destinationStyles\n     * @param {?} options\n     * @param {?=} subInstructions\n     * @return {?}\n     */\n    Animation.prototype.buildTimelines = function (element, startingStyles, destinationStyles, options, subInstructions) {\n        var /** @type {?} */ start = Array.isArray(startingStyles) ? normalizeStyles(startingStyles) : (startingStyles);\n        var /** @type {?} */ dest = Array.isArray(destinationStyles) ? normalizeStyles(destinationStyles) : (destinationStyles);\n        var /** @type {?} */ errors = [];\n        subInstructions = subInstructions || new ElementInstructionMap();\n        var /** @type {?} */ result = buildAnimationTimelines(this._driver, element, this._animationAst, start, dest, options, subInstructions, errors);\n        if (errors.length) {\n            var /** @type {?} */ errorMessage = \"animation building failed:\\n\" + errors.join(\"\\n\");\n            throw new Error(errorMessage);\n        }\n        return result;\n    };\n    return Animation;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * \\@experimental Animation support is experimental.\n * @abstract\n */\nvar AnimationStyleNormalizer = (function () {\n    function AnimationStyleNormalizer() {\n    }\n    return AnimationStyleNormalizer;\n}());\n/**\n * \\@experimental Animation support is experimental.\n */\nvar NoopAnimationStyleNormalizer = (function () {\n    function NoopAnimationStyleNormalizer() {\n    }\n    /**\n     * @param {?} propertyName\n     * @param {?} errors\n     * @return {?}\n     */\n    NoopAnimationStyleNormalizer.prototype.normalizePropertyName = function (propertyName, errors) { return propertyName; };\n    /**\n     * @param {?} userProvidedProperty\n     * @param {?} normalizedProperty\n     * @param {?} value\n     * @param {?} errors\n     * @return {?}\n     */\n    NoopAnimationStyleNormalizer.prototype.normalizeStyleValue = function (userProvidedProperty, normalizedProperty, value, errors) {\n        return (value);\n    };\n    return NoopAnimationStyleNormalizer;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar WebAnimationsStyleNormalizer = (function (_super) {\n    __extends(WebAnimationsStyleNormalizer, _super);\n    function WebAnimationsStyleNormalizer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * @param {?} propertyName\n     * @param {?} errors\n     * @return {?}\n     */\n    WebAnimationsStyleNormalizer.prototype.normalizePropertyName = function (propertyName, errors) {\n        return dashCaseToCamelCase(propertyName);\n    };\n    /**\n     * @param {?} userProvidedProperty\n     * @param {?} normalizedProperty\n     * @param {?} value\n     * @param {?} errors\n     * @return {?}\n     */\n    WebAnimationsStyleNormalizer.prototype.normalizeStyleValue = function (userProvidedProperty, normalizedProperty, value, errors) {\n        var /** @type {?} */ unit = '';\n        var /** @type {?} */ strVal = value.toString().trim();\n        if (DIMENSIONAL_PROP_MAP[normalizedProperty] && value !== 0 && value !== '0') {\n            if (typeof value === 'number') {\n                unit = 'px';\n            }\n            else {\n                var /** @type {?} */ valAndSuffixMatch = value.match(/^[+-]?[\\d\\.]+([a-z]*)$/);\n                if (valAndSuffixMatch && valAndSuffixMatch[1].length == 0) {\n                    errors.push(\"Please provide a CSS unit value for \" + userProvidedProperty + \":\" + value);\n                }\n            }\n        }\n        return strVal + unit;\n    };\n    return WebAnimationsStyleNormalizer;\n}(AnimationStyleNormalizer));\nvar DIMENSIONAL_PROP_MAP = makeBooleanMap('width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective'\n    .split(','));\n/**\n * @param {?} keys\n * @return {?}\n */\nfunction makeBooleanMap(keys) {\n    var /** @type {?} */ map = {};\n    keys.forEach(function (key) { return map[key] = true; });\n    return map;\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @record\n */\n\n/**\n * @param {?} element\n * @param {?} triggerName\n * @param {?} fromState\n * @param {?} toState\n * @param {?} isRemovalTransition\n * @param {?} fromStyles\n * @param {?} toStyles\n * @param {?} timelines\n * @param {?} queriedElements\n * @param {?} preStyleProps\n * @param {?} postStyleProps\n * @param {?=} errors\n * @return {?}\n */\nfunction createTransitionInstruction(element, triggerName, fromState, toState, isRemovalTransition, fromStyles, toStyles, timelines, queriedElements, preStyleProps, postStyleProps, errors) {\n    return {\n        type: 0 /* TransitionAnimation */,\n        element: element,\n        triggerName: triggerName,\n        isRemovalTransition: isRemovalTransition,\n        fromState: fromState,\n        fromStyles: fromStyles,\n        toState: toState,\n        toStyles: toStyles,\n        timelines: timelines,\n        queriedElements: queriedElements,\n        preStyleProps: preStyleProps,\n        postStyleProps: postStyleProps,\n        errors: errors\n    };\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar EMPTY_OBJECT = {};\nvar AnimationTransitionFactory = (function () {\n    /**\n     * @param {?} _triggerName\n     * @param {?} ast\n     * @param {?} _stateStyles\n     */\n    function AnimationTransitionFactory(_triggerName, ast, _stateStyles) {\n        this._triggerName = _triggerName;\n        this.ast = ast;\n        this._stateStyles = _stateStyles;\n    }\n    /**\n     * @param {?} currentState\n     * @param {?} nextState\n     * @return {?}\n     */\n    AnimationTransitionFactory.prototype.match = function (currentState, nextState) {\n        return oneOrMoreTransitionsMatch(this.ast.matchers, currentState, nextState);\n    };\n    /**\n     * @param {?} stateName\n     * @param {?} params\n     * @param {?} errors\n     * @return {?}\n     */\n    AnimationTransitionFactory.prototype.buildStyles = function (stateName, params, errors) {\n        var /** @type {?} */ backupStateStyler = this._stateStyles['*'];\n        var /** @type {?} */ stateStyler = this._stateStyles[stateName];\n        var /** @type {?} */ backupStyles = backupStateStyler ? backupStateStyler.buildStyles(params, errors) : {};\n        return stateStyler ? stateStyler.buildStyles(params, errors) : backupStyles;\n    };\n    /**\n     * @param {?} driver\n     * @param {?} element\n     * @param {?} currentState\n     * @param {?} nextState\n     * @param {?=} currentOptions\n     * @param {?=} nextOptions\n     * @param {?=} subInstructions\n     * @return {?}\n     */\n    AnimationTransitionFactory.prototype.build = function (driver, element, currentState, nextState, currentOptions, nextOptions, subInstructions) {\n        var /** @type {?} */ errors = [];\n        var /** @type {?} */ transitionAnimationParams = this.ast.options && this.ast.options.params || EMPTY_OBJECT;\n        var /** @type {?} */ currentAnimationParams = currentOptions && currentOptions.params || EMPTY_OBJECT;\n        var /** @type {?} */ currentStateStyles = this.buildStyles(currentState, currentAnimationParams, errors);\n        var /** @type {?} */ nextAnimationParams = nextOptions && nextOptions.params || EMPTY_OBJECT;\n        var /** @type {?} */ nextStateStyles = this.buildStyles(nextState, nextAnimationParams, errors);\n        var /** @type {?} */ queriedElements = new Set();\n        var /** @type {?} */ preStyleMap = new Map();\n        var /** @type {?} */ postStyleMap = new Map();\n        var /** @type {?} */ isRemoval = nextState === 'void';\n        var /** @type {?} */ animationOptions = { params: __assign({}, transitionAnimationParams, nextAnimationParams) };\n        var /** @type {?} */ timelines = buildAnimationTimelines(driver, element, this.ast.animation, currentStateStyles, nextStateStyles, animationOptions, subInstructions, errors);\n        if (errors.length) {\n            return createTransitionInstruction(element, this._triggerName, currentState, nextState, isRemoval, currentStateStyles, nextStateStyles, [], [], preStyleMap, postStyleMap, errors);\n        }\n        timelines.forEach(function (tl) {\n            var /** @type {?} */ elm = tl.element;\n            var /** @type {?} */ preProps = getOrSetAsInMap(preStyleMap, elm, {});\n            tl.preStyleProps.forEach(function (prop) { return preProps[prop] = true; });\n            var /** @type {?} */ postProps = getOrSetAsInMap(postStyleMap, elm, {});\n            tl.postStyleProps.forEach(function (prop) { return postProps[prop] = true; });\n            if (elm !== element) {\n                queriedElements.add(elm);\n            }\n        });\n        var /** @type {?} */ queriedElementsList = iteratorToArray(queriedElements.values());\n        return createTransitionInstruction(element, this._triggerName, currentState, nextState, isRemoval, currentStateStyles, nextStateStyles, timelines, queriedElementsList, preStyleMap, postStyleMap);\n    };\n    return AnimationTransitionFactory;\n}());\n/**\n * @param {?} matchFns\n * @param {?} currentState\n * @param {?} nextState\n * @return {?}\n */\nfunction oneOrMoreTransitionsMatch(matchFns, currentState, nextState) {\n    return matchFns.some(function (fn) { return fn(currentState, nextState); });\n}\nvar AnimationStateStyles = (function () {\n    /**\n     * @param {?} styles\n     * @param {?} defaultParams\n     */\n    function AnimationStateStyles(styles, defaultParams) {\n        this.styles = styles;\n        this.defaultParams = defaultParams;\n    }\n    /**\n     * @param {?} params\n     * @param {?} errors\n     * @return {?}\n     */\n    AnimationStateStyles.prototype.buildStyles = function (params, errors) {\n        var /** @type {?} */ finalStyles = {};\n        var /** @type {?} */ combinedParams = copyObj(this.defaultParams);\n        Object.keys(params).forEach(function (key) {\n            var /** @type {?} */ value = params[key];\n            if (value != null) {\n                combinedParams[key] = value;\n            }\n        });\n        this.styles.styles.forEach(function (value) {\n            if (typeof value !== 'string') {\n                var /** @type {?} */ styleObj_1 = (value);\n                Object.keys(styleObj_1).forEach(function (prop) {\n                    var /** @type {?} */ val = styleObj_1[prop];\n                    if (val.length > 1) {\n                        val = interpolateParams(val, combinedParams, errors);\n                    }\n                    finalStyles[prop] = val;\n                });\n            }\n        });\n        return finalStyles;\n    };\n    return AnimationStateStyles;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * \\@experimental Animation support is experimental.\n * @param {?} name\n * @param {?} ast\n * @return {?}\n */\nfunction buildTrigger(name, ast) {\n    return new AnimationTrigger(name, ast);\n}\n/**\n * \\@experimental Animation support is experimental.\n */\nvar AnimationTrigger = (function () {\n    /**\n     * @param {?} name\n     * @param {?} ast\n     */\n    function AnimationTrigger(name, ast) {\n        var _this = this;\n        this.name = name;\n        this.ast = ast;\n        this.transitionFactories = [];\n        this.states = {};\n        ast.states.forEach(function (ast) {\n            var /** @type {?} */ defaultParams = (ast.options && ast.options.params) || {};\n            _this.states[ast.name] = new AnimationStateStyles(ast.style, defaultParams);\n        });\n        balanceProperties(this.states, 'true', '1');\n        balanceProperties(this.states, 'false', '0');\n        ast.transitions.forEach(function (ast) {\n            _this.transitionFactories.push(new AnimationTransitionFactory(name, ast, _this.states));\n        });\n        this.fallbackTransition = createFallbackTransition(name, this.states);\n    }\n    Object.defineProperty(AnimationTrigger.prototype, \"containsQueries\", {\n        /**\n         * @return {?}\n         */\n        get: function () { return this.ast.queryCount > 0; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} currentState\n     * @param {?} nextState\n     * @return {?}\n     */\n    AnimationTrigger.prototype.matchTransition = function (currentState, nextState) {\n        var /** @type {?} */ entry = this.transitionFactories.find(function (f) { return f.match(currentState, nextState); });\n        return entry || null;\n    };\n    /**\n     * @param {?} currentState\n     * @param {?} params\n     * @param {?} errors\n     * @return {?}\n     */\n    AnimationTrigger.prototype.matchStyles = function (currentState, params, errors) {\n        return this.fallbackTransition.buildStyles(currentState, params, errors);\n    };\n    return AnimationTrigger;\n}());\n/**\n * @param {?} triggerName\n * @param {?} states\n * @return {?}\n */\nfunction createFallbackTransition(triggerName, states) {\n    var /** @type {?} */ matchers = [function (fromState, toState) { return true; }];\n    var /** @type {?} */ animation = new SequenceAst([]);\n    var /** @type {?} */ transition = new TransitionAst(matchers, animation);\n    return new AnimationTransitionFactory(triggerName, transition, states);\n}\n/**\n * @param {?} obj\n * @param {?} key1\n * @param {?} key2\n * @return {?}\n */\nfunction balanceProperties(obj, key1, key2) {\n    if (obj.hasOwnProperty(key1)) {\n        if (!obj.hasOwnProperty(key2)) {\n            obj[key2] = obj[key1];\n        }\n    }\n    else if (obj.hasOwnProperty(key2)) {\n        obj[key1] = obj[key2];\n    }\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar EMPTY_INSTRUCTION_MAP = new ElementInstructionMap();\nvar TimelineAnimationEngine = (function () {\n    /**\n     * @param {?} _driver\n     * @param {?} _normalizer\n     */\n    function TimelineAnimationEngine(_driver, _normalizer) {\n        this._driver = _driver;\n        this._normalizer = _normalizer;\n        this._animations = {};\n        this._playersById = {};\n        this.players = [];\n    }\n    /**\n     * @param {?} id\n     * @param {?} metadata\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype.register = function (id, metadata) {\n        var /** @type {?} */ errors = [];\n        var /** @type {?} */ ast = buildAnimationAst(metadata, errors);\n        if (errors.length) {\n            throw new Error(\"Unable to build the animation due to the following errors: \" + errors.join(\"\\n\"));\n        }\n        else {\n            this._animations[id] = ast;\n        }\n    };\n    /**\n     * @param {?} i\n     * @param {?} preStyles\n     * @param {?=} postStyles\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype._buildPlayer = function (i, preStyles, postStyles) {\n        var /** @type {?} */ element = i.element;\n        var /** @type {?} */ keyframes = normalizeKeyframes(this._driver, this._normalizer, element, i.keyframes, preStyles, postStyles);\n        return this._driver.animate(element, keyframes, i.duration, i.delay, i.easing, []);\n    };\n    /**\n     * @param {?} id\n     * @param {?} element\n     * @param {?=} options\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype.create = function (id, element, options) {\n        var _this = this;\n        if (options === void 0) { options = {}; }\n        var /** @type {?} */ errors = [];\n        var /** @type {?} */ ast = this._animations[id];\n        var /** @type {?} */ instructions;\n        var /** @type {?} */ autoStylesMap = new Map();\n        if (ast) {\n            instructions = buildAnimationTimelines(this._driver, element, ast, {}, {}, options, EMPTY_INSTRUCTION_MAP, errors);\n            instructions.forEach(function (inst) {\n                var /** @type {?} */ styles = getOrSetAsInMap(autoStylesMap, inst.element, {});\n                inst.postStyleProps.forEach(function (prop) { return styles[prop] = null; });\n            });\n        }\n        else {\n            errors.push('The requested animation doesn\\'t exist or has already been destroyed');\n            instructions = [];\n        }\n        if (errors.length) {\n            throw new Error(\"Unable to create the animation due to the following errors: \" + errors.join(\"\\n\"));\n        }\n        autoStylesMap.forEach(function (styles, element) {\n            Object.keys(styles).forEach(function (prop) { styles[prop] = _this._driver.computeStyle(element, prop, _angular_animations.AUTO_STYLE); });\n        });\n        var /** @type {?} */ players = instructions.map(function (i) {\n            var /** @type {?} */ styles = autoStylesMap.get(i.element);\n            return _this._buildPlayer(i, {}, styles);\n        });\n        var /** @type {?} */ player = optimizeGroupPlayer(players);\n        this._playersById[id] = player;\n        player.onDestroy(function () { return _this.destroy(id); });\n        this.players.push(player);\n        return player;\n    };\n    /**\n     * @param {?} id\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype.destroy = function (id) {\n        var /** @type {?} */ player = this._getPlayer(id);\n        player.destroy();\n        delete this._playersById[id];\n        var /** @type {?} */ index = this.players.indexOf(player);\n        if (index >= 0) {\n            this.players.splice(index, 1);\n        }\n    };\n    /**\n     * @param {?} id\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype._getPlayer = function (id) {\n        var /** @type {?} */ player = this._playersById[id];\n        if (!player) {\n            throw new Error(\"Unable to find the timeline player referenced by \" + id);\n        }\n        return player;\n    };\n    /**\n     * @param {?} id\n     * @param {?} element\n     * @param {?} eventName\n     * @param {?} callback\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype.listen = function (id, element, eventName, callback) {\n        // triggerName, fromState, toState are all ignored for timeline animations\n        var /** @type {?} */ baseEvent = makeAnimationEvent(element, '', '', '');\n        listenOnPlayer(this._getPlayer(id), eventName, baseEvent, callback);\n        return function () { };\n    };\n    /**\n     * @param {?} id\n     * @param {?} element\n     * @param {?} command\n     * @param {?} args\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype.command = function (id, element, command, args) {\n        if (command == 'register') {\n            this.register(id, /** @type {?} */ (args[0]));\n            return;\n        }\n        if (command == 'create') {\n            var /** @type {?} */ options = ((args[0] || {}));\n            this.create(id, element, options);\n            return;\n        }\n        var /** @type {?} */ player = this._getPlayer(id);\n        switch (command) {\n            case 'play':\n                player.play();\n                break;\n            case 'pause':\n                player.pause();\n                break;\n            case 'reset':\n                player.reset();\n                break;\n            case 'restart':\n                player.restart();\n                break;\n            case 'finish':\n                player.finish();\n                break;\n            case 'init':\n                player.init();\n                break;\n            case 'setPosition':\n                player.setPosition(parseFloat(/** @type {?} */ (args[0])));\n                break;\n            case 'destroy':\n                this.destroy(id);\n                break;\n        }\n    };\n    return TimelineAnimationEngine;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar QUEUED_CLASSNAME = 'ng-animate-queued';\nvar QUEUED_SELECTOR = '.ng-animate-queued';\nvar DISABLED_CLASSNAME = 'ng-animate-disabled';\nvar DISABLED_SELECTOR = '.ng-animate-disabled';\nvar EMPTY_PLAYER_ARRAY = [];\nvar NULL_REMOVAL_STATE = {\n    namespaceId: '',\n    setForRemoval: null,\n    hasAnimation: false,\n    removedBeforeQueried: false\n};\nvar NULL_REMOVED_QUERIED_STATE = {\n    namespaceId: '',\n    setForRemoval: null,\n    hasAnimation: false,\n    removedBeforeQueried: true\n};\n/**\n * @record\n */\n\nvar REMOVAL_FLAG = '__ng_removed';\n/**\n * @record\n */\n\nvar StateValue = (function () {\n    /**\n     * @param {?} input\n     */\n    function StateValue(input) {\n        var /** @type {?} */ isObj = input && input.hasOwnProperty('value');\n        var /** @type {?} */ value = isObj ? input['value'] : input;\n        this.value = normalizeTriggerValue(value);\n        if (isObj) {\n            var /** @type {?} */ options = copyObj(/** @type {?} */ (input));\n            delete options['value'];\n            this.options = (options);\n        }\n        else {\n            this.options = {};\n        }\n        if (!this.options.params) {\n            this.options.params = {};\n        }\n    }\n    Object.defineProperty(StateValue.prototype, \"params\", {\n        /**\n         * @return {?}\n         */\n        get: function () { return (this.options.params); },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} options\n     * @return {?}\n     */\n    StateValue.prototype.absorbOptions = function (options) {\n        var /** @type {?} */ newParams = options.params;\n        if (newParams) {\n            var /** @type {?} */ oldParams_1 = ((this.options.params));\n            Object.keys(newParams).forEach(function (prop) {\n                if (oldParams_1[prop] == null) {\n                    oldParams_1[prop] = newParams[prop];\n                }\n            });\n        }\n    };\n    return StateValue;\n}());\nvar VOID_VALUE = 'void';\nvar DEFAULT_STATE_VALUE = new StateValue(VOID_VALUE);\nvar DELETED_STATE_VALUE = new StateValue('DELETED');\nvar AnimationTransitionNamespace = (function () {\n    /**\n     * @param {?} id\n     * @param {?} hostElement\n     * @param {?} _engine\n     */\n    function AnimationTransitionNamespace(id, hostElement, _engine) {\n        this.id = id;\n        this.hostElement = hostElement;\n        this._engine = _engine;\n        this.players = [];\n        this._triggers = {};\n        this._queue = [];\n        this._elementListeners = new Map();\n        this._hostClassName = 'ng-tns-' + id;\n        addClass(hostElement, this._hostClassName);\n    }\n    /**\n     * @param {?} element\n     * @param {?} name\n     * @param {?} phase\n     * @param {?} callback\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.listen = function (element, name, phase, callback) {\n        var _this = this;\n        if (!this._triggers.hasOwnProperty(name)) {\n            throw new Error(\"Unable to listen on the animation trigger event \\\"\" + phase + \"\\\" because the animation trigger \\\"\" + name + \"\\\" doesn't exist!\");\n        }\n        if (phase == null || phase.length == 0) {\n            throw new Error(\"Unable to listen on the animation trigger \\\"\" + name + \"\\\" because the provided event is undefined!\");\n        }\n        if (!isTriggerEventValid(phase)) {\n            throw new Error(\"The provided animation trigger event \\\"\" + phase + \"\\\" for the animation trigger \\\"\" + name + \"\\\" is not supported!\");\n        }\n        var /** @type {?} */ listeners = getOrSetAsInMap(this._elementListeners, element, []);\n        var /** @type {?} */ data = { name: name, phase: phase, callback: callback };\n        listeners.push(data);\n        var /** @type {?} */ triggersWithStates = getOrSetAsInMap(this._engine.statesByElement, element, {});\n        if (!triggersWithStates.hasOwnProperty(name)) {\n            addClass(element, NG_TRIGGER_CLASSNAME);\n            addClass(element, NG_TRIGGER_CLASSNAME + '-' + name);\n            triggersWithStates[name] = null;\n        }\n        return function () {\n            // the event listener is removed AFTER the flush has occurred such\n            // that leave animations callbacks can fire (otherwise if the node\n            // is removed in between then the listeners would be deregistered)\n            _this._engine.afterFlush(function () {\n                var /** @type {?} */ index = listeners.indexOf(data);\n                if (index >= 0) {\n                    listeners.splice(index, 1);\n                }\n                if (!_this._triggers[name]) {\n                    delete triggersWithStates[name];\n                }\n            });\n        };\n    };\n    /**\n     * @param {?} name\n     * @param {?} ast\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.register = function (name, ast) {\n        if (this._triggers[name]) {\n            // throw\n            return false;\n        }\n        else {\n            this._triggers[name] = ast;\n            return true;\n        }\n    };\n    /**\n     * @param {?} name\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype._getTrigger = function (name) {\n        var /** @type {?} */ trigger = this._triggers[name];\n        if (!trigger) {\n            throw new Error(\"The provided animation trigger \\\"\" + name + \"\\\" has not been registered!\");\n        }\n        return trigger;\n    };\n    /**\n     * @param {?} element\n     * @param {?} triggerName\n     * @param {?} value\n     * @param {?=} defaultToFallback\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.trigger = function (element, triggerName, value, defaultToFallback) {\n        var _this = this;\n        if (defaultToFallback === void 0) { defaultToFallback = true; }\n        var /** @type {?} */ trigger = this._getTrigger(triggerName);\n        var /** @type {?} */ player = new TransitionAnimationPlayer(this.id, triggerName, element);\n        var /** @type {?} */ triggersWithStates = this._engine.statesByElement.get(element);\n        if (!triggersWithStates) {\n            addClass(element, NG_TRIGGER_CLASSNAME);\n            addClass(element, NG_TRIGGER_CLASSNAME + '-' + triggerName);\n            this._engine.statesByElement.set(element, triggersWithStates = {});\n        }\n        var /** @type {?} */ fromState = triggersWithStates[triggerName];\n        var /** @type {?} */ toState = new StateValue(value);\n        var /** @type {?} */ isObj = value && value.hasOwnProperty('value');\n        if (!isObj && fromState) {\n            toState.absorbOptions(fromState.options);\n        }\n        triggersWithStates[triggerName] = toState;\n        if (!fromState) {\n            fromState = DEFAULT_STATE_VALUE;\n        }\n        else if (fromState === DELETED_STATE_VALUE) {\n            return player;\n        }\n        var /** @type {?} */ isRemoval = toState.value === VOID_VALUE;\n        // normally this isn't reached by here, however, if an object expression\n        // is passed in then it may be a new object each time. Comparing the value\n        // is important since that will stay the same despite there being a new object.\n        // The removal arc here is special cased because the same element is triggered\n        // twice in the event that it contains animations on the outer/inner portions\n        // of the host container\n        if (!isRemoval && fromState.value === toState.value) {\n            // this means that despite the value not changing, some inner params\n            // have changed which means that the animation final styles need to be applied\n            if (!objEquals(fromState.params, toState.params)) {\n                var /** @type {?} */ errors = [];\n                var /** @type {?} */ fromStyles_1 = trigger.matchStyles(fromState.value, fromState.params, errors);\n                var /** @type {?} */ toStyles_1 = trigger.matchStyles(toState.value, toState.params, errors);\n                if (errors.length) {\n                    this._engine.reportError(errors);\n                }\n                else {\n                    this._engine.afterFlush(function () {\n                        eraseStyles(element, fromStyles_1);\n                        setStyles(element, toStyles_1);\n                    });\n                }\n            }\n            return;\n        }\n        var /** @type {?} */ playersOnElement = getOrSetAsInMap(this._engine.playersByElement, element, []);\n        playersOnElement.forEach(function (player) {\n            // only remove the player if it is queued on the EXACT same trigger/namespace\n            // we only also deal with queued players here because if the animation has\n            // started then we want to keep the player alive until the flush happens\n            // (which is where the previousPlayers are passed into the new palyer)\n            if (player.namespaceId == _this.id && player.triggerName == triggerName && player.queued) {\n                player.destroy();\n            }\n        });\n        var /** @type {?} */ transition = trigger.matchTransition(fromState.value, toState.value);\n        var /** @type {?} */ isFallbackTransition = false;\n        if (!transition) {\n            if (!defaultToFallback)\n                return;\n            transition = trigger.fallbackTransition;\n            isFallbackTransition = true;\n        }\n        this._engine.totalQueuedPlayers++;\n        this._queue.push({ element: element, triggerName: triggerName, transition: transition, fromState: fromState, toState: toState, player: player, isFallbackTransition: isFallbackTransition });\n        if (!isFallbackTransition) {\n            addClass(element, QUEUED_CLASSNAME);\n            player.onStart(function () { removeClass(element, QUEUED_CLASSNAME); });\n        }\n        player.onDone(function () {\n            var /** @type {?} */ index = _this.players.indexOf(player);\n            if (index >= 0) {\n                _this.players.splice(index, 1);\n            }\n            var /** @type {?} */ players = _this._engine.playersByElement.get(element);\n            if (players) {\n                var /** @type {?} */ index_1 = players.indexOf(player);\n                if (index_1 >= 0) {\n                    players.splice(index_1, 1);\n                }\n            }\n        });\n        this.players.push(player);\n        playersOnElement.push(player);\n        return player;\n    };\n    /**\n     * @param {?} name\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.deregister = function (name) {\n        var _this = this;\n        delete this._triggers[name];\n        this._engine.statesByElement.forEach(function (stateMap, element) { delete stateMap[name]; });\n        this._elementListeners.forEach(function (listeners, element) {\n            _this._elementListeners.set(element, listeners.filter(function (entry) { return entry.name != name; }));\n        });\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.clearElementCache = function (element) {\n        this._engine.statesByElement.delete(element);\n        this._elementListeners.delete(element);\n        var /** @type {?} */ elementPlayers = this._engine.playersByElement.get(element);\n        if (elementPlayers) {\n            elementPlayers.forEach(function (player) { return player.destroy(); });\n            this._engine.playersByElement.delete(element);\n        }\n    };\n    /**\n     * @param {?} rootElement\n     * @param {?} context\n     * @param {?=} animate\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype._destroyInnerNodes = function (rootElement, context, animate) {\n        var _this = this;\n        if (animate === void 0) { animate = false; }\n        this._engine.driver.query(rootElement, NG_TRIGGER_SELECTOR, true).forEach(function (elm) {\n            if (animate && containsClass(elm, _this._hostClassName)) {\n                var /** @type {?} */ innerNs = _this._engine.namespacesByHostElement.get(elm);\n                // special case for a host element with animations on the same element\n                if (innerNs) {\n                    innerNs.removeNode(elm, context, true);\n                }\n                _this.removeNode(elm, context, true);\n            }\n            else {\n                _this.clearElementCache(elm);\n            }\n        });\n    };\n    /**\n     * @param {?} element\n     * @param {?} context\n     * @param {?=} doNotRecurse\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.removeNode = function (element, context, doNotRecurse) {\n        var _this = this;\n        var /** @type {?} */ engine = this._engine;\n        if (!doNotRecurse && element.childElementCount) {\n            this._destroyInnerNodes(element, context, true);\n        }\n        var /** @type {?} */ triggerStates = engine.statesByElement.get(element);\n        if (triggerStates) {\n            var /** @type {?} */ players_1 = [];\n            Object.keys(triggerStates).forEach(function (triggerName) {\n                // this check is here in the event that an element is removed\n                // twice (both on the host level and the component level)\n                if (_this._triggers[triggerName]) {\n                    var /** @type {?} */ player = _this.trigger(element, triggerName, VOID_VALUE, false);\n                    if (player) {\n                        players_1.push(player);\n                    }\n                }\n            });\n            if (players_1.length) {\n                engine.markElementAsRemoved(this.id, element, true, context);\n                optimizeGroupPlayer(players_1).onDone(function () { return engine.processLeaveNode(element); });\n                return;\n            }\n        }\n        // find the player that is animating and make sure that the\n        // removal is delayed until that player has completed\n        var /** @type {?} */ containsPotentialParentTransition = false;\n        if (engine.totalAnimations) {\n            var /** @type {?} */ currentPlayers = engine.players.length ? engine.playersByQueriedElement.get(element) : [];\n            // when this `if statement` does not continue forward it means that\n            // a previous animation query has selected the current element and\n            // is animating it. In this situation want to continue fowards and\n            // allow the element to be queued up for animation later.\n            if (currentPlayers && currentPlayers.length) {\n                containsPotentialParentTransition = true;\n            }\n            else {\n                var /** @type {?} */ parent_1 = element;\n                while (parent_1 = parent_1.parentNode) {\n                    var /** @type {?} */ triggers = engine.statesByElement.get(parent_1);\n                    if (triggers) {\n                        containsPotentialParentTransition = true;\n                        break;\n                    }\n                }\n            }\n        }\n        // at this stage we know that the element will either get removed\n        // during flush or will be picked up by a parent query. Either way\n        // we need to fire the listeners for this element when it DOES get\n        // removed (once the query parent animation is done or after flush)\n        var /** @type {?} */ listeners = this._elementListeners.get(element);\n        if (listeners) {\n            var /** @type {?} */ visitedTriggers_1 = new Set();\n            listeners.forEach(function (listener) {\n                var /** @type {?} */ triggerName = listener.name;\n                if (visitedTriggers_1.has(triggerName))\n                    return;\n                visitedTriggers_1.add(triggerName);\n                var /** @type {?} */ trigger = _this._triggers[triggerName];\n                var /** @type {?} */ transition = trigger.fallbackTransition;\n                var /** @type {?} */ elementStates = ((engine.statesByElement.get(element)));\n                var /** @type {?} */ fromState = elementStates[triggerName] || DEFAULT_STATE_VALUE;\n                var /** @type {?} */ toState = new StateValue(VOID_VALUE);\n                var /** @type {?} */ player = new TransitionAnimationPlayer(_this.id, triggerName, element);\n                _this._engine.totalQueuedPlayers++;\n                _this._queue.push({\n                    element: element,\n                    triggerName: triggerName,\n                    transition: transition,\n                    fromState: fromState,\n                    toState: toState,\n                    player: player,\n                    isFallbackTransition: true\n                });\n            });\n        }\n        // whether or not a parent has an animation we need to delay the deferral of the leave\n        // operation until we have more information (which we do after flush() has been called)\n        if (containsPotentialParentTransition) {\n            engine.markElementAsRemoved(this.id, element, false, context);\n        }\n        else {\n            // we do this after the flush has occurred such\n            // that the callbacks can be fired\n            engine.afterFlush(function () { return _this.clearElementCache(element); });\n            engine.destroyInnerAnimations(element);\n            engine._onRemovalComplete(element, context);\n        }\n    };\n    /**\n     * @param {?} element\n     * @param {?} parent\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.insertNode = function (element, parent) { addClass(element, this._hostClassName); };\n    /**\n     * @param {?} microtaskId\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.drainQueuedTransitions = function (microtaskId) {\n        var _this = this;\n        var /** @type {?} */ instructions = [];\n        this._queue.forEach(function (entry) {\n            var /** @type {?} */ player = entry.player;\n            if (player.destroyed)\n                return;\n            var /** @type {?} */ element = entry.element;\n            var /** @type {?} */ listeners = _this._elementListeners.get(element);\n            if (listeners) {\n                listeners.forEach(function (listener) {\n                    if (listener.name == entry.triggerName) {\n                        var /** @type {?} */ baseEvent = makeAnimationEvent(element, entry.triggerName, entry.fromState.value, entry.toState.value);\n                        ((baseEvent))['_data'] = microtaskId;\n                        listenOnPlayer(entry.player, listener.phase, baseEvent, listener.callback);\n                    }\n                });\n            }\n            if (player.markedForDestroy) {\n                _this._engine.afterFlush(function () {\n                    // now we can destroy the element properly since the event listeners have\n                    // been bound to the player\n                    player.destroy();\n                });\n            }\n            else {\n                instructions.push(entry);\n            }\n        });\n        this._queue = [];\n        return instructions.sort(function (a, b) {\n            // if depCount == 0 them move to front\n            // otherwise if a contains b then move back\n            var /** @type {?} */ d0 = a.transition.ast.depCount;\n            var /** @type {?} */ d1 = b.transition.ast.depCount;\n            if (d0 == 0 || d1 == 0) {\n                return d0 - d1;\n            }\n            return _this._engine.driver.containsElement(a.element, b.element) ? 1 : -1;\n        });\n    };\n    /**\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.destroy = function (context) {\n        this.players.forEach(function (p) { return p.destroy(); });\n        this._destroyInnerNodes(this.hostElement, context);\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.elementContainsData = function (element) {\n        var /** @type {?} */ containsData = false;\n        if (this._elementListeners.has(element))\n            containsData = true;\n        containsData =\n            (this._queue.find(function (entry) { return entry.element === element; }) ? true : false) || containsData;\n        return containsData;\n    };\n    return AnimationTransitionNamespace;\n}());\n/**\n * @record\n */\n\nvar TransitionAnimationEngine = (function () {\n    /**\n     * @param {?} driver\n     * @param {?} _normalizer\n     */\n    function TransitionAnimationEngine(driver, _normalizer) {\n        this.driver = driver;\n        this._normalizer = _normalizer;\n        this.players = [];\n        this.newHostElements = new Map();\n        this.playersByElement = new Map();\n        this.playersByQueriedElement = new Map();\n        this.statesByElement = new Map();\n        this.disabledNodes = new Set();\n        this.totalAnimations = 0;\n        this.totalQueuedPlayers = 0;\n        this._namespaceLookup = {};\n        this._namespaceList = [];\n        this._flushFns = [];\n        this._whenQuietFns = [];\n        this.namespacesByHostElement = new Map();\n        this.collectedEnterElements = [];\n        this.collectedLeaveElements = [];\n        this.onRemovalComplete = function (element, context) { };\n    }\n    /**\n     * \\@internal\n     * @param {?} element\n     * @param {?} context\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._onRemovalComplete = function (element, context) { this.onRemovalComplete(element, context); };\n    Object.defineProperty(TransitionAnimationEngine.prototype, \"queuedPlayers\", {\n        /**\n         * @return {?}\n         */\n        get: function () {\n            var /** @type {?} */ players = [];\n            this._namespaceList.forEach(function (ns) {\n                ns.players.forEach(function (player) {\n                    if (player.queued) {\n                        players.push(player);\n                    }\n                });\n            });\n            return players;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.createNamespace = function (namespaceId, hostElement) {\n        var /** @type {?} */ ns = new AnimationTransitionNamespace(namespaceId, hostElement, this);\n        if (hostElement.parentNode) {\n            this._balanceNamespaceList(ns, hostElement);\n        }\n        else {\n            // defer this later until flush during when the host element has\n            // been inserted so that we know exactly where to place it in\n            // the namespace list\n            this.newHostElements.set(hostElement, ns);\n            // given that this host element is apart of the animation code, it\n            // may or may not be inserted by a parent node that is an of an\n            // animation renderer type. If this happens then we can still have\n            // access to this item when we query for :enter nodes. If the parent\n            // is a renderer then the set data-structure will normalize the entry\n            this.collectEnterElement(hostElement);\n        }\n        return this._namespaceLookup[namespaceId] = ns;\n    };\n    /**\n     * @param {?} ns\n     * @param {?} hostElement\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._balanceNamespaceList = function (ns, hostElement) {\n        var /** @type {?} */ limit = this._namespaceList.length - 1;\n        if (limit >= 0) {\n            var /** @type {?} */ found = false;\n            for (var /** @type {?} */ i = limit; i >= 0; i--) {\n                var /** @type {?} */ nextNamespace = this._namespaceList[i];\n                if (this.driver.containsElement(nextNamespace.hostElement, hostElement)) {\n                    this._namespaceList.splice(i + 1, 0, ns);\n                    found = true;\n                    break;\n                }\n            }\n            if (!found) {\n                this._namespaceList.splice(0, 0, ns);\n            }\n        }\n        else {\n            this._namespaceList.push(ns);\n        }\n        this.namespacesByHostElement.set(hostElement, ns);\n        return ns;\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.register = function (namespaceId, hostElement) {\n        var /** @type {?} */ ns = this._namespaceLookup[namespaceId];\n        if (!ns) {\n            ns = this.createNamespace(namespaceId, hostElement);\n        }\n        return ns;\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} name\n     * @param {?} trigger\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.registerTrigger = function (namespaceId, name, trigger) {\n        var /** @type {?} */ ns = this._namespaceLookup[namespaceId];\n        if (ns && ns.register(name, trigger)) {\n            this.totalAnimations++;\n        }\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} context\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.destroy = function (namespaceId, context) {\n        var _this = this;\n        if (!namespaceId)\n            return;\n        var /** @type {?} */ ns = this._fetchNamespace(namespaceId);\n        this.afterFlush(function () {\n            _this.namespacesByHostElement.delete(ns.hostElement);\n            delete _this._namespaceLookup[namespaceId];\n            var /** @type {?} */ index = _this._namespaceList.indexOf(ns);\n            if (index >= 0) {\n                _this._namespaceList.splice(index, 1);\n            }\n        });\n        this.afterFlushAnimationsDone(function () { return ns.destroy(context); });\n    };\n    /**\n     * @param {?} id\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._fetchNamespace = function (id) { return this._namespaceLookup[id]; };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} name\n     * @param {?} value\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.trigger = function (namespaceId, element, name, value) {\n        if (isElementNode(element)) {\n            this._fetchNamespace(namespaceId).trigger(element, name, value);\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} parent\n     * @param {?} insertBefore\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.insertNode = function (namespaceId, element, parent, insertBefore) {\n        if (!isElementNode(element))\n            return;\n        // special case for when an element is removed and reinserted (move operation)\n        // when this occurs we do not want to use the element for deletion later\n        var /** @type {?} */ details = (element[REMOVAL_FLAG]);\n        if (details && details.setForRemoval) {\n            details.setForRemoval = false;\n        }\n        // in the event that the namespaceId is blank then the caller\n        // code does not contain any animation code in it, but it is\n        // just being called so that the node is marked as being inserted\n        if (namespaceId) {\n            this._fetchNamespace(namespaceId).insertNode(element, parent);\n        }\n        // only *directives and host elements are inserted before\n        if (insertBefore) {\n            this.collectEnterElement(element);\n        }\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.collectEnterElement = function (element) { this.collectedEnterElements.push(element); };\n    /**\n     * @param {?} element\n     * @param {?} value\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.markElementAsDisabled = function (element, value) {\n        if (value) {\n            if (!this.disabledNodes.has(element)) {\n                this.disabledNodes.add(element);\n                addClass(element, DISABLED_CLASSNAME);\n            }\n        }\n        else if (this.disabledNodes.has(element)) {\n            this.disabledNodes.delete(element);\n            removeClass(element, DISABLED_CLASSNAME);\n        }\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} context\n     * @param {?=} doNotRecurse\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.removeNode = function (namespaceId, element, context, doNotRecurse) {\n        if (!isElementNode(element)) {\n            this._onRemovalComplete(element, context);\n            return;\n        }\n        var /** @type {?} */ ns = namespaceId ? this._fetchNamespace(namespaceId) : null;\n        if (ns) {\n            ns.removeNode(element, context, doNotRecurse);\n        }\n        else {\n            this.markElementAsRemoved(namespaceId, element, false, context);\n        }\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?=} hasAnimation\n     * @param {?=} context\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.markElementAsRemoved = function (namespaceId, element, hasAnimation, context) {\n        this.collectedLeaveElements.push(element);\n        element[REMOVAL_FLAG] = {\n            namespaceId: namespaceId,\n            setForRemoval: context, hasAnimation: hasAnimation,\n            removedBeforeQueried: false\n        };\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} name\n     * @param {?} phase\n     * @param {?} callback\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.listen = function (namespaceId, element, name, phase, callback) {\n        if (isElementNode(element)) {\n            return this._fetchNamespace(namespaceId).listen(element, name, phase, callback);\n        }\n        return function () { };\n    };\n    /**\n     * @param {?} entry\n     * @param {?} subTimelines\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._buildInstruction = function (entry, subTimelines) {\n        return entry.transition.build(this.driver, entry.element, entry.fromState.value, entry.toState.value, entry.fromState.options, entry.toState.options, subTimelines);\n    };\n    /**\n     * @param {?} containerElement\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.destroyInnerAnimations = function (containerElement) {\n        var _this = this;\n        var /** @type {?} */ elements = this.driver.query(containerElement, NG_TRIGGER_SELECTOR, true);\n        elements.forEach(function (element) {\n            var /** @type {?} */ players = _this.playersByElement.get(element);\n            if (players) {\n                players.forEach(function (player) {\n                    // special case for when an element is set for destruction, but hasn't started.\n                    // in this situation we want to delay the destruction until the flush occurs\n                    // so that any event listeners attached to the player are triggered.\n                    if (player.queued) {\n                        player.markedForDestroy = true;\n                    }\n                    else {\n                        player.destroy();\n                    }\n                });\n            }\n            var /** @type {?} */ stateMap = _this.statesByElement.get(element);\n            if (stateMap) {\n                Object.keys(stateMap).forEach(function (triggerName) { return stateMap[triggerName] = DELETED_STATE_VALUE; });\n            }\n        });\n        if (this.playersByQueriedElement.size == 0)\n            return;\n        elements = this.driver.query(containerElement, NG_ANIMATING_SELECTOR, true);\n        if (elements.length) {\n            elements.forEach(function (element) {\n                var /** @type {?} */ players = _this.playersByQueriedElement.get(element);\n                if (players) {\n                    players.forEach(function (player) { return player.finish(); });\n                }\n            });\n        }\n    };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.whenRenderingDone = function () {\n        var _this = this;\n        return new Promise(function (resolve) {\n            if (_this.players.length) {\n                return optimizeGroupPlayer(_this.players).onDone(function () { return resolve(); });\n            }\n            else {\n                resolve();\n            }\n        });\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.processLeaveNode = function (element) {\n        var _this = this;\n        var /** @type {?} */ details = (element[REMOVAL_FLAG]);\n        if (details && details.setForRemoval) {\n            // this will prevent it from removing it twice\n            element[REMOVAL_FLAG] = NULL_REMOVAL_STATE;\n            if (details.namespaceId) {\n                this.destroyInnerAnimations(element);\n                var /** @type {?} */ ns = this._fetchNamespace(details.namespaceId);\n                if (ns) {\n                    ns.clearElementCache(element);\n                }\n            }\n            this._onRemovalComplete(element, details.setForRemoval);\n        }\n        if (this.driver.matchesElement(element, DISABLED_SELECTOR)) {\n            this.markElementAsDisabled(element, false);\n        }\n        this.driver.query(element, DISABLED_SELECTOR, true).forEach(function (node) {\n            _this.markElementAsDisabled(element, false);\n        });\n    };\n    /**\n     * @param {?=} microtaskId\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.flush = function (microtaskId) {\n        var _this = this;\n        if (microtaskId === void 0) { microtaskId = -1; }\n        var /** @type {?} */ players = [];\n        if (this.newHostElements.size) {\n            this.newHostElements.forEach(function (ns, element) { return _this._balanceNamespaceList(ns, element); });\n            this.newHostElements.clear();\n        }\n        if (this._namespaceList.length &&\n            (this.totalQueuedPlayers || this.collectedLeaveElements.length)) {\n            var /** @type {?} */ cleanupFns = [];\n            try {\n                players = this._flushAnimations(cleanupFns, microtaskId);\n            }\n            finally {\n                for (var /** @type {?} */ i = 0; i < cleanupFns.length; i++) {\n                    cleanupFns[i]();\n                }\n            }\n        }\n        else {\n            for (var /** @type {?} */ i = 0; i < this.collectedLeaveElements.length; i++) {\n                var /** @type {?} */ element = this.collectedLeaveElements[i];\n                this.processLeaveNode(element);\n            }\n        }\n        this.totalQueuedPlayers = 0;\n        this.collectedEnterElements.length = 0;\n        this.collectedLeaveElements.length = 0;\n        this._flushFns.forEach(function (fn) { return fn(); });\n        this._flushFns = [];\n        if (this._whenQuietFns.length) {\n            // we move these over to a variable so that\n            // if any new callbacks are registered in another\n            // flush they do not populate the existing set\n            var /** @type {?} */ quietFns_1 = this._whenQuietFns;\n            this._whenQuietFns = [];\n            if (players.length) {\n                optimizeGroupPlayer(players).onDone(function () { quietFns_1.forEach(function (fn) { return fn(); }); });\n            }\n            else {\n                quietFns_1.forEach(function (fn) { return fn(); });\n            }\n        }\n    };\n    /**\n     * @param {?} errors\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.reportError = function (errors) {\n        throw new Error(\"Unable to process animations due to the following failed trigger transitions\\n \" + errors.join(\"\\n\"));\n    };\n    /**\n     * @param {?} cleanupFns\n     * @param {?} microtaskId\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._flushAnimations = function (cleanupFns, microtaskId) {\n        var _this = this;\n        var /** @type {?} */ subTimelines = new ElementInstructionMap();\n        var /** @type {?} */ skippedPlayers = [];\n        var /** @type {?} */ skippedPlayersMap = new Map();\n        var /** @type {?} */ queuedInstructions = [];\n        var /** @type {?} */ queriedElements = new Map();\n        var /** @type {?} */ allPreStyleElements = new Map();\n        var /** @type {?} */ allPostStyleElements = new Map();\n        var /** @type {?} */ disabledElementsSet = new Set();\n        this.disabledNodes.forEach(function (node) {\n            var /** @type {?} */ nodesThatAreDisabled = _this.driver.query(node, QUEUED_SELECTOR, true);\n            for (var /** @type {?} */ i = 0; i < nodesThatAreDisabled.length; i++) {\n                disabledElementsSet.add(nodesThatAreDisabled[i]);\n            }\n        });\n        var /** @type {?} */ bodyNode = getBodyNode();\n        var /** @type {?} */ allEnterNodes = this.collectedEnterElements.length ?\n            this.collectedEnterElements.filter(createIsRootFilterFn(this.collectedEnterElements)) :\n            [];\n        // this must occur before the instructions are built below such that\n        // the :enter queries match the elements (since the timeline queries\n        // are fired during instruction building).\n        for (var /** @type {?} */ i = 0; i < allEnterNodes.length; i++) {\n            addClass(allEnterNodes[i], ENTER_CLASSNAME);\n        }\n        var /** @type {?} */ allLeaveNodes = [];\n        var /** @type {?} */ leaveNodesWithoutAnimations = [];\n        for (var /** @type {?} */ i = 0; i < this.collectedLeaveElements.length; i++) {\n            var /** @type {?} */ element = this.collectedLeaveElements[i];\n            var /** @type {?} */ details = (element[REMOVAL_FLAG]);\n            if (details && details.setForRemoval) {\n                addClass(element, LEAVE_CLASSNAME);\n                allLeaveNodes.push(element);\n                if (!details.hasAnimation) {\n                    leaveNodesWithoutAnimations.push(element);\n                }\n            }\n        }\n        cleanupFns.push(function () {\n            allEnterNodes.forEach(function (element) { return removeClass(element, ENTER_CLASSNAME); });\n            allLeaveNodes.forEach(function (element) {\n                removeClass(element, LEAVE_CLASSNAME);\n                _this.processLeaveNode(element);\n            });\n        });\n        var /** @type {?} */ allPlayers = [];\n        var /** @type {?} */ erroneousTransitions = [];\n        for (var /** @type {?} */ i = this._namespaceList.length - 1; i >= 0; i--) {\n            var /** @type {?} */ ns = this._namespaceList[i];\n            ns.drainQueuedTransitions(microtaskId).forEach(function (entry) {\n                var /** @type {?} */ player = entry.player;\n                allPlayers.push(player);\n                var /** @type {?} */ element = entry.element;\n                if (!bodyNode || !_this.driver.containsElement(bodyNode, element)) {\n                    player.destroy();\n                    return;\n                }\n                var /** @type {?} */ instruction = ((_this._buildInstruction(entry, subTimelines)));\n                if (instruction.errors && instruction.errors.length) {\n                    erroneousTransitions.push(instruction);\n                    return;\n                }\n                // if a unmatched transition is queued to go then it SHOULD NOT render\n                // an animation and cancel the previously running animations.\n                if (entry.isFallbackTransition) {\n                    player.onStart(function () { return eraseStyles(element, instruction.fromStyles); });\n                    player.onDestroy(function () { return setStyles(element, instruction.toStyles); });\n                    skippedPlayers.push(player);\n                    return;\n                }\n                // this means that if a parent animation uses this animation as a sub trigger\n                // then it will instruct the timeline builder to not add a player delay, but\n                // instead stretch the first keyframe gap up until the animation starts. The\n                // reason this is important is to prevent extra initialization styles from being\n                // required by the user in the animation.\n                instruction.timelines.forEach(function (tl) { return tl.stretchStartingKeyframe = true; });\n                subTimelines.append(element, instruction.timelines);\n                var /** @type {?} */ tuple = { instruction: instruction, player: player, element: element };\n                queuedInstructions.push(tuple);\n                instruction.queriedElements.forEach(function (element) { return getOrSetAsInMap(queriedElements, element, []).push(player); });\n                instruction.preStyleProps.forEach(function (stringMap, element) {\n                    var /** @type {?} */ props = Object.keys(stringMap);\n                    if (props.length) {\n                        var /** @type {?} */ setVal_1 = ((allPreStyleElements.get(element)));\n                        if (!setVal_1) {\n                            allPreStyleElements.set(element, setVal_1 = new Set());\n                        }\n                        props.forEach(function (prop) { return setVal_1.add(prop); });\n                    }\n                });\n                instruction.postStyleProps.forEach(function (stringMap, element) {\n                    var /** @type {?} */ props = Object.keys(stringMap);\n                    var /** @type {?} */ setVal = ((allPostStyleElements.get(element)));\n                    if (!setVal) {\n                        allPostStyleElements.set(element, setVal = new Set());\n                    }\n                    props.forEach(function (prop) { return setVal.add(prop); });\n                });\n            });\n        }\n        if (erroneousTransitions.length) {\n            var /** @type {?} */ errors_1 = [];\n            erroneousTransitions.forEach(function (instruction) {\n                errors_1.push(\"@\" + instruction.triggerName + \" has failed due to:\\n\"); /** @type {?} */\n                ((instruction.errors)).forEach(function (error) { return errors_1.push(\"- \" + error + \"\\n\"); });\n            });\n            allPlayers.forEach(function (player) { return player.destroy(); });\n            this.reportError(errors_1);\n        }\n        // these can only be detected here since we have a map of all the elements\n        // that have animations attached to them...\n        var /** @type {?} */ enterNodesWithoutAnimations = [];\n        for (var /** @type {?} */ i = 0; i < allEnterNodes.length; i++) {\n            var /** @type {?} */ element = allEnterNodes[i];\n            if (!subTimelines.has(element)) {\n                enterNodesWithoutAnimations.push(element);\n            }\n        }\n        var /** @type {?} */ allPreviousPlayersMap = new Map();\n        var /** @type {?} */ sortedParentElements = [];\n        queuedInstructions.forEach(function (entry) {\n            var /** @type {?} */ element = entry.element;\n            if (subTimelines.has(element)) {\n                sortedParentElements.unshift(element);\n                _this._beforeAnimationBuild(entry.player.namespaceId, entry.instruction, allPreviousPlayersMap);\n            }\n        });\n        skippedPlayers.forEach(function (player) {\n            var /** @type {?} */ element = player.element;\n            var /** @type {?} */ previousPlayers = _this._getPreviousPlayers(element, false, player.namespaceId, player.triggerName, null);\n            previousPlayers.forEach(function (prevPlayer) { getOrSetAsInMap(allPreviousPlayersMap, element, []).push(prevPlayer); });\n        });\n        allPreviousPlayersMap.forEach(function (players) { return players.forEach(function (player) { return player.destroy(); }); });\n        // PRE STAGE: fill the ! styles\n        var /** @type {?} */ preStylesMap = allPreStyleElements.size ?\n            cloakAndComputeStyles(this.driver, enterNodesWithoutAnimations, allPreStyleElements, _angular_animations.ɵPRE_STYLE) :\n            new Map();\n        // POST STAGE: fill the * styles\n        var /** @type {?} */ postStylesMap = cloakAndComputeStyles(this.driver, leaveNodesWithoutAnimations, allPostStyleElements, _angular_animations.AUTO_STYLE);\n        var /** @type {?} */ rootPlayers = [];\n        var /** @type {?} */ subPlayers = [];\n        queuedInstructions.forEach(function (entry) {\n            var element = entry.element, player = entry.player, instruction = entry.instruction;\n            // this means that it was never consumed by a parent animation which\n            // means that it is independent and therefore should be set for animation\n            if (subTimelines.has(element)) {\n                if (disabledElementsSet.has(element)) {\n                    skippedPlayers.push(player);\n                    return;\n                }\n                var /** @type {?} */ innerPlayer = _this._buildAnimation(player.namespaceId, instruction, allPreviousPlayersMap, skippedPlayersMap, preStylesMap, postStylesMap);\n                player.setRealPlayer(innerPlayer);\n                var /** @type {?} */ parentHasPriority = null;\n                for (var /** @type {?} */ i = 0; i < sortedParentElements.length; i++) {\n                    var /** @type {?} */ parent_2 = sortedParentElements[i];\n                    if (parent_2 === element)\n                        break;\n                    if (_this.driver.containsElement(parent_2, element)) {\n                        parentHasPriority = parent_2;\n                        break;\n                    }\n                }\n                if (parentHasPriority) {\n                    var /** @type {?} */ parentPlayers = _this.playersByElement.get(parentHasPriority);\n                    if (parentPlayers && parentPlayers.length) {\n                        player.parentPlayer = optimizeGroupPlayer(parentPlayers);\n                    }\n                    skippedPlayers.push(player);\n                }\n                else {\n                    rootPlayers.push(player);\n                }\n            }\n            else {\n                eraseStyles(element, instruction.fromStyles);\n                player.onDestroy(function () { return setStyles(element, instruction.toStyles); });\n                subPlayers.push(player);\n            }\n        });\n        subPlayers.forEach(function (player) {\n            var /** @type {?} */ playersForElement = skippedPlayersMap.get(player.element);\n            if (playersForElement && playersForElement.length) {\n                var /** @type {?} */ innerPlayer = optimizeGroupPlayer(playersForElement);\n                player.setRealPlayer(innerPlayer);\n            }\n        });\n        // the reason why we don't actually play the animation is\n        // because all that a skipped player is designed to do is to\n        // fire the start/done transition callback events\n        skippedPlayers.forEach(function (player) {\n            if (player.parentPlayer) {\n                player.parentPlayer.onDestroy(function () { return player.destroy(); });\n            }\n            else {\n                player.destroy();\n            }\n        });\n        // run through all of the queued removals and see if they\n        // were picked up by a query. If not then perform the removal\n        // operation right away unless a parent animation is ongoing.\n        for (var /** @type {?} */ i = 0; i < allLeaveNodes.length; i++) {\n            var /** @type {?} */ element = allLeaveNodes[i];\n            var /** @type {?} */ details = (element[REMOVAL_FLAG]);\n            removeClass(element, LEAVE_CLASSNAME);\n            // this means the element has a removal animation that is being\n            // taken care of and therefore the inner elements will hang around\n            // until that animation is over (or the parent queried animation)\n            if (details && details.hasAnimation)\n                continue;\n            var /** @type {?} */ players = [];\n            // if this element is queried or if it contains queried children\n            // then we want for the element not to be removed from the page\n            // until the queried animations have finished\n            if (queriedElements.size) {\n                var /** @type {?} */ queriedPlayerResults = queriedElements.get(element);\n                if (queriedPlayerResults && queriedPlayerResults.length) {\n                    players.push.apply(players, queriedPlayerResults);\n                }\n                var /** @type {?} */ queriedInnerElements = this.driver.query(element, NG_ANIMATING_SELECTOR, true);\n                for (var /** @type {?} */ j = 0; j < queriedInnerElements.length; j++) {\n                    var /** @type {?} */ queriedPlayers = queriedElements.get(queriedInnerElements[j]);\n                    if (queriedPlayers && queriedPlayers.length) {\n                        players.push.apply(players, queriedPlayers);\n                    }\n                }\n            }\n            if (players.length) {\n                removeNodesAfterAnimationDone(this, element, players);\n            }\n            else {\n                this.processLeaveNode(element);\n            }\n        }\n        // this is required so the cleanup method doesn't remove them\n        allLeaveNodes.length = 0;\n        rootPlayers.forEach(function (player) {\n            _this.players.push(player);\n            player.onDone(function () {\n                player.destroy();\n                var /** @type {?} */ index = _this.players.indexOf(player);\n                _this.players.splice(index, 1);\n            });\n            player.play();\n        });\n        return rootPlayers;\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.elementContainsData = function (namespaceId, element) {\n        var /** @type {?} */ containsData = false;\n        var /** @type {?} */ details = (element[REMOVAL_FLAG]);\n        if (details && details.setForRemoval)\n            containsData = true;\n        if (this.playersByElement.has(element))\n            containsData = true;\n        if (this.playersByQueriedElement.has(element))\n            containsData = true;\n        if (this.statesByElement.has(element))\n            containsData = true;\n        return this._fetchNamespace(namespaceId).elementContainsData(element) || containsData;\n    };\n    /**\n     * @param {?} callback\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.afterFlush = function (callback) { this._flushFns.push(callback); };\n    /**\n     * @param {?} callback\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.afterFlushAnimationsDone = function (callback) { this._whenQuietFns.push(callback); };\n    /**\n     * @param {?} element\n     * @param {?} isQueriedElement\n     * @param {?=} namespaceId\n     * @param {?=} triggerName\n     * @param {?=} toStateValue\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._getPreviousPlayers = function (element, isQueriedElement, namespaceId, triggerName, toStateValue) {\n        var /** @type {?} */ players = [];\n        if (isQueriedElement) {\n            var /** @type {?} */ queriedElementPlayers = this.playersByQueriedElement.get(element);\n            if (queriedElementPlayers) {\n                players = queriedElementPlayers;\n            }\n        }\n        else {\n            var /** @type {?} */ elementPlayers = this.playersByElement.get(element);\n            if (elementPlayers) {\n                var /** @type {?} */ isRemovalAnimation_1 = !toStateValue || toStateValue == VOID_VALUE;\n                elementPlayers.forEach(function (player) {\n                    if (player.queued)\n                        return;\n                    if (!isRemovalAnimation_1 && player.triggerName != triggerName)\n                        return;\n                    players.push(player);\n                });\n            }\n        }\n        if (namespaceId || triggerName) {\n            players = players.filter(function (player) {\n                if (namespaceId && namespaceId != player.namespaceId)\n                    return false;\n                if (triggerName && triggerName != player.triggerName)\n                    return false;\n                return true;\n            });\n        }\n        return players;\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} instruction\n     * @param {?} allPreviousPlayersMap\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._beforeAnimationBuild = function (namespaceId, instruction, allPreviousPlayersMap) {\n        var _this = this;\n        // it's important to do this step before destroying the players\n        // so that the onDone callback below won't fire before this\n        eraseStyles(instruction.element, instruction.fromStyles);\n        var /** @type {?} */ triggerName = instruction.triggerName;\n        var /** @type {?} */ rootElement = instruction.element;\n        // when a removal animation occurs, ALL previous players are collected\n        // and destroyed (even if they are outside of the current namespace)\n        var /** @type {?} */ targetNameSpaceId = instruction.isRemovalTransition ? undefined : namespaceId;\n        var /** @type {?} */ targetTriggerName = instruction.isRemovalTransition ? undefined : triggerName;\n        instruction.timelines.map(function (timelineInstruction) {\n            var /** @type {?} */ element = timelineInstruction.element;\n            var /** @type {?} */ isQueriedElement = element !== rootElement;\n            var /** @type {?} */ players = getOrSetAsInMap(allPreviousPlayersMap, element, []);\n            var /** @type {?} */ previousPlayers = _this._getPreviousPlayers(element, isQueriedElement, targetNameSpaceId, targetTriggerName, instruction.toState);\n            previousPlayers.forEach(function (player) {\n                var /** @type {?} */ realPlayer = (player.getRealPlayer());\n                if (realPlayer.beforeDestroy) {\n                    realPlayer.beforeDestroy();\n                }\n                players.push(player);\n            });\n        });\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} instruction\n     * @param {?} allPreviousPlayersMap\n     * @param {?} skippedPlayersMap\n     * @param {?} preStylesMap\n     * @param {?} postStylesMap\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._buildAnimation = function (namespaceId, instruction, allPreviousPlayersMap, skippedPlayersMap, preStylesMap, postStylesMap) {\n        var _this = this;\n        var /** @type {?} */ triggerName = instruction.triggerName;\n        var /** @type {?} */ rootElement = instruction.element;\n        // we first run this so that the previous animation player\n        // data can be passed into the successive animation players\n        var /** @type {?} */ allQueriedPlayers = [];\n        var /** @type {?} */ allConsumedElements = new Set();\n        var /** @type {?} */ allSubElements = new Set();\n        var /** @type {?} */ allNewPlayers = instruction.timelines.map(function (timelineInstruction) {\n            var /** @type {?} */ element = timelineInstruction.element;\n            allConsumedElements.add(element);\n            // FIXME (matsko): make sure to-be-removed animations are removed properly\n            var /** @type {?} */ details = element[REMOVAL_FLAG];\n            if (details && details.removedBeforeQueried)\n                return new _angular_animations.NoopAnimationPlayer();\n            var /** @type {?} */ isQueriedElement = element !== rootElement;\n            var /** @type {?} */ previousPlayers = flattenGroupPlayers((allPreviousPlayersMap.get(element) || EMPTY_PLAYER_ARRAY)\n                .map(function (p) { return p.getRealPlayer(); }))\n                .filter(function (p) {\n                // the `element` is not apart of the AnimationPlayer definition, but\n                // Mock/WebAnimations\n                // use the element within their implementation. This will be added in Angular5 to\n                // AnimationPlayer\n                var /** @type {?} */ pp = (p);\n                return pp.element ? pp.element === element : false;\n            });\n            var /** @type {?} */ preStyles = preStylesMap.get(element);\n            var /** @type {?} */ postStyles = postStylesMap.get(element);\n            var /** @type {?} */ keyframes = normalizeKeyframes(_this.driver, _this._normalizer, element, timelineInstruction.keyframes, preStyles, postStyles);\n            var /** @type {?} */ player = _this._buildPlayer(timelineInstruction, keyframes, previousPlayers);\n            // this means that this particular player belongs to a sub trigger. It is\n            // important that we match this player up with the corresponding (@trigger.listener)\n            if (timelineInstruction.subTimeline && skippedPlayersMap) {\n                allSubElements.add(element);\n            }\n            if (isQueriedElement) {\n                var /** @type {?} */ wrappedPlayer = new TransitionAnimationPlayer(namespaceId, triggerName, element);\n                wrappedPlayer.setRealPlayer(player);\n                allQueriedPlayers.push(wrappedPlayer);\n            }\n            return player;\n        });\n        allQueriedPlayers.forEach(function (player) {\n            getOrSetAsInMap(_this.playersByQueriedElement, player.element, []).push(player);\n            player.onDone(function () { return deleteOrUnsetInMap(_this.playersByQueriedElement, player.element, player); });\n        });\n        allConsumedElements.forEach(function (element) { return addClass(element, NG_ANIMATING_CLASSNAME); });\n        var /** @type {?} */ player = optimizeGroupPlayer(allNewPlayers);\n        player.onDestroy(function () {\n            allConsumedElements.forEach(function (element) { return removeClass(element, NG_ANIMATING_CLASSNAME); });\n            setStyles(rootElement, instruction.toStyles);\n        });\n        // this basically makes all of the callbacks for sub element animations\n        // be dependent on the upper players for when they finish\n        allSubElements.forEach(function (element) { getOrSetAsInMap(skippedPlayersMap, element, []).push(player); });\n        return player;\n    };\n    /**\n     * @param {?} instruction\n     * @param {?} keyframes\n     * @param {?} previousPlayers\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._buildPlayer = function (instruction, keyframes, previousPlayers) {\n        if (keyframes.length > 0) {\n            return this.driver.animate(instruction.element, keyframes, instruction.duration, instruction.delay, instruction.easing, previousPlayers);\n        }\n        // special case for when an empty transition|definition is provided\n        // ... there is no point in rendering an empty animation\n        return new _angular_animations.NoopAnimationPlayer();\n    };\n    return TransitionAnimationEngine;\n}());\nvar TransitionAnimationPlayer = (function () {\n    /**\n     * @param {?} namespaceId\n     * @param {?} triggerName\n     * @param {?} element\n     */\n    function TransitionAnimationPlayer(namespaceId, triggerName, element) {\n        this.namespaceId = namespaceId;\n        this.triggerName = triggerName;\n        this.element = element;\n        this._player = new _angular_animations.NoopAnimationPlayer();\n        this._containsRealPlayer = false;\n        this._queuedCallbacks = {};\n        this._destroyed = false;\n        this.markedForDestroy = false;\n    }\n    Object.defineProperty(TransitionAnimationPlayer.prototype, \"queued\", {\n        /**\n         * @return {?}\n         */\n        get: function () { return this._containsRealPlayer == false; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TransitionAnimationPlayer.prototype, \"destroyed\", {\n        /**\n         * @return {?}\n         */\n        get: function () { return this._destroyed; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} player\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.setRealPlayer = function (player) {\n        var _this = this;\n        if (this._containsRealPlayer)\n            return;\n        this._player = player;\n        Object.keys(this._queuedCallbacks).forEach(function (phase) {\n            _this._queuedCallbacks[phase].forEach(function (callback) { return listenOnPlayer(player, phase, undefined, callback); });\n        });\n        this._queuedCallbacks = {};\n        this._containsRealPlayer = true;\n    };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.getRealPlayer = function () { return this._player; };\n    /**\n     * @param {?} name\n     * @param {?} callback\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype._queueEvent = function (name, callback) {\n        getOrSetAsInMap(this._queuedCallbacks, name, []).push(callback);\n    };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.onDone = function (fn) {\n        if (this.queued) {\n            this._queueEvent('done', fn);\n        }\n        this._player.onDone(fn);\n    };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.onStart = function (fn) {\n        if (this.queued) {\n            this._queueEvent('start', fn);\n        }\n        this._player.onStart(fn);\n    };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.onDestroy = function (fn) {\n        if (this.queued) {\n            this._queueEvent('destroy', fn);\n        }\n        this._player.onDestroy(fn);\n    };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.init = function () { this._player.init(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.hasStarted = function () { return this.queued ? false : this._player.hasStarted(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.play = function () { !this.queued && this._player.play(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.pause = function () { !this.queued && this._player.pause(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.restart = function () { !this.queued && this._player.restart(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.finish = function () { this._player.finish(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.destroy = function () {\n        this._destroyed = true;\n        this._player.destroy();\n    };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.reset = function () { !this.queued && this._player.reset(); };\n    /**\n     * @param {?} p\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.setPosition = function (p) {\n        if (!this.queued) {\n            this._player.setPosition(p);\n        }\n    };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.getPosition = function () { return this.queued ? 0 : this._player.getPosition(); };\n    Object.defineProperty(TransitionAnimationPlayer.prototype, \"totalTime\", {\n        /**\n         * @return {?}\n         */\n        get: function () { return this._player.totalTime; },\n        enumerable: true,\n        configurable: true\n    });\n    return TransitionAnimationPlayer;\n}());\n/**\n * @param {?} map\n * @param {?} key\n * @param {?} value\n * @return {?}\n */\nfunction deleteOrUnsetInMap(map, key, value) {\n    var /** @type {?} */ currentValues;\n    if (map instanceof Map) {\n        currentValues = map.get(key);\n        if (currentValues) {\n            if (currentValues.length) {\n                var /** @type {?} */ index = currentValues.indexOf(value);\n                currentValues.splice(index, 1);\n            }\n            if (currentValues.length == 0) {\n                map.delete(key);\n            }\n        }\n    }\n    else {\n        currentValues = map[key];\n        if (currentValues) {\n            if (currentValues.length) {\n                var /** @type {?} */ index = currentValues.indexOf(value);\n                currentValues.splice(index, 1);\n            }\n            if (currentValues.length == 0) {\n                delete map[key];\n            }\n        }\n    }\n    return currentValues;\n}\n/**\n * @param {?} value\n * @return {?}\n */\nfunction normalizeTriggerValue(value) {\n    switch (typeof value) {\n        case 'boolean':\n            return value ? '1' : '0';\n        default:\n            return value != null ? value.toString() : null;\n    }\n}\n/**\n * @param {?} node\n * @return {?}\n */\nfunction isElementNode(node) {\n    return node && node['nodeType'] === 1;\n}\n/**\n * @param {?} eventName\n * @return {?}\n */\nfunction isTriggerEventValid(eventName) {\n    return eventName == 'start' || eventName == 'done';\n}\n/**\n * @param {?} element\n * @param {?=} value\n * @return {?}\n */\nfunction cloakElement(element, value) {\n    var /** @type {?} */ oldValue = element.style.display;\n    element.style.display = value != null ? value : 'none';\n    return oldValue;\n}\n/**\n * @param {?} driver\n * @param {?} elements\n * @param {?} elementPropsMap\n * @param {?} defaultStyle\n * @return {?}\n */\nfunction cloakAndComputeStyles(driver, elements, elementPropsMap, defaultStyle) {\n    var /** @type {?} */ cloakVals = elements.map(function (element) { return cloakElement(element); });\n    var /** @type {?} */ valuesMap = new Map();\n    elementPropsMap.forEach(function (props, element) {\n        var /** @type {?} */ styles = {};\n        props.forEach(function (prop) {\n            var /** @type {?} */ value = styles[prop] = driver.computeStyle(element, prop, defaultStyle);\n            // there is no easy way to detect this because a sub element could be removed\n            // by a parent animation element being detached.\n            if (!value || value.length == 0) {\n                element[REMOVAL_FLAG] = NULL_REMOVED_QUERIED_STATE;\n            }\n        });\n        valuesMap.set(element, styles);\n    });\n    elements.forEach(function (element, i) { return cloakElement(element, cloakVals[i]); });\n    return valuesMap;\n}\n/**\n * @param {?} nodes\n * @return {?}\n */\nfunction createIsRootFilterFn(nodes) {\n    var /** @type {?} */ nodeSet = new Set(nodes);\n    var /** @type {?} */ knownRootContainer = new Set();\n    var /** @type {?} */ isRoot;\n    isRoot = function (node) {\n        if (!node)\n            return true;\n        if (nodeSet.has(node.parentNode))\n            return false;\n        if (knownRootContainer.has(node.parentNode))\n            return true;\n        if (isRoot(node.parentNode)) {\n            knownRootContainer.add(node);\n            return true;\n        }\n        return false;\n    };\n    return isRoot;\n}\nvar CLASSES_CACHE_KEY = '$$classes';\n/**\n * @param {?} element\n * @param {?} className\n * @return {?}\n */\nfunction containsClass(element, className) {\n    if (element.classList) {\n        return element.classList.contains(className);\n    }\n    else {\n        var /** @type {?} */ classes = element[CLASSES_CACHE_KEY];\n        return classes && classes[className];\n    }\n}\n/**\n * @param {?} element\n * @param {?} className\n * @return {?}\n */\nfunction addClass(element, className) {\n    if (element.classList) {\n        element.classList.add(className);\n    }\n    else {\n        var /** @type {?} */ classes = element[CLASSES_CACHE_KEY];\n        if (!classes) {\n            classes = element[CLASSES_CACHE_KEY] = {};\n        }\n        classes[className] = true;\n    }\n}\n/**\n * @param {?} element\n * @param {?} className\n * @return {?}\n */\nfunction removeClass(element, className) {\n    if (element.classList) {\n        element.classList.remove(className);\n    }\n    else {\n        var /** @type {?} */ classes = element[CLASSES_CACHE_KEY];\n        if (classes) {\n            delete classes[className];\n        }\n    }\n}\n/**\n * @return {?}\n */\nfunction getBodyNode() {\n    if (typeof document != 'undefined') {\n        return document.body;\n    }\n    return null;\n}\n/**\n * @param {?} engine\n * @param {?} element\n * @param {?} players\n * @return {?}\n */\nfunction removeNodesAfterAnimationDone(engine, element, players) {\n    optimizeGroupPlayer(players).onDone(function () { return engine.processLeaveNode(element); });\n}\n/**\n * @param {?} players\n * @return {?}\n */\nfunction flattenGroupPlayers(players) {\n    var /** @type {?} */ finalPlayers = [];\n    _flattenGroupPlayersRecur(players, finalPlayers);\n    return finalPlayers;\n}\n/**\n * @param {?} players\n * @param {?} finalPlayers\n * @return {?}\n */\nfunction _flattenGroupPlayersRecur(players, finalPlayers) {\n    for (var /** @type {?} */ i = 0; i < players.length; i++) {\n        var /** @type {?} */ player = players[i];\n        if (player instanceof _angular_animations.ɵAnimationGroupPlayer) {\n            _flattenGroupPlayersRecur(player.players, finalPlayers);\n        }\n        else {\n            finalPlayers.push(/** @type {?} */ (player));\n        }\n    }\n}\n/**\n * @param {?} a\n * @param {?} b\n * @return {?}\n */\nfunction objEquals(a, b) {\n    var /** @type {?} */ k1 = Object.keys(a);\n    var /** @type {?} */ k2 = Object.keys(b);\n    if (k1.length != k2.length)\n        return false;\n    for (var /** @type {?} */ i = 0; i < k1.length; i++) {\n        var /** @type {?} */ prop = k1[i];\n        if (!b.hasOwnProperty(prop) || a[prop] !== b[prop])\n            return false;\n    }\n    return true;\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar AnimationEngine = (function () {\n    /**\n     * @param {?} driver\n     * @param {?} normalizer\n     */\n    function AnimationEngine(driver, normalizer) {\n        var _this = this;\n        this._triggerCache = {};\n        this.onRemovalComplete = function (element, context) { };\n        this._transitionEngine = new TransitionAnimationEngine(driver, normalizer);\n        this._timelineEngine = new TimelineAnimationEngine(driver, normalizer);\n        this._transitionEngine.onRemovalComplete = function (element, context) {\n            return _this.onRemovalComplete(element, context);\n        };\n    }\n    /**\n     * @param {?} componentId\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @param {?} name\n     * @param {?} metadata\n     * @return {?}\n     */\n    AnimationEngine.prototype.registerTrigger = function (componentId, namespaceId, hostElement, name, metadata) {\n        var /** @type {?} */ cacheKey = componentId + '-' + name;\n        var /** @type {?} */ trigger = this._triggerCache[cacheKey];\n        if (!trigger) {\n            var /** @type {?} */ errors = [];\n            var /** @type {?} */ ast = (buildAnimationAst(/** @type {?} */ (metadata), errors));\n            if (errors.length) {\n                throw new Error(\"The animation trigger \\\"\" + name + \"\\\" has failed to build due to the following errors:\\n - \" + errors.join(\"\\n - \"));\n            }\n            trigger = buildTrigger(name, ast);\n            this._triggerCache[cacheKey] = trigger;\n        }\n        this._transitionEngine.registerTrigger(namespaceId, name, trigger);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @return {?}\n     */\n    AnimationEngine.prototype.register = function (namespaceId, hostElement) {\n        this._transitionEngine.register(namespaceId, hostElement);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationEngine.prototype.destroy = function (namespaceId, context) {\n        this._transitionEngine.destroy(namespaceId, context);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} parent\n     * @param {?} insertBefore\n     * @return {?}\n     */\n    AnimationEngine.prototype.onInsert = function (namespaceId, element, parent, insertBefore) {\n        this._transitionEngine.insertNode(namespaceId, element, parent, insertBefore);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationEngine.prototype.onRemove = function (namespaceId, element, context) {\n        this._transitionEngine.removeNode(namespaceId, element, context);\n    };\n    /**\n     * @param {?} element\n     * @param {?} disable\n     * @return {?}\n     */\n    AnimationEngine.prototype.disableAnimations = function (element, disable) {\n        this._transitionEngine.markElementAsDisabled(element, disable);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} property\n     * @param {?} value\n     * @return {?}\n     */\n    AnimationEngine.prototype.process = function (namespaceId, element, property, value) {\n        if (property.charAt(0) == '@') {\n            var _a = parseTimelineCommand(property), id = _a[0], action = _a[1];\n            var /** @type {?} */ args = (value);\n            this._timelineEngine.command(id, element, action, args);\n        }\n        else {\n            this._transitionEngine.trigger(namespaceId, element, property, value);\n        }\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} eventName\n     * @param {?} eventPhase\n     * @param {?} callback\n     * @return {?}\n     */\n    AnimationEngine.prototype.listen = function (namespaceId, element, eventName, eventPhase, callback) {\n        // @@listen\n        if (eventName.charAt(0) == '@') {\n            var _a = parseTimelineCommand(eventName), id = _a[0], action = _a[1];\n            return this._timelineEngine.listen(id, element, action, callback);\n        }\n        return this._transitionEngine.listen(namespaceId, element, eventName, eventPhase, callback);\n    };\n    /**\n     * @param {?=} microtaskId\n     * @return {?}\n     */\n    AnimationEngine.prototype.flush = function (microtaskId) {\n        if (microtaskId === void 0) { microtaskId = -1; }\n        this._transitionEngine.flush(microtaskId);\n    };\n    Object.defineProperty(AnimationEngine.prototype, \"players\", {\n        /**\n         * @return {?}\n         */\n        get: function () {\n            return ((this._transitionEngine.players))\n                .concat(/** @type {?} */ (this._timelineEngine.players));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @return {?}\n     */\n    AnimationEngine.prototype.whenRenderingDone = function () { return this._transitionEngine.whenRenderingDone(); };\n    return AnimationEngine;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar WebAnimationsPlayer = (function () {\n    /**\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} options\n     * @param {?=} previousPlayers\n     */\n    function WebAnimationsPlayer(element, keyframes, options, previousPlayers) {\n        if (previousPlayers === void 0) { previousPlayers = []; }\n        var _this = this;\n        this.element = element;\n        this.keyframes = keyframes;\n        this.options = options;\n        this.previousPlayers = previousPlayers;\n        this._onDoneFns = [];\n        this._onStartFns = [];\n        this._onDestroyFns = [];\n        this._initialized = false;\n        this._finished = false;\n        this._started = false;\n        this._destroyed = false;\n        this.time = 0;\n        this.parentPlayer = null;\n        this.previousStyles = {};\n        this.currentSnapshot = {};\n        this._duration = (options['duration']);\n        this._delay = (options['delay']) || 0;\n        this.time = this._duration + this._delay;\n        if (allowPreviousPlayerStylesMerge(this._duration, this._delay)) {\n            previousPlayers.forEach(function (player) {\n                var /** @type {?} */ styles = player.currentSnapshot;\n                Object.keys(styles).forEach(function (prop) { return _this.previousStyles[prop] = styles[prop]; });\n            });\n        }\n    }\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype._onFinish = function () {\n        if (!this._finished) {\n            this._finished = true;\n            this._onDoneFns.forEach(function (fn) { return fn(); });\n            this._onDoneFns = [];\n        }\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.init = function () {\n        this._buildPlayer();\n        this._preparePlayerBeforeStart();\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype._buildPlayer = function () {\n        var _this = this;\n        if (this._initialized)\n            return;\n        this._initialized = true;\n        var /** @type {?} */ keyframes = this.keyframes.map(function (styles) { return copyStyles(styles, false); });\n        var /** @type {?} */ previousStyleProps = Object.keys(this.previousStyles);\n        if (previousStyleProps.length) {\n            var /** @type {?} */ startingKeyframe_1 = keyframes[0];\n            var /** @type {?} */ missingStyleProps_1 = [];\n            previousStyleProps.forEach(function (prop) {\n                if (!startingKeyframe_1.hasOwnProperty(prop)) {\n                    missingStyleProps_1.push(prop);\n                }\n                startingKeyframe_1[prop] = _this.previousStyles[prop];\n            });\n            if (missingStyleProps_1.length) {\n                var /** @type {?} */ self_1 = this;\n                var _loop_1 = function () {\n                    var /** @type {?} */ kf = keyframes[i];\n                    missingStyleProps_1.forEach(function (prop) {\n                        kf[prop] = _computeStyle(self_1.element, prop);\n                    });\n                };\n                // tslint:disable-next-line\n                for (var /** @type {?} */ i = 1; i < keyframes.length; i++) {\n                    _loop_1();\n                }\n            }\n        }\n        this._player = this._triggerWebAnimation(this.element, keyframes, this.options);\n        this._finalKeyframe = keyframes.length ? keyframes[keyframes.length - 1] : {};\n        this._player.addEventListener('finish', function () { return _this._onFinish(); });\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype._preparePlayerBeforeStart = function () {\n        // this is required so that the player doesn't start to animate right away\n        if (this._delay) {\n            this._resetDomPlayerState();\n        }\n        else {\n            this._player.pause();\n        }\n    };\n    /**\n     * \\@internal\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} options\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype._triggerWebAnimation = function (element, keyframes, options) {\n        // jscompiler doesn't seem to know animate is a native property because it's not fully\n        // supported yet across common browsers (we polyfill it for Edge/Safari) [CL #143630929]\n        return (element['animate'](keyframes, options));\n    };\n    Object.defineProperty(WebAnimationsPlayer.prototype, \"domPlayer\", {\n        /**\n         * @return {?}\n         */\n        get: function () { return this._player; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.onStart = function (fn) { this._onStartFns.push(fn); };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.onDone = function (fn) { this._onDoneFns.push(fn); };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.onDestroy = function (fn) { this._onDestroyFns.push(fn); };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.play = function () {\n        this._buildPlayer();\n        if (!this.hasStarted()) {\n            this._onStartFns.forEach(function (fn) { return fn(); });\n            this._onStartFns = [];\n            this._started = true;\n        }\n        this._player.play();\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.pause = function () {\n        this.init();\n        this._player.pause();\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.finish = function () {\n        this.init();\n        this._onFinish();\n        this._player.finish();\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.reset = function () {\n        this._resetDomPlayerState();\n        this._destroyed = false;\n        this._finished = false;\n        this._started = false;\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype._resetDomPlayerState = function () {\n        if (this._player) {\n            this._player.cancel();\n        }\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.restart = function () {\n        this.reset();\n        this.play();\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.hasStarted = function () { return this._started; };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.destroy = function () {\n        if (!this._destroyed) {\n            this._resetDomPlayerState();\n            this._onFinish();\n            this._destroyed = true;\n            this._onDestroyFns.forEach(function (fn) { return fn(); });\n            this._onDestroyFns = [];\n        }\n    };\n    /**\n     * @param {?} p\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.setPosition = function (p) { this._player.currentTime = p * this.time; };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.getPosition = function () { return this._player.currentTime / this.time; };\n    Object.defineProperty(WebAnimationsPlayer.prototype, \"totalTime\", {\n        /**\n         * @return {?}\n         */\n        get: function () { return this._delay + this._duration; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.beforeDestroy = function () {\n        var _this = this;\n        var /** @type {?} */ styles = {};\n        if (this.hasStarted()) {\n            Object.keys(this._finalKeyframe).forEach(function (prop) {\n                if (prop != 'offset') {\n                    styles[prop] =\n                        _this._finished ? _this._finalKeyframe[prop] : _computeStyle(_this.element, prop);\n                }\n            });\n        }\n        this.currentSnapshot = styles;\n    };\n    return WebAnimationsPlayer;\n}());\n/**\n * @param {?} element\n * @param {?} prop\n * @return {?}\n */\nfunction _computeStyle(element, prop) {\n    return ((window.getComputedStyle(element)))[prop];\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar WebAnimationsDriver = (function () {\n    function WebAnimationsDriver() {\n    }\n    /**\n     * @param {?} element\n     * @param {?} selector\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.matchesElement = function (element, selector) {\n        return matchesElement(element, selector);\n    };\n    /**\n     * @param {?} elm1\n     * @param {?} elm2\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.containsElement = function (elm1, elm2) { return containsElement(elm1, elm2); };\n    /**\n     * @param {?} element\n     * @param {?} selector\n     * @param {?} multi\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.query = function (element, selector, multi) {\n        return invokeQuery(element, selector, multi);\n    };\n    /**\n     * @param {?} element\n     * @param {?} prop\n     * @param {?=} defaultValue\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.computeStyle = function (element, prop, defaultValue) {\n        return (((window.getComputedStyle(element)))[prop]);\n    };\n    /**\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} duration\n     * @param {?} delay\n     * @param {?} easing\n     * @param {?=} previousPlayers\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.animate = function (element, keyframes, duration, delay, easing, previousPlayers) {\n        if (previousPlayers === void 0) { previousPlayers = []; }\n        var /** @type {?} */ fill = delay == 0 ? 'both' : 'forwards';\n        var /** @type {?} */ playerOptions = { duration: duration, delay: delay, fill: fill };\n        // we check for this to avoid having a null|undefined value be present\n        // for the easing (which results in an error for certain browsers #9752)\n        if (easing) {\n            playerOptions['easing'] = easing;\n        }\n        var /** @type {?} */ previousWebAnimationPlayers = (previousPlayers.filter(function (player) { return player instanceof WebAnimationsPlayer; }));\n        return new WebAnimationsPlayer(element, keyframes, playerOptions, previousWebAnimationPlayers);\n    };\n    return WebAnimationsDriver;\n}());\n/**\n * @return {?}\n */\nfunction supportsWebAnimations() {\n    return typeof Element !== 'undefined' && typeof ((Element)).prototype['animate'] === 'function';\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * @module\n * @description\n * Entry point for all animation APIs of the animation browser package.\n */\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * @module\n * @description\n * Entry point for all public APIs of this package.\n */\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * Generated bundle index. Do not edit.\n */\n\nexports.AnimationDriver = AnimationDriver;\nexports.ɵAnimation = Animation;\nexports.ɵAnimationStyleNormalizer = AnimationStyleNormalizer;\nexports.ɵNoopAnimationStyleNormalizer = NoopAnimationStyleNormalizer;\nexports.ɵWebAnimationsStyleNormalizer = WebAnimationsStyleNormalizer;\nexports.ɵNoopAnimationDriver = NoopAnimationDriver;\nexports.ɵAnimationEngine = AnimationEngine;\nexports.ɵWebAnimationsDriver = WebAnimationsDriver;\nexports.ɵsupportsWebAnimations = supportsWebAnimations;\nexports.ɵWebAnimationsPlayer = WebAnimationsPlayer;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=animations-browser.umd.js.map\n"]}